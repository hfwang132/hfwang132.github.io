[{"categories":["数学物理方法"],"content":"小朋友们好，今天我们来学习什么是笛卡尔积。我们把世界上所有上衣的集合叫做 $a$ ，世界上所有下着的集合叫做 $b$ ，那么 $a$ 和 $b$ 的笛卡尔积 $a \\times b$ 是什么呢？就是所有可能的上下衣装搭配的集合啦（当然，不包括帽子、鞋子、首饰等等）。 现在我们打算开一家上衣店，专门卖上衣，叫做 $A$ 店；再开一家下着店，专门卖下着，叫做 $B$ 店。我们可以以一定数量进货各种各样的上衣，放到 $A$ 店里，再以一定数量进货各种各样的下着，放到 $B$ 店里。 $A$ 店的库存可以用一组整数来表示： $(a_1,a_2,\\cdots,a_m),a_i\\in \\mathbb{Z}$ ， $B$ 店的库存也可以用一组整数来表示：$(b_1,b_2,\\cdots,b_n),b_i\\in \\mathbb{Z}$ ，这些数字分别代表不同款型的数量。 所有可能的上衣店的集合构成一个环上的模（module over a ring），环的意思是上衣的数量只能是整数，而整数构成一个环，叫做整数环；模的意思就是我们可以把两个上衣店相加，得到一个新的上衣店，这个新店里的上衣就是把原来两个店的上衣给加起来。当然，我们也可以把两个上衣店相减，如果上衣的数量为负数，那么我们就说这个上衣店欠了市场多少件上衣。我们还可以将一家上衣店乘以一个整数得到一家新店，这个新店的库存是原店的整数倍。 如果两家店的库存完全相同，那么我们就说它们是同一家店，这是因为我们研究的实际上是抽象的库存，但是为了方便起见，我们就用店本身来代替库存啦。 以上所说的对下着店也成立，所有可能的下着店的集合也构成一个环上的模。 单卖上衣或者下着还是不得劲，于是我们直接把 $A$ 店与 $B$ 店合并起来。 $A$ 店与 $B$ 店的直和/直积就是这个新店啦。此时，我们可以用一组整数来表示它的库存： $(a_1,a_2,\\cdots,a_m,b_1,b_2,\\cdots,b_n)$ 。 张量积是什么呢？现在我们开一个套装店，只进货并且售卖上下衣的套装，不单卖上衣或者下着。那么此时所有这样的套装店的集合就是 $A$ 和 $B$ 的张量积 $A \\otimes B$ 啦。这个新店的库存需要用一个表格来表示： $\\begin{pmatrix} c_{11} \u0026 c_{12} \u0026 \\cdots \u0026 c_{1n} \\\\ c_{21} \u0026 c_{22} \u0026 \\cdots \u0026 c_{2n} \\\\ \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ c_{m1} \u0026 c_{m2} \u0026 \\cdots \u0026 c_{mn} \\end{pmatrix}$ 其中 $c_{ij}$ 表示由第 $i$ 款上衣与第 $j$ 款下着所构成的套装的数量。 OK，小朋友们，今天的代数课到此结束，回家记得好好完成课后阅读哦 ~ 下课 ~ （课后阅读） 如果现在我们开一家食品店，把上衣换成素菜、下衣换成荤菜，并且以千克来计重，那么此时的库存就可以用实数而不是整数来表示了，于是环上的模就升级成为了（域上的）向量空间，因为实数集不仅是一个环，还是一个域喔。 记所有素菜店的集合为 $A$ ，所有荤菜店的集合为 $B$ ，那么所有只售卖一荤一素套餐的店的集合就是 $A$ 与 $B$ 的张量积 $A \\otimes B$ 啦。 思考题 1：售卖两荤一素套餐的店的集合是什么？ 答案：并非 $A \\otimes B \\otimes B$ 。这是因为我们不能区分两个荤菜分别来自哪两个荤菜店。正确的答案是 $A \\otimes (B\\odot B)$ ，其中 $\\odot$ 叫做对称积（symmetric product）。 思考题 2：如果两种荤菜必须不一样，那么这样的店的集合是什么？ 答案： $A \\otimes (B\\wedge B)$ ，其中 $\\wedge$ 叫做外积（exterior product）或者楔积（wedge product）。 以下是正经科普： ","date":"2025-01-08","objectID":"/products/:0:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"笛卡尔积 笛卡尔积是对集合做的。两个集合 $A$ 和 $B$ 的笛卡尔积定义为 $A\\times B:={(a,b) \\mid a\\in A \\wedge b\\in B}$ 。就这么简单（只要你不研究它在集合论中的严格定义就行，严格的定义是由幂集公理给出的）。 ","date":"2025-01-08","objectID":"/products/:1:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"直积 直积与笛卡尔积相同，除了有一点不同：直积可以携带集合上额外的结构（同态/态射），而笛卡尔积仅仅是对于集合本身而言的。 例如对于两个群 $A $ 和 $B$ 而言，其直积为 $A \\times B$ ，且群运算定义为 $(a_1,b_1) \\cdot (a_2, b_2) := (a_1 \\cdot a_2, b_1 \\cdot b_2)$ ，其中 $a_1,a_2 \\in A, b_1,b_2\\in B$ 。 对于两个向量空间 $A $ 和 $B$ 而言，由于向量空间只不过就是配备了数乘的阿贝尔群，且群运算为向量加法，因此直积在向量空间上的定义和在群上的定义相同： $(a_1,b_1) +(a_2,b_2) :=(a_1 + a_2, b_1 + b_2)$ 我们不能谈论两个集合之间的直积，因为集合上面没有像群的二元运算这样的额外结构。当一个人谈论直积的时候，谈论的对象一定不仅仅是集合，而是包含对应的运算。 ","date":"2025-01-08","objectID":"/products/:2:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"直和 直和与直积在大多数情况下完全相同。不同之处非常微妙，涉及范畴学。一言以蔽之，直积属于 product，直和属于 coproduct。对于无穷次直积与直和，前者允许无穷多个不为单位元的元素，后者只允许有穷多个不为单位元的元素。见下一节。 ","date":"2025-01-08","objectID":"/products/:3:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"直积与直和的泛性质 下图是直积与直和的泛性质的一个简单示意图。为了易懂，之后用群（group）代替范畴学中的对象（object），用同态（homomorphism）代替范畴学中的态射（morphism）。读者只要知道群和同态是什么，就能看懂。 直积（左）与直和（右）的区别，图源：本人灵魂作画 这个图已经很清楚明白了，下面是具体的文字说明。 直积的泛性质如下： 对于任意两个群同态 $f_1:B \\rightarrow A_1$ 和 $f_2: B\\rightarrow A_2$ ，总是存在一个（在同构上意义唯一的）群 $A_1 \\times A_2$ 以及同态 $\\varphi:B\\rightarrow A_1\\times A_2$ ，使得 $f_i= \\varphi \\circ \\pi_i (i=1,2)$ ，其中 $\\pi_i$ 为投影映射（projection map），定义为 $\\pi_1(a_1,a_2) := a_1,\\pi_2(a_1,a_2):=a_2$ 。 $A_1$ 和 $A_2$ 的直积就是群 $A_1 \\times A_2$ 和配备的投影映射 $\\pi_{1,2}$ 。 注意，此处的 $\\times$ 表示直积，而不是笛卡尔积。符号 $\\times$ 既可以表示前者也可以表示后者，需要根据上下文确定。 直和的泛性质如下： 对于任意两个群同态 $g_1: A_1 \\rightarrow B$ 和 $g_2: A_2 \\rightarrow B$ ，总是存在一个（同构意义上）唯一的群 $A_1 \\oplus A_2$ 以及同态 $\\phi:A_1 \\oplus A_2 \\rightarrow B$ ，使得 $g_i=\\iota_i \\circ \\phi (i=1,2)$ 。其中 $\\iota_i$ 为包含映射（inclusion map），定义为 $\\iota_1(a):=(a,e_{A_2}),\\iota_2(a):=(e_{A_1},a)$ ，其中 $e_{A_i}$ 表示群 $A_i$ 的单位元。 $A_1$ 和 $A_2$ 的直和就是群 $A_1 \\oplus A_2$ 和配备的包含映射 $\\iota_{1,2}$ 。 可以看出来，直积与直和的同态方向是相反的。这也是 coproduct 中 co- 的来源，类似于 vector 和 covector。 ","date":"2025-01-08","objectID":"/products/:4:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"直积与直和的不同 直积与直和的泛性质不同，这带来什么后果？ 第一，有限多个对象的直积与直和是完全一样的，此时混用两者不会有问题。例如， $V \\times W$ 同构于 $V\\oplus W$ 。 第二，无穷多个对象的直积 $\\times_{i=1}^{\\infty} A_i$ 与直和 $\\bigoplus_{i=1}^{\\infty} A_i$ 是不一样的。后者只允许有限个元素不为单位元。这是因为群运算在定义上就是有穷的（如果想做无穷次群运算，通常需要借助极限等额外的概念），而直和的定义中会涉及无穷多次群运算。 具体来说，如果 $\\bigoplus_{i=1}^{\\infty} A_i$ 中存在一个有无穷多个元素不为单位元的元素 $a=(a_1,a_2,\\cdots)$ ，那么它在同态 $\\phi$ 下的像就是一个涉及无穷次群运算的东西 $\\varphi(a)=g_1(a_1) \\cdot g_2(a_2)\\cdot \\cdots$ ，这是不良定义的，因此也就不会存在这样一个同态 $\\phi$ 。所以直和中不能包含有无穷多非单位元的元素。 ","date":"2025-01-08","objectID":"/products/:5:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"直积与直和不同的一个例子 下面给出一个直和与直积不同的例子。我们考虑无穷个 $Z_2$ 的直和： $\\bigoplus _{i=1}^{\\infty} Z_2 $ 其中 $Z_2 = {0,1}$ 是二阶循环群。 它只包含有穷个元素不为零的元素，例如 $(1,0,1,0,0,\\cdots)$ 。 而无穷个 $Z_2$ 的直积: $\\times_{i=1}^{\\infty} Z_2$ 它允许无穷个元素不为零，例如 $(1,0,1,1,1,\\cdots)$ 。 前者与自然数集等势，因为它构成了自然数的二进制表示。 而后者与实数集等势，因为它构成了区间 $[0,1]$ 的二进制表示。 可见，前者可数而后者不可数，所以无穷个 $Z_2$ 的直和与无穷个 $Z_2$ 的直积是不同的。 ","date":"2025-01-08","objectID":"/products/:6:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"张量积 直积与直和的定义只涉及到群，而张量积的定义通常涉及到向量空间（或者环上的模）。 张量积的泛性质如下： 对于任意一个多重线性映射 $f:V\\times W \\rightarrow U$ ，都存在（同构意义上）唯一的向量空间 $V\\otimes W$ ，以及映射 $\\otimes:V\\times W \\rightarrow V \\otimes W$ 和线性映射 $\\psi: V \\otimes W \\rightarrow U$ ，使得 $f = \\otimes \\circ \\psi$ 。这个向量空间 $V\\otimes W$ 定义为 $V$ 和 $W$ 的张量积。此处符号 $\\times$ 指笛卡尔积。 补充说明：多重线性映射是指有多个向量变量且对每个变量都是线性的映射。 具体来说， $n$ 重线性映射定义为 $f:V_1\\times V_2\\times \\cdots\\times V_n \\rightarrow W$ ，且满足如下性质： $\\begin{align} \u0026f(v_1,\\cdots,\\lambda a+ \\mu b,\\cdots,v_n)\\\\ \u0026=\\lambda f(v_1,\\cdots,a,\\cdots,v_n)+\\mu f(v_1,\\cdots,b,\\cdots,v_n) \\end{align}$ 注意，在上述定义中，符号 $\\otimes$ 有两个不同的意思，其一是向量空间之间的张量积 $V \\otimes W$ ，其二是两个向量空间的元素做张量积运算，也就是从 $V\\times W$ 到 $V \\otimes W$ 的映射。 张量积与直积有什么不同？下面举例说明。假设 3 维向量空间 $V$ 有三个基： ${v_1,v_2,v_3}$ ，2 维向量空间 $W$ 有两个基： ${w_1,w_2}$ ，那么它们的直积 $V\\times W$ 有五个基： ${(v_1,0),(v_2,0),(v_3,0),(0,w_1),(0,w_2)}$。 而 $V$ 和 $W$ 的张量积 $V \\otimes W$ 有六个基： ${v_1\\otimes w_1, v_1 \\otimes w_2, v_2 \\otimes w_1, v_2 \\otimes w_2, v_3 \\otimes w_1, v_3 \\otimes w_2}$ 。 可以看出，直积的维数是 m + n，而张量积的维数是 m × n。 在中文（评论指正：包括英文）教材和互联网上，有很多人用直积来指张量积，这是错误的，但已经积重难返。当一个物理人对你说直积的时候，你要根据上下文判断他说的究竟是直积还是张量积。 当然，对于我们搞量子信息的物理人来说，当然是不会搞混的（骄傲），因为天天要用到张量积。复合系统的希尔伯特空间就是各个子系统的希尔伯特空间的张量积，这实际上是量子力学的公理之一。正因为是张量积而不是直积，才会出现量子纠缠。如果是直积的话，是不会有量子纠缠的。 ","date":"2025-01-08","objectID":"/products/:7:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["数学物理方法"],"content":"太长不看版本 如果你越划越快，划到了这里，说明你不想看上面一大堆废话。OK，那么我给出简单的总结： 笛卡尔积、直积、直和基本上是一回事。不同之处在于： 笛卡尔积是对集合所做的、直积与直和是对群（或者范畴学中的其他对象）所做的，并且把相应的群同态（范畴学中的态射）也给定义了一遍。 直积与直和在做有限次的情况下没有区别。区别在于无穷次直积允许包含无穷多非单位元的元素，而无穷次直和只允许包含有限个非单位元的元素。 张量积与以上三者都有很大的不同，它一般是对向量空间（或者环上的模）定义的。直观地来看，m 维向量空间和 n 维向量空间的直和/直积的维数是 m + n，而张量积的维数是 m × n。 ","date":"2025-01-08","objectID":"/products/:8:0","tags":["量子信息"],"title":"直积、直和、笛卡尔积、张量积的区别是什么","uri":"/products/"},{"categories":["量子信息"],"content":"个人认为在量子力学的诠释中，目前最有趣的是 Zurek 的 Existential Interpretation（存在主义诠释），也被称为量子达尔文主义（Quantum Darwinism） [1]。Zurek 本人是退相干理论的奠基人之一。 量子达尔文主义并未直接给出测量过程的动力学，但它做出了几个非常有启发性的观察： (1) 测量结果之所以能成为宏观事实，是因为它的信息被复制（克隆）了很多遍，遍布于环境之中，从而使得不同的观察者可以达成共识。 具体的克隆过程: $|s_k\\rangle |\\varepsilon_0\\rangle \\rightarrow |s_k\\rangle |\\varepsilon_k\\rangle$ 其中 $|s_k\\rangle$ 是系统的状态， $|\\varepsilon_k\\rangle$ 是环境的状态。 很显然，对于一个特定的 k，存在一个幺正（Unitary）过程 $U$ 使得 $U|s_k\\rangle |\\varepsilon_0\\rangle = |s_k\\rangle |\\varepsilon_k\\rangle$ 。 然而，这个过程 $U$ 不能同时克隆任意其他的 $|s_k\\rangle$ ，而是只能克隆一组正交的 $|s_k\\rangle$ ，这就是下面第 (2) 点要说的不可克隆定理。 (2) 根据 no-cloning theorem（不可克隆定理），一个幺正（Unitary）过程只能克隆一组正交的态。 评论： 根据 (1) (2)，我们可以得出：测量结果之间必须是正交的。或者说测量结果构成希尔伯特空间中的一组完备正交基。 但是，希尔伯特空间中有无穷多组完备正交基，一个具体的测量究竟对应到哪一组呢？ 例如，“活猫”和“死猫”是量子态，但“活猫加死猫”和“活猫减死猫”同样也是合法的量子态，为什么我们只能观察到前一对结果，而不是后一对？ 下面第 (3) 点给出了解释。 (3) 系统和环境的相互作用使得只有某一组正交量子态（偏好基）能存活下来，而其他所有量子态（偏好基的叠加态）的信息最终都会丢失。 评论： 第 (3) 点就是“量子达尔文主义”这个名字的来源。它有严格的动力学模型支撑，也就是退相干模型。但退相干模型只能让叠加态变成一个混态，而不是一个纯态，因此仍然没有给出测量过程的动力学。 那么混态意味着什么？混态有两种物理意义：一是对系综的描述，二是对主观信息的描述。例如，对于一个量子比特的混态 $a|0\\rangle\\langle0|+b|1\\rangle\\langle1|$ ，我们有两种解释方式：一是我们有一个量子系综，里面有 $\\frac{a}{a+b}$ 比例的量子比特处于 $|0\\rangle$ 态， $\\frac{b}{a+b}$ 比例的量子比特处于 $|1\\rangle$ 态；二是我们只有一个量子比特，我们知道它要么处于 $|0\\rangle$ 态，要么处于 $|1\\rangle$ 态，但不知道实际是哪种情况。我们只知道它以 $\\frac{a}{a+b}$ 的概率处于 $|0\\rangle$ 态，以 $\\frac{b}{a+b}$ 的概率 $|1\\rangle$ 态。如果一个人只接受系综解释，那么他很可能会相信多世界诠释。 可见，到此为止，我们仍然没有解释概率的来源，即测量结果为什么以概率出现。下面第 (4) 点是 Zurek 对概率成因的解释： (4) 概率来源于量子纠缠：如果我们有一个纠缠对 $(A,B)$ ，它处于态 $|a_1\\rangle |b_1\\rangle + |a_2\\rangle|b_2\\rangle + \\cdots + |a_N\\rangle |b_N\\rangle$ 上，那么任何在 $B$ 上的置换操作都不会改变物理状态。这是因为任何这样的置换操作都能被 $A$ 上同样的置换操作所抵消。而正因为置换分支对物理状态完全没有影响，所以各个分支一定是等概率出现的。 评论： 等概率的情况可以推广到不等概率的情况。这是因为环境的自由度总比系统的自由度多，即 $B$ 的自由度比 $A$ 的自由度要多。例如，假设系统 $A$ 是量子比特，其希尔伯特空间是二维的，而 $B$ 的希尔伯特空间是 1024 维的（例如，10 个量子比特），那么我们可以想象这样一种态： $|0\\rangle (|b_1\\rangle + \\cdots + |b_k\\rangle) + |1\\rangle (|b_{k+1}\\rangle + \\cdots + |b_{1024}\\rangle)$ 。此时，根据等概率原理， $|0\\rangle$ 的概率为 $\\frac{k}{1024}$ ， $|1\\rangle$ 的概率为 $\\frac{1024-k}{1024}$ 。 实际上，环境的希尔伯特空间的维数是 $2^{10^{23}}$ 量级的，远不止 $2^{10} = 1024$ ，因此从 0 到 1 之间的所有概率都可以用这个模型实现。 以上就是 Zurek 的存在主义诠释的 4 个要点。其中第 (3) 点称为 “Einselection”，全称“Environment-Induced Superselection”（环境诱导的超选择），第 (4) 点称为 “Envariance”，全称“Environment-assisted Invariance”（环境协助的不变性）。 以下是哲学方面的个人评论： 个人认为 Zurek 最精彩的观察其实是第 (1) 点，其奠定了存在主义诠释的哲学基调。这里将其再次陈述一遍： 测量结果之所以能成为宏观事实，是因为它的信息被复制了很多遍，遍布于环境之中，从而使得不同的观察者可以达成共识。 这个陈述暗含了一个信息：不同的观察者可以观察到不同的事实。Zurek 的工作中通过互信息（Mutual Information）定量刻画了这一点 [1]。之所以没有发生这种情况，是因为随着泄露到环境中的信息以及观察者所能观察的环境部分的增加，互信息增长的非常快。 “不同的观察者可以观察到不同的事实”这一点在相对论中并不令人惊讶。Carlo Rovelli 的关系型量子力学（Relational Quantum Mechanics）诠释就强调了这一点。 回到第 (1) 点，它暗示了这样一种哲学观点：所知与所在的界限是模糊的。用 Zurek 本人的话说 [2] “I strongly suspect that the ultimate message of quantum theory is that the separation between what exists and what is known to exist – between the epistemic and the ontic – must be abolished.” “Surprisingly, as the nascent quantum theory matured, quantum awkwardness did not go away. The lesson of the developments that started with decoherence, and led, through einselection and pointer states to quantum Darwinism and related insights, is that quantum states are epiontic. It now appears that the distinction between what is and what is known about what exists – something we take for granted in our everyday world – is not there at the fundamental level.” 翻译： 我强烈怀疑，量子理论最终要传达的信息是：必须消除“存在的事物”与“被认识到存在的事物”之间的区分——即消除认知（epistemic）与本体（ontic）之间的区分。 令人惊讶的是，随着新生的量子理论逐渐成熟，量子的尴尬并没有消失。从退相干（decoherence）开始的研究，通过环境选择（einselection）和指针态（pointer states），最终发展到量子达尔文主义（quantum Darwinism）及相关洞察，这些研究表明量子态是“认知-本体一体化”（epiontic）的。如今看来，在基础层面上，我们在日常世界中所认为的“存在”与“被认识的存在”之间的区分，其实并不存在。 Zurek 调和了本体论诠释（隐变量、多世界）和认识论诠释（量子贝叶斯主义，关系型量子力学）之间的矛盾。他说：量子力学既不是完全认识论（Epistemic）的，也不是完全本体论（Ontic）的，而是“Epiontic”的。换言之： 所知即所在，所在即所知。 ","date":"2025-01-08","objectID":"/quantum_darwinism/:0:0","tags":["量子达尔文主义"],"title":"量子达尔文主义","uri":"/quantum_darwinism/"},{"categories":["量子信息"],"content":"参考 Zurek, W. H. Quantum Theory of the Classical: Einselection, Envariance, Quantum Darwinism and Extantons. Entropy 2022, 24 (11), 1520. https://doi.org/10.3390/e24111520 Emergence of the Classical from within the Quantum Universe. https://arxiv.org/abs/2107.03378 ","date":"2025-01-08","objectID":"/quantum_darwinism/:1:0","tags":["量子达尔文主义"],"title":"量子达尔文主义","uri":"/quantum_darwinism/"},{"categories":["数学物理方法"],"content":"前言 在经典力学中，物理量是相空间上的一个函数，系统状态是相空间上的一个点（对于系综而言则是相空间上的一个概率分布）。这一套语言量子化之后，就得到了量子态/算符的相空间表示，也就是 Wigner 表示。Weyl 表示则是它的傅里叶变换。 大部分作者都将 Wigner 表示定义为： $F_W(x,p)=\\int \\mathrm{d}y \\langle x+\\frac{y}{2}\\mid F \\mid x - \\frac{y}{2} \\rangle e^{\\mathrm{i} p y}$ 然后再推导出它的各种性质。但从物理人的角度来看，这个式子物理意义不明，且 $(x,p)$ 的地位不平等，让人看了不太舒服。 本文将从一个更加舒服的角度引入 Wigner 和 Weyl 表示。本文只作介绍，不涉及严格证明和推导。 ","date":"2025-01-08","objectID":"/weyl_wigner/:1:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["数学物理方法"],"content":"离散情形的幺正基 给定一个 $N$ 维希尔伯特空间 $\\mathcal{H}$ ，以及它的一个标准正交基 $|v_l\\rangle,,( l=1,…,N)$ 。定义 $U = \\sum_{l=1}^N |v_{l+1}\\rangle\\langle v_{l}|$ 其中 $|v_{N+1}\\rangle := |v_1\\rangle$ 。 记 $U$ 的特征向量为 $|u_k\\rangle$ ，则可以定义 $V = \\sum_{k=1}^N |u_k\\rangle\\langle u_{k+1} |$ ， 且 $\\langle u_k| v_l\\rangle=e^{\\frac{2\\pi}{N}kl}$ ，证略。 任何一个 $\\mathcal{H}$ 上的算符都可以写成 $U$ 和 $V$ 的多项式（证略）： $F = \\sum_{kl} f_{kl}U^k V^l$ $f_{kl} = \\frac{1}{N} \\text{tr}[U^{-k}FV^{-l}]$ 例：在 $\\mathbb{C}^2$ 上，令 $U = \\sigma_x$ ， $V=\\sigma_y$ ，则 $UV = \\mathrm{i}\\sigma_z$ 。那么 $F = \\frac{1}{2}\\sum_{k=0}^3 \\text{tr}[F\\sigma_k] \\sigma_k$ 其中 $\\sigma_0 :=\\mathbb{I}$ 。注意 $\\sigma_k^{-1} = \\sigma_k^\\dagger = \\sigma_k$ 。 可见，给定一个有限维希尔伯特空间，我们总能找到一对幺正算符 $U,V$ 以及它们作为生成元所生成的 $U^k V^l$ ，作为算符的基，共 $N^2$ 个。 ","date":"2025-01-08","objectID":"/weyl_wigner/:2:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["数学物理方法"],"content":"连续情形的幺正基（Weyl 基） 以上步骤可以推广到无穷维希尔伯特空间。此时我们以 $X,P$ 作为生成元，生成 $e^{\\mathrm{i}pX}e^{\\mathrm{i}xP}$ 作为作为算符的基。 $F=\\int\\frac{\\mathrm{d}x\\mathrm{d}p}{2\\pi} f(x,p) e^{\\mathrm{i}pX} e^{\\mathrm{i}xP}$ $f(x,p)=\\text{tr}[e^{-\\mathrm{i}pX}Fe^{-\\mathrm{i}xP}]$ 然而，此时 $X,P$ 的地位是不平等的。这是因为在 $e^{\\mathrm{i}pX}e^{\\mathrm{i}xP}$ 这个表达式里面，所有 $X$ 都在 $P$ 的前面。而如果我们让 $P$ 在 $X$ 的前面，同样可以得到另一个 $\\tilde{f}(x,p)$ 。 让 $X,P$ 地位平等的办法是定义 $U(x,p)=e^{\\mathrm{i}(xP-pX)}$ 。这其实就是常说的平移算符（Displacement operator）。我们也称它为 Weyl 算符。我们接下来以它作为算符的基，并称其为 Weyl 基。可以证明： $F=\\int\\frac{\\mathrm{d}x\\mathrm{d}p}{2\\pi} f_W(x,p) U(x,p)$ $f_W(x,p) = \\text{tr}[FU^\\dagger(x,p)]$ 其中 $f_W(x,p)$ 就是算符 $F$ 的 Weyl 表示，它是算符在 Weyl 基下的展开形式。 ","date":"2025-01-08","objectID":"/weyl_wigner/:3:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["数学物理方法"],"content":"连续情形的厄米基（Wigner 基） 上面介绍的 Weyl 基是幺正的。有没有厄米的基？答案是有的，它们叫做 Wigner 基。 我们先来定义反演算符： $\\frac{1}{2}W:=\\int \\mathrm{d}x \\mid -x\\rangle\\langle x| = \\int \\mathrm{d}p \\mid -p\\rangle\\langle p|$ 我们之所以引入 $\\frac{1}{2}$ 因子，是因为 $\\text{tr}[W]=1$ 。 $\\frac{1}{2}W$ 的作用就是将 $(x,p)$ 平面绕着原点旋转 180 度。显然，它是一个厄米算符。 可以证明，它能写成 $\\frac{1}{2}W=e^{-\\mathrm{i}2X;P} = \\sum_{k=0}^\\infty \\frac{1}{k}(-2\\mathrm{i})^k X^kP^k$ 。 其中 $X;P$ 表示在多项式中，所有 $X$ 排到 $P$ 的前面。 我们再定义绕着点 $(x,p)$ 旋转 180 度的算符： $\\frac{1}{2}W(x,p):=e^{\\mathrm{i}2(X-x);(P-p)}$。 可以证明， $W(x,p)$ 也能作为算符的基，叫做 Wigner 基： $F=\\int \\frac{\\mathrm{d}x\\mathrm{d}p}{2\\pi} F_W(x,p)W(x,p)$ $F_W(x,p) = \\text{tr}[FW(x,p)]$ 其中 $F_W(x,p)$ 就是算符 $F$ 的 Wigner 表示。 ","date":"2025-01-08","objectID":"/weyl_wigner/:4:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["数学物理方法"],"content":"Weyl 和 Wigner 表示之间的关系 Weyl 基是幺正的，Wigner 基是厄米的。 可以证明，Wigner 表示是 Weyl 表示的傅里叶变换： $F_W(x,p)=\\int \\frac{\\mathrm{d}x^\\prime\\mathrm{d}p^\\prime}{2\\pi} e^{-\\mathrm{i}(xp^\\prime-px^\\prime)}f_W(x^\\prime,p^\\prime)$ ","date":"2025-01-08","objectID":"/weyl_wigner/:5:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["数学物理方法"],"content":"尾声 值得一提，以上所有步骤都没有任何物理上的动机，而只有数学上的动机，即，为希尔伯特空间上的算符在一组方便的基下找到对应的表示。 ","date":"2025-01-08","objectID":"/weyl_wigner/:6:0","tags":["量子信息"],"title":"量子态/算符的 Weyl 和 Wigner 表示","uri":"/weyl_wigner/"},{"categories":["量子信息"],"content":"学过物理的同学们都知道相空间，它是由广义坐标 $q$ 和广义动量 $p$ 构成的。 例 1：单摆的角度构成一个构型空间 $S_1$ 。角度和角动量构成一个相空间 $S_1 \\times \\mathbb{R}$ 。 例 2：给定经典电磁场的哈密顿量和边界条件，某个模式上的电场强度构成一个构型空间，该模式上电场强度的余弦分量和正弦分量构成一个相空间。 实际上，给定一个构型空间 $M$ ，相空间就是 $M$ 上的余切丛 $T^*M$ 。 然而，解题的时候，我们物理人往往也会用到复平面。 例 1：给定谐振子的哈密顿方程 $\\begin{cases} \\frac{\\mathrm{d}q}{\\mathrm{d}t} = \\omega p\\\\ \\frac{\\mathrm{d}p}{\\mathrm{d}t} = -\\omega q \\end{cases}$ 即 $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\begin{bmatrix} q \\\\ p \\end{bmatrix} = \\begin{bmatrix} 0 \u0026 \\omega \\\\ -\\omega \u0026 0 \\end{bmatrix} \\begin{bmatrix} q\\\\ p \\end{bmatrix}$ 对角化得到特征向量 $a^{\\pm} = q\\pm\\mathrm{i}p$ ，于是 $a^{\\pm}$ 的导数就只和自己有关： $\\frac{\\mathrm{d}a^{\\pm}}{\\mathrm{d}t}=\\mp\\mathrm{i}\\omega a^{\\pm},\\quad a^{\\pm}=a_0^{\\pm} \\exp (\\mp\\mathrm{i}\\omega t)$ 虽然经典力学中没有复数，但是这里的复数作为特征值出现是非常自然的。这个手段量子化之后就得到了产生和湮灭算符。 例 2：描述单模经典电磁场的相量图（Phasor diagram）定义在复平面上。当然，也可以描述电流电压等量。 例 3：描述单模量子电磁场的 Wigner function 定义在复平面上。 这些种种都在暗示我们：难道余切丛可以是个复平面？经过与数学系同学的讨论，的确如此，但前提是该余切丛自身是一个向量空间。论证如下： **（1）**相空间是构型空间的余切丛。 **（2）**任何一个余切丛都自带一个典范的辛结构。 或者说，余切丛上任意一点的切空间自带一个典范的辛形式。 **（3）**如果余切丛本身恰好也是一个向量空间，那么其切空间就自然同构于它自身。从而，根据 (2)，该余切丛也是一个辛向量空间。 **（4）**一个带内积 $g$ 的辛向量空间 $(V,\\omega)$ 自带一个典范的复结构 $J$ [1]。 $V$ 上的复结构 $J$ 定义为 $J \\in \\operatorname{End}(V) \\quad\\text{s.t.} \\quad J^2 = -\\operatorname{id}$ 。 由**（1-4）**可知，如果一个相空间恰好是一个向量空间，那么该相空间自带一个复结构。 所以， $T^*\\mathbb{R} = \\mathbb{R} \\times \\mathbb{R}^*$ 和 $\\mathbb{C}$ 有相同的数学结构。 $T^*(\\mathbb{R}^n) = \\mathbb{R}^n \\times (\\mathbb{R}^{n})^*$ 和 $\\mathbb{C}^n$ 有相同的数学结构。这就是我们可以用复平面来代替相空间的原因。 但要注意，不是所有相空间都可被看作复平面。只有构型空间本身是一个向量空间时，相空间才是一个向量空间，从而才能被看成复平面。例如，单摆的相空间就不是一个向量空间，不能被看作复平面。 更：以上（1-4）有点抽象。下面给个具体的构造。 考虑构型空间 $\\mathbb{R}$ ，相空间 $T^*(\\mathbb{R}) = \\mathbb{R} \\times \\mathbb{R}^*$ ，有全局坐标系 $(p,q)$。 $T^*(\\mathbb{R})$ 上典范的辛形式为 $\\omega= \\mathrm{d} p \\wedge \\mathrm{d} q$ ，它不依赖于基。矩阵形式为 $M(\\omega)=\\begin{pmatrix} 0 \u0026 1\\\\ -1 \u0026 0 \\end{pmatrix}$ 。 $T^*(\\mathbb{R})$ 上的典范欧式内积为 $g = \\mathrm{d}q^2 + \\mathrm{d}p^2$ ，其矩阵形式为 $M(g)=\\begin{pmatrix} 1 \u0026 0\\\\ 0 \u0026 1 \\end{pmatrix}$ 。 我们可以借助 $g(u,v)=\\omega(u,Jv)$ 定义复结构 $J\\in \\text{End}[T^*(\\mathbb{R})]$ 。显然，其矩阵形式满足 $M(g)=M(\\omega)M(J)$ ，所以 $M(J)=\\begin{pmatrix} 0 \u0026 -1\\\\ 1 \u0026 0 \\end{pmatrix}$ 。这个矩阵是不是有点眼熟？没错，它就是虚数单位 $\\mathrm{i}$ 的一种二阶矩阵表示。 ","date":"2024-07-27","objectID":"/phase_space_complex/:0:0","tags":["量子光学"],"title":"相空间为什么有时看起来像一个复平面？","uri":"/phase_space_complex/"},{"categories":["量子信息"],"content":"参考 https://ocw.mit.edu/courses/18-966-geometry-of-manifolds-spring-2007/resources/lect07/ ","date":"2024-07-27","objectID":"/phase_space_complex/:1:0","tags":["量子光学"],"title":"相空间为什么有时看起来像一个复平面？","uri":"/phase_space_complex/"},{"categories":["量子信息"],"content":"闲来无事，复习一下黑体辐射吧~ 很多讲黑体辐射的文章都要一上来就跟你讲一大段历史，很容易看迷糊。 本文单刀直入，直接闭嘴计算。 ","date":"2024-07-27","objectID":"/black_body/:0:0","tags":["量子光学"],"title":"黑体辐射的推导（无废话版）","uri":"/black_body/"},{"categories":["量子信息"],"content":"1. 黑体辐射公式是什么 黑体辐射公式指的是一个黑体在单位频率中所辐射的能量密度。 要计算黑体辐射公式，就要计算从 $\\nu$ 到 $\\nu + \\mathrm{d}\\nu$ 之间有多少个态，以及每个态上有多少个光子，再将它们乘以光子的能量 $h\\nu$ 。 $\\varepsilon(\\nu) \\mathrm{d} \\nu = [(\\nu,\\nu+\\mathrm{d}\\nu) 中有多少个量子态] \\times [这些量子态上有多少个光子] \\times h\\nu$ ","date":"2024-07-27","objectID":"/black_body/:1:0","tags":["量子光学"],"title":"黑体辐射的推导（无废话版）","uri":"/black_body/"},{"categories":["量子信息"],"content":"2. 态密度 $\\nu$ 到 $\\nu + \\mathrm{d}\\nu$ 之间有多少个态？ 考虑一个周期性边界条件的长方体盒子，长宽高为 $L_{x,y,z}$ 。那么盒子中的电磁波的波数 $\\kappa_{x,y,z}$ 就满足： $\\kappa_i = n_i/L_i, \\quad(i=x,y,z)$ 注意 $\\kappa$ 是波数，而不是波矢 $k$ 。二者的关系为 $k = 2\\pi \\kappa$ 。 于是量子态的数量为： $\\mathrm{d} N = \\mathrm{d} n_x\\mathrm{d}n_y\\mathrm{d}n_z = L_xL_yL_z \\mathrm{d}\\kappa_x \\mathrm{d}\\kappa_y\\mathrm{d}\\kappa_z = V \\mathrm{d}^3\\vec{\\kappa}$ 设 $\\nu$ 到 $\\nu + \\mathrm{d}\\nu$ 之间的态的数量为 $f(\\nu)$ ，则 $f(\\nu) \\mathrm{d}\\nu = \\mathrm{d}N = V \\mathrm{d}^3\\vec{\\kappa} = V \\cdot4\\pi \\kappa^2 \\mathrm{d}\\kappa = V \\cdot\\frac{4 \\pi \\nu^2}{c^3} \\mathrm{d} \\nu$ 其中 $\\kappa = |\\vec{\\kappa}|$ ，且 $\\nu = c\\kappa$ 。 所以 $f(\\nu) = V \\cdot4 \\pi \\nu^2/c^3$ 。 由于一个空间模式的电磁波有两种偏振，因此还要乘以 2。另外，我们要求的是能量密度，而不是能量，所以我们可以提前把体积除掉： $f(\\nu) = 8 \\pi \\nu^2/c^3$ 这就是 $\\nu$ 到 $\\nu + \\mathrm{d}\\nu$ 之间的（单位体积的）态的数量。 这一部分的想法就是在三维空间中，频率 $\\nu$ 附近的态密度正比于 $\\nu$ 的平方，正如一个球面的面积正比于半径的平方。 ","date":"2024-07-27","objectID":"/black_body/:2:0","tags":["量子光学"],"title":"黑体辐射的推导（无废话版）","uri":"/black_body/"},{"categories":["量子信息"],"content":"3. 态上的光子数 热平衡时，频率为 $\\nu$ 的态上有多少个光子数？答案是 $1/(e^{h\\nu/kT} - 1)$ 。下面来推导一下： 玻色子体系的配分函数为： $\\begin{aligned} Z \u0026= \\sum_{n_1,n_2,\\cdots} \\exp[-\\beta (n_1 \\varepsilon_1 + n_2 \\varepsilon_2 +\\cdots)] \\\\ \u0026= \\left(\\sum_{n_1} e^{-\\beta n_1\\varepsilon_1}\\right)\\left(\\sum_{n_2} e^{-\\beta n_2\\varepsilon_2}\\right)\\cdots \\\\ \u0026= \\left(\\frac{1}{1-e^{-\\beta \\varepsilon_1}}\\right) \\left(\\frac{1}{1-e^{-\\beta \\varepsilon_2}}\\right) \\cdots \\end{aligned}$ 其中 $\\varepsilon_i$ 表示第 i 个模式上的光子能量， $n_i$ 表示第 i 个频率模式上的光子数。 那么第 i 个模式上的平均光子数为： $\\begin{aligned} \\langle n_i\\rangle = -\\frac{1}{\\beta}\\frac{\\partial \\ln Z}{\\partial \\varepsilon_i} = \\frac{1}{e^{\\beta \\varepsilon_i} - 1} \\end{aligned}$ 也就是说：频率为 $\\nu$ 的态上的热平衡光子数是 $\\langle n(\\nu)\\rangle = 1/(e^{h\\nu/kT} - 1)$ 。 其实这就是不带化学势的玻色-爱因斯坦分布。 ","date":"2024-07-27","objectID":"/black_body/:3:0","tags":["量子光学"],"title":"黑体辐射的推导（无废话版）","uri":"/black_body/"},{"categories":["量子信息"],"content":"4. 结果 $\\begin{aligned} \\varepsilon(\\nu) \\mathrm{d} \\nu \u0026= [(\\nu,\\nu+\\mathrm{d}\\nu) 中有多少个量子态] \\times [这些量子态上有多少个光子] \\times h\\nu \\\\ \u0026=f(\\nu) \\mathrm{d} \\nu \\cdot\\langle n(\\nu)\\rangle \\cdot h\\nu\\\\ \u0026=\\frac{8\\pi \\nu^2}{c^3} \\cdot \\frac{1}{e^{h\\nu/kT}-1} \\cdot h\\nu \\end{aligned}$ 这么看来，黑体辐射公式还是很好记的，只要记住态密度 $f(\\nu)$ 和热平衡时的光子数 $\\langle n(\\nu)\\rangle$ 即可。态密度正比于频率的平方，热平衡光子数服从玻色爱因斯坦分布。 当频率较低时， $\\varepsilon(\\nu)$ 被态密度和单个光子的能量所限制，当频率较高时， $\\varepsilon(\\nu)$ 被平均光子数所限制。 习题 1：在二维世界中，态密度长什么样？黑体辐射的公式长什么样？ 习题 2：紫外灾难是上面哪一步出错导致的？ 习题 3：在常温和可见光频率（ $\\sim 5.5 \\times 10^{14} \\text{Hz}$ ）下，单个模式的热平衡的光子数大概是多少？ 答案 1：在二维世界中，态密度为 $f(\\nu)=2\\pi\\nu/c^2$ ，黑体辐射公式为 $\\varepsilon(\\nu)=\\frac{2\\pi h\\nu^2}{c^2(e^{h\\nu/kT}-1)}$ 答案 2：紫外灾难是直接把 $\\frac{h\\nu}{e^{h\\nu/kT}-1}$ 换成了经典能均分定理的 $kT$ 。当 $\\nu \\ll 1$ 时， $\\frac{h\\nu}{e^{h\\nu/kT}-1} \\rightarrow kT$ ，但当 $\\nu \\gg 1$ 时， $\\varepsilon(\\nu)$ 就会发散，这就是紫外灾难。 答案 3：在常温和可见光频率下， $h\\nu /kT = \\frac{6.6 × 10^{-34} \\times 5.5 \\times 10^{14}}{1.4 × 10^{-23} \\times 300} = 86$ ， $\\frac{1}{e^{86}-1} \\ll 1$ 。这就是为什么我们看不到可见光波段的黑体辐射的原因。 ","date":"2024-07-27","objectID":"/black_body/:4:0","tags":["量子光学"],"title":"黑体辐射的推导（无废话版）","uri":"/black_body/"},{"categories":["量子信息"],"content":"1. 精彩的推理 诺奖得主 Ketterle 在8.422公开课中讲经典热光场的 $g^{(2)}$ 时用了一个非常妙的论证： 根据中心极限定理，电场 $E$ 服从高斯分布，于是光强 $I$ 服从指数分布。 指数分布的概率密度函数（pdf）为： $f(x) = \\gamma e^{-\\gamma x}$ 。 而指数分布的矩有如下性质： $\\langle I^n \\rangle = n! \\langle I\\rangle^n$ 于是一个热光场的经典二阶关联函数 $g^{(2)}(0)$ 就等于 $g^{(2)} := \\langle I^2\\rangle/\\langle I\\rangle^2 = 2$ 这个论证非常美妙，因为它充分利用了热光场的“混乱（chaotic）”性质：根据中心极限定理，无论各个频率模式上的电场的概率分布如何，它们的叠加一定服从高斯分布。从而电场的平方就服从指数分布。 ","date":"2024-07-27","objectID":"/thermal_exponential_dist/:1:0","tags":["量子光学"],"title":"为什么热光场的光强服从指数分布？","uri":"/thermal_exponential_dist/"},{"categories":["量子信息"],"content":"2. 概统复习 等等，真有这么简单吗？我们用本科就学过的概统知识来分析一下，如果一个随机变量服从高斯分布，那么它的平方真的服从指数分布吗？ 我们写出高斯分布的 cdf（累积密度函数）： $p(E\u003cx) = \\Phi(x) = \\int_{-\\infty}^{x} \\frac{1}{\\sigma\\sqrt{2\\pi}}e^{-\\frac{t^2}{2\\sigma^2}} \\mathrm{d}t$ 则光强的 cdf 为 $p(I\u003cy) = p(E^2 \u003c y) = p(-\\sqrt{y}\u003cE\u003c\\sqrt{y}) = \\Phi(\\sqrt{y}) - \\Phi(-\\sqrt{y}) = 2\\Phi(\\sqrt{y}) - 1$ 所以光强的 pdf 应该是 $f(y) = p^\\prime(I \u003c y) = 2 \\Phi^\\prime(\\sqrt{y}) = \\frac{1}{\\sigma\\sqrt{2\\pi y}} e^{-\\frac{y}{2\\sigma^2}}$ 这不是指数分布！和真正的指数分布相比，它多了一个 $y^{-1/2}$ 因子。 问题出在哪里？ 我们可以换个思路，反过来问：如果一个随机变量服从指数分布，那么它的平方根服从什么分布？ 指数分布的 cdf 为： $p(I\u003cy) = 1 - e^{-\\gamma y}$ 那么电场的 cdf 为： $p(E \u003c x) = \\frac{1 + p(-x\u003cE\u003cx)}{2} = \\frac{1 + p(I\u003cx^2)}{2} = \\frac{2 - e^{-\\gamma x^2}}{2}$ 所以电场的 pdf 应该是： $f(x) = p^\\prime(E\u003cx) = \\gamma x e^{-\\gamma x^2}$ 这个分布叫做瑞利分布，它比高斯分布多了一个 $x$ 因子。 直觉敏锐的同学可以想到，瑞利分布实际上对应一个服从高斯分布的二维随机向量的模长： $f(r) = \\int_{0}^{2\\pi} \\frac{1}{2\\pi} e^{-\\frac{r^2}{2\\sigma^2}} r\\mathrm{d}\\theta$ 等等，电场原来是一个二维随机变量？没错！电场除了幅值，还有相位——它其实是一个复数！如果一个复随机变量服从高斯分布，那么它的模平方确实就服从指数分布了。 到此为止，问题完美解决。 ","date":"2024-07-27","objectID":"/thermal_exponential_dist/:2:0","tags":["量子光学"],"title":"为什么热光场的光强服从指数分布？","uri":"/thermal_exponential_dist/"},{"categories":["量子信息"],"content":"3. 从经典到量子 不过，以上所有都只能说明经典 $g^{(2)}$ 为 2，不能说明量子 $g^{(2)}$ 也是 2。 量子 $g^{(2)}$ 与经典 $g^{(2)}$ 的唯一不同就是考虑了光的粒子性。如果你探测到了一个光子，那么光场就少了一个光子。因此量子 $g^{(2)}$ 不是 $\\langle n ^2\\rangle/\\langle n\\rangle^2$ ，而是 $\\langle n (n-1)\\rangle/\\langle n\\rangle^2$ 。 有没有一种可能，量子 $g^{(2)}$ 其实不是等于 2，而是等于 1.9999？幸运的是，尽管量子 $g^{(2)}$ 与经典 $g^{(2)}$ 的形式有所不同，量子 $g^{(2)}$ 仍然等于 2。下面我们来推导一下。 根据 Boltzmann law，热平衡时有： $p_n = p_0 e^{-n\\omega/T} = (1-e^{-\\omega/T}) e^{n\\omega/T}$ 其中 $p_n$ 是某个模式上光子数为 n 的概率。 这是一个几何分布。几何分布是指数分布的离散版本，指数分布是几何分布的连续版本。 于是量子 $g^{(2)}$ 为 $\\begin{align} g^{(2)} := \\frac{\\langle n(n-1) \\rangle}{\\langle n\\rangle^2} = \\frac{\\sum n(n-1) p_n }{(\\sum n p_n)^2} = 2 \\end{align}$ 计算留给读者作为一个有趣的练习。关键在于计算指数分布的矩，它比指数分布的矩要复杂得多。 可见，虽然量子 $g^{(2)}$ 的形式变了，但对应的概率分布，也从光强所服从的指数分布，变成了粒子数所服从的几何分布。这两个效应完美抵消，使得量子 $g^{(2)}$ 仍然等于 2。 ","date":"2024-07-27","objectID":"/thermal_exponential_dist/:3:0","tags":["量子光学"],"title":"为什么热光场的光强服从指数分布？","uri":"/thermal_exponential_dist/"},{"categories":["量子信息"],"content":"4. 量子性 量子 $g^{(2)}$ 比经典 $g^{(2)}$ 特殊在哪呢？特殊之处在于：量子 $g^{(2)}$ 可以小于 1，而经典 $g^{(2)}$ 不能小于 1。 对于经典 $g^{(2)}$ 而言，$g^{(2)} = \\langle I^2 \\rangle / \\langle I\\rangle^2 \\ge [\\cancel{\\text{Var}(I)} + \\langle I\\rangle^2] / \\langle I\\rangle^2 = 1$ ，也就是说最小值当且仅当光强不变时取到，即当电场是一个幅值不变的正弦波时取到。 而量子 $g^{(2)}$ 就不一样了。探测到一个光子就意味着光场少了一个光子，而单光子态只有一个光子，探测到一个就没了。可见对于单光子态而言，量子 $g^{(2)}$ 为 0。 更一般而言，对于量子 $g^{(2)}$ 小于 1 的光场，我们称之为亚泊松光场；对于量子 $g^{(2)}$ 大于 1 的光场，我们称之为超泊松光场。 当光场为（相位确定或不确定的）相干态时，量子 $g^{(2)}$ 等于 1，此时光子数服从泊松分布。它的经典对应是一个相位确定或不确定（但幅值确定）的正弦波。 量子 $g^{(2)}$ 还有一个特殊之处：对于热光场而言，即使只有一个频率模式，该模式也能表现出量子 $g^{(2)}$ 为 2。而对于经典热光场而言，之前的论证可能涉及不同模式之间的叠加。这一点在公开课中一度引起了困惑。 当然，如果对经典情形也使用 Boltzmann law，也可以立即得到指数分布。只不过利用中心极限定理的论证实在很妙。也许中心极限定理与 Boltzmann law 之间有普适的联系。 ","date":"2024-07-27","objectID":"/thermal_exponential_dist/:4:0","tags":["量子光学"],"title":"为什么热光场的光强服从指数分布？","uri":"/thermal_exponential_dist/"},{"categories":["量子信息"],"content":"再见了旋转波近似：量子拉比模型的解析解 ","date":"2024-07-27","objectID":"/rabi/:0:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"1. 前言 在量子力学的早期阶段，拉比为了处理电磁场与原子的相互作用，提出了拉比模型。由于这个模型只量子化了原子，而没有量子化电磁波，因此它虽然能解释众多现象（例如拉比振荡），但不能解释自发辐射这种涉及电磁场量子化的现象。 为了解释自发辐射等涉及电磁场量子化的现象，Jaynes 和 Cummings 在 1962 年提出了量子拉比模型（Quantum Rabi Model，QRM），这个模型将电磁场也量子化了，使得电磁场的真空涨落不能被忽略，于是自发辐射无非就是电磁场的真空涨落所“激发”的“受激辐射”。 然而，在 QRM 被提出后相当长一段时间内，人们都认为它没有解析解，只有做了旋转波近似（RWA）之后才有解析解。人们把做了旋转波近似后的模型叫做 Jaynes-Cummings 模型（JCM）。 JCM 成功解释了自发辐射和真空拉比振荡等现象，但由于做了旋转波近似，它仍然不能解释兰姆位移等现象。另外，如今人们已经能在 Circuit QED 系统中实现强耦合，而当耦合非常强的时候，旋转波近似会失效，此时 JCM 与实验结果有较大的偏差。可见，在一些情况下，人们仍然需要 QRM。 令人惊讶的是，QRM 的解析解直到 2011 年才被发现 [1]。自那以后，人们对各种推广量子拉比模型解析解也开始感兴趣，例如推广到多原子（Dicke 模型）和多光场模式的情形。 本文将推导 QRM 的解析解，结构如下： 第二节：介绍 QRM 和 JCM 的哈密顿量 第三节：简要推导 JCM 的解析解 第四节：推导 QRM 的解析解 第五节：介绍 JCM 和 QRM 的守恒量与对称性 ","date":"2024-07-27","objectID":"/rabi/:1:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"2. QRM 和 JCM 的哈密顿量 量子拉比模型（QRM）描述了一个单模光场和二能级系统的相互作用。 记单模光场的希尔伯特空间为 $\\mathcal{H} \\cong L^{2}(\\mathbb{R})$ ，二能级系统的希尔伯特空间为 $\\mathcal{K} \\cong \\mathbb{C}^2$ ，则 QRM 的哈密顿量 $H\\in \\mathcal{L}(\\mathcal{H}\\otimes \\mathcal{K})$ 如下： $\\begin{aligned} H\u0026= \\underbrace{\\omega \\left(a^\\dag a+\\frac{1}{2}\\right)}_{\\text{field}}+ \\underbrace{ \\frac{\\Delta}{2} \\sigma_z}_{\\text{atom}} + \\underbrace{g\\sigma_x(a+a^\\dag)}_{\\text{atom-field coupling}} \\\\\u0026= \\underbrace{\\omega \\left(a^\\dag a+\\frac{1}{2}\\right)}_{\\text{field}}+ \\underbrace{ \\frac{\\Delta}{2} \\sigma_z}_{\\text{atom}} + \\underbrace{g(\\sigma_++\\sigma_-)(a+a^\\dag)}_{\\text{atom-field coupling}} \\end{aligned}$ 其中 $a^\\dag , a$ 是 $\\mathcal{H} $ 上的产生和湮灭算符， $\\sigma_z, \\sigma_{\\pm}$ 是 $\\mathcal{K}$ 上的泡利 Z 算符和升降算符。 $g$ 叫做拉比频率，它衡量了光场与二能级系统之间的耦合强度。 如果将其中能量差较大的项 $\\sigma_- a$ 和 $\\sigma_+ a^\\dag$ 去掉，我们就得到了 Jaynes-Cummings 模型（JCM）的哈密顿量： $\\begin{aligned} H\u0026= \\underbrace{\\omega \\left(a^\\dag a+\\frac{1}{2}\\right)}_{\\text{field}}+ \\underbrace{ \\frac{\\Delta}{2} \\sigma_z}_{\\text{atom}} + \\underbrace{g(\\sigma_+ a + \\sigma_- a^{\\dag})}_{\\text{atom-field coupling}}\\end{aligned}$ 这就是旋转波近似。被去掉的项叫做逆时针旋转项（Counter-Rotating Terms），留下来的项叫做顺时针旋转项（Co-rotating Terms）。 旋转波近似之所以合理，是因为逆时针旋转项涉及的两个能级的能量差为 $\\omega + \\Delta$ ，远大于顺时针旋转项的能量差 $|\\omega - \\Delta|$ 。前者涉及的指数因子为 $e^{\\pm\\mathrm{i} (\\omega + \\Delta) t}$ ，后者为 $e^{\\pm\\mathrm{i}(\\omega-\\Delta)}t$ 。由于 $e^{\\pm\\mathrm{i} (\\omega + \\Delta) t}$ 变化太快，可以视作平均为零而消掉。 另外，从微扰计算也可以看出这一点：做微扰计算后得到的项会正比于能量差的倒数，前者为 $\\frac{1}{\\omega +\\Delta}$ ，后者为 $\\frac{1}{|\\omega - \\Delta|}$ 。而 $\\frac{1}{\\omega + \\Delta}$ 远小于 $\\frac{1}{|\\omega - \\Delta|}$ ，因此可以将前者忽略掉。 ","date":"2024-07-27","objectID":"/rabi/:2:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"2. JCM 的解析解 我们可以将 $H$ 在光子数表象下展开： $\\begin{aligned} H \u0026= \\color{gray}{ \\begin{matrix} |g,0\\rangle \\\\ |e,0\\rangle \\\\ |g,1\\rangle \\\\ |e,1\\rangle \\\\ |g,2\\rangle \\\\ \\vdots \\end{matrix} } \\begin{bmatrix} 1 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 3 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 3\u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 5\u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\end{bmatrix} \\frac{\\omega}{2}+\\begin{bmatrix} -1 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 -1 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 1 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 -1 \u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\end{bmatrix} \\frac{\\Delta}{2} +\\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 1 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\sqrt{2} \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 \\sqrt{2} \u0026 0 \u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\end{bmatrix} g \\end{aligned} $ 其中 $g,e$ 分别代表二能级系统的基态和激发态， $0,1,2,\\cdots$ 代表光场的激发数（即光子数）。 它可以进一步写成： $\\begin{aligned} H = \\bigoplus_{n=1}^\\infty \\begin{bmatrix} n\\omega+\\frac{\\Delta}{2} \u0026 g\\sqrt{n} \\\\ g\\sqrt{n} \u0026 (n+1)\\omega -\\frac{\\Delta}{2} \\end{bmatrix} \\end{aligned}$ 其中 $n$ 代表总激发数，即二能级系统激发数和光场激发数（即光子数）的总和。 这个矩阵显然可以精确对角化，特征值为 $\\left(n+ \\frac{1}{2}\\right)\\omega \\pm \\sqrt{\\left(\\frac{\\omega - \\Delta}{2}\\right)^2 + ng^2}$ 。记 $\\Delta_n = \\sqrt{\\left(\\frac{\\omega - \\Delta}{2}\\right)^2 + ng^2}$，则能级就是 $E_{\\pm,n} = \\left(n + \\frac{1}{2}\\right)\\omega \\pm \\frac{\\Delta_n}{2}$ 。 这些能级上的本征态叫做缀饰态（dressed state）： $\\begin{aligned} |-,n\\rangle \u0026= \\cos \\theta_n |e,n-1\\rangle - \\sin \\theta_n |g,n\\rangle \\\\ |+,n\\rangle \u0026= \\sin \\theta_n |e,n-1\\rangle + \\cos \\theta_n |g,n\\rangle \\end{aligned}$ 其中 $\\begin{aligned} \\cos \\theta_n \u0026= \\frac{2\\sqrt{n}g}{\\sqrt{(\\Delta_n-\\Delta_0)^2 + 4ng^2}} \\\\ \\sin \\theta_n \u0026= \\frac{\\Delta_n-\\Delta_0}{\\sqrt{(\\Delta_n-\\Delta_0)^2 + 4ng^2}} \\end{aligned}$ 且 $\\Delta _0 := \\Delta - \\omega$ 。 ","date":"2024-07-27","objectID":"/rabi/:3:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"4. QRM 的解析解 接下来我们按照 2012 年的一篇文献的方法[#ref\\\\_2](#ref\\\\_2)推导 QRM 的解析解。较于 2011 年文献[#ref\\\\_1](#ref\\\\_1)的最早方法，它更加适合物理学工作者而不是数学工作者。 我们把 QRM 哈密顿量在基 ${|+\\rangle, |-\\rangle} =\\left{\\frac{|e\\rangle + |g\\rangle}{\\sqrt{2}} ,\\frac{|e\\rangle - |g\\rangle}{\\sqrt{2}}\\right}$ 下展开得： $H = \\begin{bmatrix} \\omega a^\\dag a + g(a+a^\\dag) \u0026 \\Delta/2 \\\\ \\Delta/2 \u0026 \\omega a^\\dag a + g(a-a^\\dag) \\end{bmatrix}$ 可以验证 $H = [\\omega a^\\dag a + g(a+a^\\dag)] |+\\rangle\\langle+| + [\\omega a^\\dag a - g(a+a^\\dag)] |-\\rangle\\langle-| + \\frac{\\Delta}{2}(|+\\rangle\\langle-| + |-\\rangle\\langle+|)$ 做 Bogoliubov 变换 $A = a +g/\\omega,,B=a-g/\\omega$ ，并且定义 Extended Fock states： $|0\\rangle_A=e^{-\\frac{g}{\\omega}(a^\\dag - a)} |0\\rangle = |\\frac{-\\omega}{g}\\rangle$ $|n\\rangle_A = \\frac{A^{\\dag n}}{\\sqrt{n!}} |0\\rangle_A$ 注意到 $|0\\rangle_A$ 是一个参数为 $-\\frac{\\omega}{g}$ 的相干态。 可以验证 $[A,A^\\dag]=1$ ，因此对于普通 Fock states 成立的关系对于 Extended Fock states 也成立： $A|n\\rangle_A = \\sqrt{n} |n-1\\rangle_A$ $A^\\dag |n\\rangle_A = \\sqrt{n+1} |n + 1\\rangle_A$ 此时有 $H = \\begin{bmatrix} \\omega A^\\dag A - g^2 /\\omega\u0026 \\Delta/2 \\\\ \\Delta/2 \u0026 \\omega A^\\dag A - 2g(A+A^\\dag) + 3g^2/\\omega \\end{bmatrix}$ 设本征态为： $|\\psi\\rangle=\\begin{bmatrix} \\sum \\sqrt{n!} e_n |n\\rangle_A \\\\ \\sum \\sqrt{n!} f_n |n\\rangle_A \\end{bmatrix}$ 代入 $H|\\psi\\rangle = E|\\psi\\rangle$ 得： $\\begin{cases} e_n = -\\frac{\\Delta/2}{ n\\omega -g^2/\\omega - E} f_n \\\\ nf_n = \\Omega(n-1) f_{n-1} - f_{n-2} \\end{cases}$ 其中 $\\Omega(n) = \\frac{2g}{\\omega}+\\frac{1}{2g}\\left[ n\\omega - g^2/\\omega -E - \\frac{(\\Delta/2)^2}{n\\omega - g^2/\\omega - E}\\right]$ 同理，哈密顿量也可以写成： $H = \\begin{bmatrix} \\omega B^\\dag B -2g(B + B^\\dag) + 3g^2 \u0026 \\Delta/2 \\\\ \\Delta/2 \u0026 \\omega B^\\dag B - g^2/\\omega \\end{bmatrix}$ 设本征态为 $|\\psi^\\prime\\rangle=\\begin{bmatrix} \\sum \\sqrt{n!} (-1)^nf_n^\\prime |n\\rangle_B \\\\ \\sum \\sqrt{n!} (-1)^ne_n^\\prime |n\\rangle_B \\end{bmatrix}$ 代入 $H|\\psi\\rangle = E|\\psi\\rangle$ 得： $\\begin{cases} e_n^\\prime = -\\frac{\\Delta/2}{n\\omega - g^2/\\omega -E} f^\\prime_n \\\\ nf^\\prime_n = \\Omega(n-1)f^\\prime_{n-1} - f_{n-2} \\end{cases}$ 可见 $f_n$ 和 $f_n^\\prime$ 以及 $e_n$ 和 $e_n^\\prime$ 都满足相同的递归关系。令 $f_0 = f_0^\\prime = 1$ ，则 $f_n = f_n^\\prime$ ， $e_n = e_n^\\prime$ 。 由于两个本征态 $|\\psi \\rangle, |\\psi^\\prime\\rangle$ 之间必须成比例 $|\\psi^\\prime\\rangle = \\kappa |\\psi\\rangle$ ，其中 $\\kappa \\in \\mathbb{C}$ ，于是有： $\\begin{cases} \\sum \\sqrt{n!} (-1)^nf_n |n\\rangle_B = \\kappa \\sum \\sqrt{n!} e_n |n\\rangle_A \\\\ \\sum \\sqrt{n!} (-1)^ne_n |n\\rangle_B = \\kappa\\sum \\sqrt{n!} f_n |n\\rangle_A \\end{cases}$ 两边同时左乘真空态 $\\langle0|$ ，由于 $\\begin{aligned} \\sqrt{n!}\\langle 0 | n\\rangle_A \u0026= \\langle 0 |A^{\\dag n}|0\\rangle_A \\\\\u0026= \\langle 0|(a+\\lambda)^\\dag | 0 \\rangle_A \\\\\u0026= \\lambda^n\\langle 0|0\\rangle_A \\\\\u0026= \\lambda^n e^{-\\lambda^2/2} \\end{aligned}$ $\\sqrt{n!} \\langle 0|n\\rangle_B = (-\\lambda)^n e^{-\\lambda^2/2}$ 其中 $\\lambda = g/\\omega$ 。 于是： $\\begin{cases} \\sum \\lambda^n e^{-\\lambda^2/2} f_n = \\kappa \\sum \\lambda^n e^{-\\lambda^2/2} e_n \\\\ \\sum\\lambda^n e^{-\\lambda^2/2}e_n = \\kappa\\sum \\lambda^n e^{-\\lambda^2/2} f_n \\end{cases}$ $\\Rightarrow \\left(\\sum \\lambda^n e^{-\\lambda^2/2} f_n\\right)^2 = \\left(\\sum\\lambda^n e^{-\\lambda^2/2} e_n \\right)^2 $ $\\Rightarrow \\sum \\lambda^n e^{-\\lambda^2/2} (f_n \\pm e_n )= 0$ $\\begin{aligned} \\Rightarrow \\sum \\lambda^n e^{-\\lambda^2/2} f_n \\left(1\\pm \\frac{\\Delta/2}{n\\omega - g\\lambda -E}\\right) = 0 \\end{aligned}$ 令 $G_{\\pm}(x) = \\sum f_n \\lambda^n \\left(1\\mp \\frac{\\Delta}{2\\omega(x+\\lambda^2-n)}\\right)$ ，它是一个超越函数。 可见 $G_{\\pm}(x) $ 的零点就是本征态能级（单位为 $ \\omega$）。 本征态为： $\\begin{aligned} \u0026\\phantom{=}\\sum_n\\left[ \\sqrt{n!} f_n |n\\rangle_B \\otimes \\frac{|e\\rangle + |g\\rangle}{\\sqrt{2}} + \\sqrt{n!} e_n |n\\rangle_B \\otimes \\frac{|e\\rangle - |g\\rangle}{\\sqrt{2}}\\right] \\\\\u0026=\\sum_n \\left[ \\sqrt{n!/2} (f_n - e_n)\\right] |n\\rangle_B \\otimes |g\\rangle + \\sum_n \\left[ \\sqrt{n!/2} (f_n + e_n)\\right] |n\\rangle_B \\otimes |e\\rangle \\\\\u0026=\\sum_n \\left[ \\sqrt{\\frac{n!}{2}} f_n \\left(1 - \\frac{\\Delta/2}{n\\omega - g\\lambda -E}\\right)\\right] |n\\rangle_B \\otimes |g\\rangle + \\sum_n \\left[ \\sqrt{\\frac{n!}{2}} f_n \\left(1 +","date":"2024-07-27","objectID":"/rabi/:4:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"5. 守恒量与对称性 JCM 有守恒量 $N = a^\\dag a+\\sigma_+\\sigma_- = a^\\dag a + (\\mathbb{I} + \\sigma_z)/2$ ，其本征值为 $n=0,1,2,\\cdots$ ， $N|\\pm,n\\rangle = \\left(n + \\frac{1\\pm 1}{2}\\right)|\\pm,n\\rangle$ 。这个守恒量的物理意义就是激发数的总和。 守恒量 $N$ 可以生成连续的 $U(1)$ 对称性。这是因为 $[N,H] = 0 \\Rightarrow [e^{-\\mathrm{i\\theta}N},H]=0$ 。也就是说当我们做如下变换之后，哈密顿量不变： $a \\rightarrow e^{-\\mathrm{i}\\theta N} a e^{\\mathrm{i}\\theta N} = a e^{-\\mathrm{i}\\theta}$ $a^\\dag \\rightarrow e^{-\\mathrm{i}\\theta N} a^\\dag e^{\\mathrm{i}\\theta N} = a^\\dag e^{\\mathrm{i}\\theta}$ $\\sigma_{\\pm} \\rightarrow e^{-\\mathrm{i}\\theta N} \\sigma_{\\pm} e^{\\mathrm{i}\\theta N} = \\sigma_\\pm e^{\\pm\\mathrm{i}\\theta}$ 而 QRM 的守恒量是 $\\Pi = e^{-\\mathrm{i}\\pi N} = -\\sigma_+\\sigma_- \\otimes e^{\\mathrm{i}\\pi a^\\dag a}$ ，其本征值为 $\\pm 1$ ， $\\Pi |\\pm,n\\rangle = \\mp (-1)^n |\\pm,n\\rangle$ 。 QRM 虽然失去了 $U(1)$ 对称性，但是仍有离散的 $Z_2$ 对称性，这是因为 $[\\Pi,H]=0$ 使得当我们做如下变换之后，哈密顿量不变： $a \\rightarrow \\Pi a \\Pi^\\dag = -a$ $a^\\dag \\rightarrow \\Pi a^\\dag \\Pi^\\dag = -a^\\dag$ $\\sigma_\\pm \\rightarrow \\Pi \\sigma_\\pm \\Pi^\\dag = -\\sigma_\\pm$ $Z_2$ 对称性可以看作是 $U(1)$ 对称性从 $\\theta \\in [0,2\\pi)$ 破缺到 $\\theta \\in {0,\\pi}$ 。这一点也可以形象地从哈密顿量中看出来：JCM 只有顺时针旋转项，因此有连续的 $U(1)$ 对称性，而 QRM 既有顺时针旋转项又有逆时针旋转项，这两个项只能在 $\\theta \\in {0,\\pi}$ 处汇合，因此只有离散的 $Z_2$ 对称性。 ","date":"2024-07-27","objectID":"/rabi/:5:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":"参考 Braak, D. Integrability of the Rabi Model. Phys. Rev. Lett. 2011, 107 (10), 100401. [https://doi.org/10.1103/PhysRevLett.107.100401](https://doi.org/10.1103/PhysRevLett.107.100401) Chen, Q.-H.; Wang, C.; He, S.; Liu, T.; Wang, K.-L. Exact Solvability of the Quantum Rabi Model Using Bogoliubov Operators. Phys. Rev. A 2012, 86 (2), 023822. https://doi.org/10.1103/PhysRevA.86.023822 ","date":"2024-07-27","objectID":"/rabi/:6:0","tags":["量子光学"],"title":"再见了旋转波近似：量子拉比模型的解析解","uri":"/rabi/"},{"categories":["量子信息"],"content":" 大部分介绍激光的资料都是以经典或半经典形式推导的。那么激光的全量子理论是什么样的呢？它又有什么用呢？ 本文简要介绍激光的 Scully-Lamb 理论，它是一个全量子的理论，由于一般量子光学教材的最后几章才会介绍，加上（半）经典的理论在大部分情况下也很好用，所以熟悉 Scully-Lamb 理论的人并不多。 Scully-Lamb 理论对泵浦强度低于或接近阈值时的光子数分布作出了更准确的预言，这是（半）经典理论所做不到的。 本文结构如下： 第一节介绍 Jaynes-Cummings 模型，它负责处理光场与二能级系统的相互作用。 第二节介绍 Lindblad 主方程，它负责处理光场与热库的相互作用。 第三节推导 Scully-Lamb 理论。它无非就是 Jaynes-Cummings 模型和 Lindblad 主方程共同作用的结果。 为简明起见，本文设置 $\\hbar = 1$ 。 ","date":"2024-07-19","objectID":"/laser_quantum2/:0:0","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"1. Jaynes-Cummings 模型（JCM） （熟悉 JCM 的可以跳过这一节） JCM 描述的是一个单模光场与一个二能级系统的耦合，由于它将光场也量子化了，因此是一个全量子模型。 除了光场量子化，JCM 还做了偶极矩近似（Dipole Approximation）和旋转波近似（Rotating-Wave Approximation，RWA），以便于求解。这个过程不在本文介绍的范围内，请有兴趣的读者自行参阅教材和互联网资料。 记单模光场的希尔伯特空间为 $\\mathcal{H} \\cong L^{2}(\\mathbb{R})$ ，二能级系统的希尔伯特空间为 $\\mathcal{K} \\cong \\mathbb{C}^2$ ，则 Jaynes-Cumming 哈密顿量 $H \\in \\mathcal{L}(\\mathcal{H}\\otimes \\mathcal{K})$ 如下： $\\begin{aligned} H\u0026= \\underbrace{\\omega \\left(a^\\dag a+\\frac{1}{2}\\right)}_{\\text{field}}+ \\underbrace{\\omega_a \\frac{\\sigma_z}{2}}_{\\text{atom}} + \\underbrace{\\Omega(\\sigma_+ a + \\sigma_- a^{\\dag})}_{\\text{atom-field coupling}} \\\\ \u0026= \\underbrace{\\omega \\left(a^\\dag a+\\frac{1}{2}+\\frac{\\sigma_z}{2}\\right)}_{H_0} + \\underbrace{\\frac{\\Delta}{2} \\sigma_z + \\Omega(\\sigma_+ a + \\sigma_- a^{\\dag})}_{H_\\text{I}} \\end{aligned}$ 其中 $a^\\dag , a$ 是 $\\mathcal{H}$ 上的产生和湮灭算符， $\\sigma_z, \\sigma_{\\pm}$ 是 $\\mathcal{K}$ 上的泡利 Z 算符和升降算符。 $\\Omega$ 叫做拉比频率，它衡量了光场与二能级系统之间的耦合强度。 ","date":"2024-07-19","objectID":"/laser_quantum2/:1:0","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"1.1 JCM 的对角化 由于 $H_0$ 只有对角项，我们可以从解中将它分离出来：令 $|\\psi\\rangle = e^{-\\mathrm{i}H_0t} |\\psi_\\text{I}\\rangle$ ，则有 $\\mathrm{i} \\frac{\\mathrm{d}}{\\mathrm{d}t}|\\psi_\\text{I}\\rangle = H_\\text{I}|\\psi_\\text{I}\\rangle$ 。因此我们只需要研究 $H_\\text{I}$ 即可。这个方法叫做相互作用表象（Interaction Picture）。 我们可以将 $H_\\text{I}$ 在光子数表象下展开： $\\begin{aligned} H_\\text{I} \u0026= \\color{gray}{ \\begin{matrix} |g,0\\rangle \\\\ |e,0\\rangle \\\\ |g,1\\rangle \\\\ |e,1\\rangle \\\\ |g,2\\rangle \\\\ \\vdots \\end{matrix} } \\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 1 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\sqrt{2} \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 \\sqrt{2} \u0026 0 \u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\end{bmatrix}\\Omega+ \\begin{bmatrix} -1 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 -1 \u0026 0 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 1 \u0026 0 \u0026 \\cdots \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 -1 \u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\end{bmatrix} \\frac{\\Delta}{2} \\end{aligned} $ 其中 $g,e$ 分别代表二能级系统的基态和激发态， $0,1,2,\\cdots$ 代表光场的激发数（即光子数）。 它可以进一步写成： $\\begin{aligned} H_\\text{I} = \\bigoplus_{n=1}^\\infty \\begin{bmatrix} \\frac{\\Delta}{2} \u0026 \\Omega\\sqrt{n} \\\\ \\Omega\\sqrt{n} \u0026 -\\frac{\\Delta}{2} \\end{bmatrix} \\end{aligned}$ 其中 $n$ 代表总激发数，即二能级系统激发数和光场激发数（即光子数）的总和。 这个矩阵显然可以精确对角化，特征值为 $\\pm \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^2 + n\\Omega^2}$ 。记 $\\Delta_n = \\sqrt{\\Delta^2 + 4n\\Omega^2}$，则原表象（非相互作用表象）下的能级就是 $E_{\\pm,n} = \\omega \\left(n + \\frac{1}{2}\\right) \\pm \\frac{\\Delta_n}{2}$ 。 这些能级上的本征态叫做缀饰态（dressed state）： $\\begin{aligned} |-,n\\rangle \u0026= \\cos \\theta_n |e,n-1\\rangle - \\sin \\theta_n |g,n\\rangle \\\\ |+,n\\rangle \u0026= \\sin \\theta_n |e,n-1\\rangle + \\cos \\theta_n |g,n\\rangle \\end{aligned}$ 其中 $\\begin{aligned} \\cos \\theta_n \u0026= \\frac{2\\sqrt{n}\\Omega}{\\sqrt{(\\Delta_n-\\Delta)^2 + 4n\\Omega^2}} \\\\ \\sin \\theta_n \u0026= \\frac{\\Delta_n-\\Delta}{\\sqrt{(\\Delta_n-\\Delta)^2 + 4n\\Omega^2} }\\end{aligned}$ ","date":"2024-07-19","objectID":"/laser_quantum2/:1:1","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"1.2 JCM 下的光场演化 由于我们最终只关心光场的量子态，我们会对原子部分取偏迹。设原子初态为 $|e\\rangle\\langle e|$ ，则经过时间 $\\tau$ ，光场演化为 $\\rho \\rightarrow F(\\tau) \\rho := \\text{tr}_\\text{a}[e^{-\\mathrm{i}H \\tau} (|e\\rangle\\langle e|\\otimes \\rho) e^{\\mathrm{i}H\\tau}]$ 其中 $H$ 是 JCM 哈密顿量， $\\text{tr}_\\text{a}$ 表示对原子系统取偏迹。 我们先来考察 $|n\\rangle$ 经过 $F(\\tau)$ 如何演化，即计算 $F(\\tau)(|n\\rangle\\langle n|)$ ： $\\begin{aligned} |e,n\\rangle \u0026= \\cos \\theta_n | -,n+1\\rangle + \\sin \\theta_n |+,n+1\\rangle \\\\ e^{-\\mathrm{i}H\\tau} |e,n\\rangle \u0026= \\cos \\theta_n e^{-\\mathrm{i} \\frac{\\Delta_{n+1}}{2}\\tau} |-,n+1\\rangle + \\sin \\theta_n e^{\\mathrm{i} \\frac{\\Delta_{n+1}}{2}\\tau}|+,n+1\\rangle \\\\ \u0026= \\cos \\theta_n e^{-\\mathrm{i} \\frac{\\Delta_{n+1}}{2}\\tau} (\\cos \\theta_n |e,n\\rangle - \\sin \\theta_n |g,n + 1\\rangle)\\\\\u0026\\phantom{=}+ \\sin \\theta_n e^{\\mathrm{i} \\frac{\\Delta_{n+1}}{2}\\tau}(\\sin \\theta_n |e,n\\rangle + \\cos \\theta_n |g,n+1\\rangle) \\\\ \u0026= C_{e,n} |e,n\\rangle + C_{g, n+1} | g, n+1\\rangle \\\\ \\text{tr}_\\text{atom}[e^{-\\mathrm{i}H\\tau}|e,n\\rangle\\langle e,n|e^{\\mathrm{i}H\\tau}] \u0026=|C_{e,n}|^2 |n\\rangle\\langle n| + |C_{g,n+1}|^2 |n+1\\rangle\\langle n+1| \\end{aligned}$ 其中 $\\begin{aligned} C_{e,n} \u0026= \\cos(\\Delta_{n+1} \\tau /2) + \\mathrm{i} \\cos(2\\theta_n)\\sin(\\Delta_{n+1} \\tau/2)\\\\ C_{g,n+1} \u0026= \\mathrm{i} \\sin (2\\theta_n) \\sin (\\Delta_{n+1} \\tau/2) \\end{aligned}$ 假设光场的初态是一个光子数混态 $\\rho = \\sum_n p_n |n\\rangle\\langle n|$ ，则有 $\\begin{aligned} F(\\tau) \\rho \u0026= \\sum_n p_n F(\\tau)(|n\\rangle\\langle n|)\\\\ \u0026= \\sum_n p_n [|C_{e,n}|^2 |n\\rangle\\langle n | + |C_{g,n+1}|^2 |n+1\\rangle\\langle n+1|] \\\\ \u0026= \\sum_n p_n |C_{e,n}|^2 |n\\rangle\\langle n | + \\sum_{n=1} p_{n-1} |C_{g,n}|^2 |n\\rangle\\langle n| \\end{aligned}$ 于是新的 $p_n^\\prime = \\langle n|F(\\tau) \\rho |n\\rangle$ 为 $\\begin{aligned} \\langle n|F(\\tau) \\rho |n\\rangle \u0026= |C_{e,n}|^2 p_n + |C_{g,n}|^2 p_{n-1} \\\\ \u0026=: (1-C_n) p_n + C_{n-1} p_{n-1} \\end{aligned}$ 其中 $C_n := |C_{g,n+1}|^2 \\Rightarrow 1-C_n = |C_{e,n}|^2$ 。 $\\langle n|F(\\tau) \\rho |n\\rangle$ 的表达式我们之后会用到。 另外还有 $C_{n-1} = |C_{g,n}|^2=\\sin^2 (2\\theta_n) \\sin^2 \\left(\\frac{\\Delta_{n}}{2} \\tau\\right) = \\frac{4n\\Omega^2}{4n\\Omega^2+\\Delta_n^2} \\sin^2 \\left(\\frac{\\Delta_{n}}{2} \\tau\\right)$ ，这个结果之后也有用。 总结：本节求出了 Jaynes-Cummings 模型的解析解。给定一个二能级原子与光场的耦合系统，其初态为 $\\rho$ ，我们可以求出以后任意时刻的状态 $F(\\tau) \\rho$ 。特别地，我们写出了光场密度矩阵的对角项 $\\langle n|F(\\tau) \\rho |n\\rangle$ ，也就是演化后的光子数分布。 ","date":"2024-07-19","objectID":"/laser_quantum2/:1:2","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"2. Lindblad 主方程 对于封闭系统而言，量子态 $\\rho$ 的演化遵循海森堡方程： $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\rho = -\\mathrm{i}[H,\\rho]$ 。它其实就是薛定谔方程 $\\frac{\\mathrm{d}}{\\mathrm{d}t}|\\psi\\rangle = -\\mathrm{i}H|\\psi\\rangle$ 的统计叠加。这是一个酉（幺正，Unitary）的过程。 对于开放系统而言，量子态 $\\rho$ 的演化不再是一个酉过程。当环境足够大以至于没有记忆性时，即当环境满足马尔科夫（Markovian）近似时，量子态的演化是一个保迹（trace preserving）且保完全正（complete positive）的量子通道（quantum channel）。可以证明此时 $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\rho$ 的一般形式为： $\\begin{aligned} \\frac{\\mathrm{d}}{\\mathrm{d}t} \\rho = \\mathcal{L}[\\rho]= -\\mathrm{i}[H,\\rho] - \\sum_k \\gamma_k \\left(\\frac{1}{2} L_k^\\dag L_k \\rho - L_k \\rho L_k^\\dag + \\frac{1}{2} \\rho L_k^\\dag L_k\\right) \\end{aligned}$ 显然 $\\frac{\\mathrm{d}}{\\mathrm{d} t} \\text{tr}[\\rho]=0$ ，所以它是保迹的。 这就是 Lindblad 主方程，其中 $\\mathcal{L}$ 叫做 Lindbladian，可以看作 Hamiltonian 在开放系统下的推广。 有时它也叫 Liouvillian，但是 Liouvillian 更加 general 一些，例如它没有 complete positivity 的要求。 Liouvillian 是哦系上指的是超算符 $\\mathcal{B}(\\mathcal{B}(\\mathcal{H}))$ ，其中 $\\mathcal{B}(\\cdot)$ 代表 $\\cdot$ 上的所有线性算符。超算符就是“算符的算符”。 在文献中，Liouvillian 和 Lindbladian 有时会混用。 当光场与一个平均光子数为 $\\lambda$ 的热库耦合时，它遵循的 Lindblad 主方程为： $\\begin{aligned} \\dot{\\rho}=\\mathcal{L}[\\rho] = -\\frac{\\omega}{2Q}(\\lambda +1)\u0026(a^\\dag a \\rho - 2 a \\rho a^\\dag + \\rho a^\\dag a) \\\\ - \\frac{\\omega}{2Q}\\lambda \u0026(a a^\\dag \\rho - 2a^\\dag \\rho a+\\rho a a^\\dag) \\end{aligned}$ 在光学波段，由黑体辐射可知 $\\lambda \\approx 0$ ，则上式简化为： $\\begin{aligned} \\dot{\\rho}=\\mathcal{L}[\\rho] = -\\frac{\\omega}{2Q}\u0026(a^\\dag a \\rho - 2 a \\rho a^\\dag + \\rho a^\\dag a) \\end{aligned}$ 它的对角项为 $\\dot{p}_n=\\langle n | \\mathcal{L}[\\rho] | n \\rangle = -\\frac{\\omega}{Q}(np_n - (n+1)p_{n+1}) $ 该式的物理意义十分明显：能级 $|n\\rangle\\langle n|$ 弛豫到 $|n - 1\\rangle\\langle n -1|$ 的概率正比于 $np_n$ 。 ","date":"2024-07-19","objectID":"/laser_quantum2/:2:0","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"3. Scully-Lamb 激光理论 利用上述的 JCM 和 Lindbladian，我们就可以用全量子方式处理激光系统。 激光中有很多个原子，为什么不用多原子的 TCM（Tavis-Cummings 模型），而是用单原子的 JCM？这是因为 TCM 是用来描述原子的集体行为的：当波长处于微波范围时，由于波长和共振腔的长度相近，所有原子会感受到同一个电磁场，这会导致超辐射（Superradiance）等现象。但是在光学波段（$10^{14} \\sim 10^{15} \\text{Hz}$）内，共振腔的长度远大于相干长度，使得各个原子独立地与光场进行相互作用。此时使用单原子的 JCM 就足够了，我们只要把 JCM 的解对于各个原子作平均即可。 在激光中有两个主要的物理过程：一是 JCM Hamiltonian 所描述的受激辐射过程，二是 Lindbladian 所描述的弛豫过程。我们只要把这两个过程结合起来就可以得到光场 $\\rho$ 的演化方程： $\\dot{\\rho} = -\\mathrm{i},\\text{tr}_\\text{a}[H,\\rho_\\text{af}] + \\mathcal{L}[\\rho]$ 其中 $H$ 是 JCM 哈密顿量， $\\rho_\\text{af}$ 是原子和光场的整体量子态， $\\text{tr}_\\text{a}$ 表示对原子系统取偏迹。 直接计算该方程[1]当然可以给出结果，但为了简化计算[2]，我们可以先考虑这两个过程的相对时间尺度。 ","date":"2024-07-19","objectID":"/laser_quantum2/:3:0","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"3.1 时间尺度分析 **受激辐射**：上能级和下能级的原子都可以通过自发辐射的方式退激发，平均寿命为纳秒量级（甚至皮秒量级）。即 JCM 所描述的相干过程的持续时间是**纳秒到皮秒**量级。换言之，在光场的演化 $\\rho \\rightarrow F(\\tau) \\rho := \\text{tr}_\\text{a}[e^{-\\mathrm{i}H \\tau} (|e\\rangle\\langle e|\\otimes \\rho) e^{\\mathrm{i}H\\tau}]$ 中， $\\tau$ 的平均值为纳秒到皮秒。 **弛豫**：光子在腔内来回反射，每次反射有一定概率损失掉。设反射率为 $99.9%$ ，腔长为 30cm，则弛豫特征时间为 $1\\text{ns} \\cdot \\frac{\\log 37 %}{\\log 99.9 %} \\approx 10^3 \\text{ns}$ ，是**微秒**量级。换言之，在光场的演化 $\\rho \\rightarrow e^{t_p \\mathcal{L}} \\rho$ 中， $t_p$ 的平均值为微秒。 可见，Lindbladian 的作用时间远大于 JCM Hamiltonian 的作用时间。因此，我们可以进行**粗粒度**的分析，将两个过程分开讨论。 记 $\\rho(t_{i+1}) = e^{t_p \\mathcal{L}} F(\\tau) \\rho(t_i)$ ，其中 $\\tau \\ll t_p = t_{i+1} - (t_i + \\tau) \\approx t_{i+1} - t_i$ 。它表示在 $(t_i,t_i +\\tau)$ 这段时间内，光场根据 JCM 演化；在 $(t_i+\\tau,t_{i+1})$ 这段时间内，光场根据 Lindbladian 演化。 ","date":"2024-07-19","objectID":"/laser_quantum2/:3:1","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"3.2 随机矩阵理论 注意， $t_p$ 和 $\\tau$ 都是随机变量，因此我们还要对 $\\rho(t_{i+1}) = e^{t_p \\mathcal{L}} F(\\tau) \\rho(t_i)$ 这个式子进行平均操作。 严格处理需要随机矩阵理论，但我们这里可以不用那么关心严格性。 我们先讨论 $t_p$ 和 $\\tau$ 所服从的概率分布： 因为各个原子独立地与泵浦光相互作用，所以原子被泵浦到激发态的时间是完全随机的。这使得单位时间内的激发数服从泊松分布，且相邻两次激发的时间间隔服从指数分布，即 $p(t_p) =R e^{-R t_p}$ ，其中 $R$ 是泵浦速率。 又因为自发辐射发生的时间也是完全随机的，所以 $\\tau$ 也服从指数分布，即 $p(\\tau) = \\gamma e^{-\\gamma \\tau}$ ，其中 $\\gamma^{-1}$ 是激发态的平均寿命。 我们先对 $t_p$ 求平均： $\\begin{aligned} {\\rho}(t_{i+1}) \u0026= \\left[\\int \\mathrm{d}t_pe^{-t_pR}e^{t_p \\mathcal{L}} \\right]F(\\tau) \\bar{\\rho}(t_i) \\\\ \u0026= \\ \\frac{R}{R-\\mathcal{L}} F(\\tau) {\\rho}(t_i) \\end{aligned}$ 于是稳态解应满足： $R[1-F(\\tau)] {\\rho} = \\mathcal{L} \\rho$ 我们考虑上式的对角项，并代入第一节和第二节所得到的 $\\langle n|F(\\tau) \\bar\\rho | n\\rangle$ 和 $\\langle n | \\mathcal{L} \\bar\\rho | n \\rangle$ ，有： $R[C_n p_n - C_{n-1} p_{n-1}] = -\\frac{\\omega}{Q}(np_n - (n+1)p_{n+1}) $ 记 $S_n = \\frac{\\omega}{Q}np_n - RC_{n-1} p_{n-1}$ ，则有 $S_n =S_{n+1}$ ，为了使 $p_n$ 收敛，我们需令 $S_n=0$ ，于是有： $p_n = \\frac{RQ}{n\\omega}C_{n-1} p_{n-1} =\\frac{RQ}{\\omega} \\frac{4\\Omega^2}{4n\\Omega^2+\\Delta_n^2} \\sin^2 \\left(\\frac{\\Delta_{n}}{2} \\tau\\right)p_{n-1} $ 现在我们来对 $\\tau$ 求平均 $\\begin{aligned} {p}_n \u0026=\\frac{RQ}{\\omega} \\frac{4\\Omega^2}{4n\\Omega^2+\\Delta_n^2}\\left[ \\gamma\\int\\mathrm{d}\\tau e^{-\\gamma \\tau} \\sin^2 \\left(\\frac{\\Delta_{n}}{2} \\tau\\right) \\right] \\bar{p}_{n-1} \\\\ \u0026= \\frac{A}{B +k} {p}_{n-1} \\end{aligned}$ 其中 $A = \\frac{RQ}{2\\omega}$ ， $B=\\frac{\\Delta^2 + \\gamma^2}{4\\Omega^2}$ 。 于是 $\\begin{aligned} {p}_n = {p}_0 \\prod_{k=1}^n\\frac{A}{B+k} \\end{aligned}$ 。 在实际激光器中， $\\Delta$ 和 $\\Omega$ 的数量级接近，都为 MHz。而前面提到过， $\\gamma^{-1}$ 的数量级为纳秒到皮秒，即 $\\gamma$ 的数量级为 GHz 到 THz，因此 $B$ 是一个数量级为 $10^6 \\sim 10^{12}$ 的常数。常数 $A$ 则取决于泵浦强度和共振腔的品质。 我们之所以只求 $\\rho$ 的对角项的稳态解，是因为所有非对角项的稳态解都是零。因此当求出 $p_n$ 后，我们就能直接写出量子态为 $\\rho = \\sum_n p_n |n\\rangle\\langle n|$ 。 ","date":"2024-07-19","objectID":"/laser_quantum2/:3:2","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"3.3 结果分析：光子数分布 当泵浦很弱时， $A\\ll B$ ，此时 ${p}_n \\approx {p}_0 \\left(\\frac{A}{B}\\right)^n$ ，这是一个温度为 $T=\\omega \\left[\\log\\left(\\frac{2\\omega B}{RQ}\\right)\\right]^{-1}$ 的热分布。 当泵浦很强时， $A \\gg B$ ，此时 ${p}_n \\approx {p}_0 \\frac{A^n}{n!}$ ，这是一个泊松分布。此时量子态为： $\\rho = e^{-A}\\sum_k \\frac{A^{k}}{k!} |k\\rangle\\langle k |$ 这是一个平均粒子数为 $A$ 的泊松分布。 在相干态表象下， $\\rho$ 可以写成： $\\rho = \\int_0^{2\\pi} \\frac{\\mathrm{d}\\theta}{2\\pi} |\\alpha e^{\\mathrm{i}\\theta}\\rangle\\langle\\alpha e^{\\mathrm{i}\\theta}|,\\quad A=|\\alpha|^2$ 可见它其实是一个相位随机的相干态。相干态 $|\\alpha\\rangle$ 对应一个振幅和相位都非常确定的经典电磁波，而这里将它的相位从 $0$ 到 $2\\pi$ 积分了，这表现了我们对相位信息的无知，这种无知从根本上来源于我们对二能级系统（增益介质）的微观状态的无知。可以说这个 $\\rho = \\rho_{\\text{epistemic}}$ 是认识论的量子态。 而从本体论的角度而言，系统的量子态应当坍缩为一个有确定相位的 $\\rho_{\\text{ontic}} = |\\alpha\\rangle$ ，只是我们没办法知道是哪个相位而已。这是因为在光学频率 $\\sim 10^{15} \\text{Hz}$ 下，人类无法观测绝对相位。不过，相对相位可以观测，因此我们仍能观察到干涉现象。简单的计算也可以看出这一点：无论是用混态 $\\rho = \\int_0^{2\\pi} \\frac{\\mathrm{d}\\theta}{2\\pi} |\\alpha e^{\\mathrm{i}\\theta}\\rangle\\langle\\alpha e^{\\mathrm{i}\\theta}|$ 还是用纯态 $\\rho = |\\alpha\\rangle\\langle \\alpha|$ 去计算关联函数 $\\langle a^\\dag(t)a(0)\\rangle = \\text{tr}[\\rho a^\\dag(t)a(0)]$ ，计算结果都不会有任何区别。这一度引起了关于相干现象的讨论：相干到底是一种幻觉，还是一种物理实在？ [3]前者的支持者认为上文的“相位坍缩”诠释存在“preferred basis”的问题，不过这个问题可以认为已经被解决了：相干态是在激光腔开放系统下寿命最长的态。 当泵浦数量级与阈值相当时，有精确解 ${p}_n = p_0 \\frac{B! A^n}{(n+B)!}$ 。此时我们来看看它是超泊松还是亚泊松分布。 $\\langle n \\rangle = \\sum_n np_n = A - B + Bp_0$ $\\langle n^2\\rangle = \\langle n \\rangle^2 + A$ 此时 $g^{(2)}(0) = \\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} = 1 + \\frac{B(1-p_0)}{[A-B(1-p_0)]^2} \u003e 1$ 可见当泵浦不强时，光子数分布实际上是超泊松分布。当泵浦越来越强时， $g^{(2)}(0) \\rightarrow 1$ ，趋于泊松分布。如此精细的预言是半经典理论所做不到的。 ","date":"2024-07-19","objectID":"/laser_quantum2/:3:3","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"3.4 结果分析：自然线宽 在薛定谔表象下，量子态 $\\rho$ 的演化为 $\\mathrm{d}\\rho = -\\mathrm{i},\\text{tr}_\\text{a}[H,\\rho_\\text{af}]\\mathrm{d}\\tau+ \\mathcal{L}[\\rho]\\mathrm{d}t_p$ ，而在海森堡表象下，算符的演化就是它的对偶 channel： $ \\mathrm{d}{R} = \\mathrm{i},\\text{tr}_\\text{a}[H,R]\\mathrm{d}\\tau + \\mathcal{L}^*[R] \\mathrm{d}t_p$ 其中 $\\begin{aligned} \\mathcal{L}^*[R]= -\\frac{\\omega}{2Q}\u0026(a^\\dag a R- 2 a^\\dag R a + R a^\\dag a) \\end{aligned}$ 。 令 $R = a$ 得： $\\begin{aligned} \\mathrm{d}{a} \u0026= -\\mathrm{i} \\omega a \\mathrm{d}\\tau - \\frac{\\omega}{2Q} a \\mathrm{d}t_p \\end{aligned}$ 由 $\\gamma \\mathrm{d}\\tau = R\\mathrm{d}t_p$ 得 $\\begin{aligned} \\dot{a} \u0026= \\frac{\\mathrm{d}a}{\\mathrm{d}\\tau} = -\\mathrm{i} \\omega a - \\frac{\\omega}{2Q} \\frac{\\gamma}{R}a\\end{aligned}$ 解得 $a(t ) =a(0) e^{-\\mathrm{i}\\omega t} e^{-\\frac{\\omega\\gamma}{2RQ}t}, \\quad a\u003e0$ 。 其一阶关联函数为： $\\begin{aligned} g^{(1)}(t\u003e0)\u0026=\\langle a^\\dag(t) a(0)\\rangle / \\langle a^\\dag(0) a(0)\\rangle \\\\ \u0026= \\text{tr}[a(0) \\rho a^\\dag(t)] / \\text{tr}[a(0) \\rho a^\\dag(0)] \\\\ \u0026= e^{-\\mathrm{i}\\omega t} e^{-\\frac{\\omega\\gamma}{2RQ}t} \\end{aligned}$ 时间平移不变性要求 $g^{(1)}(t) = g^{(1)}(-t)$ ，所以 $\\begin{aligned} g^{(1)}(t)= e^{-\\mathrm{i}\\omega t} e^{-\\frac{\\omega\\gamma}{2RQ}|t|} \\end{aligned}$ 对其进行傅里叶变换即可得到频谱： $\\begin{aligned} F(\\omega^\\prime) = \\frac{\\frac{\\omega\\gamma}{2RQ}}{(\\omega^\\prime-\\omega)^2 + \\left(\\frac{\\omega\\gamma}{2RQ}\\right)^2} \\end{aligned}$ 这是一个洛伦兹线形，其半高全宽（FWHM）为 $\\Delta \\omega = \\frac{\\omega\\gamma}{RQ} = \\frac{2\\gamma}{A}$ 。 可见自然线宽取决于上能级和下能级的平均寿命 $\\gamma^{-1}$ 。这是很符合直觉的，因为上下能级的寿命决定受激辐射的相干作用时间。 另外，泵浦越强，自然线宽越窄。这也是符合直觉的，因为泵浦越强，两次受激辐射过程的时间间隔越短，于是弛豫的作用时间也越短。 ","date":"2024-07-19","objectID":"/laser_quantum2/:3:4","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"参考 Marlan O. Scully \u0026 M. Suhail Zubairy, Quantum Optics Pierre Meystre \u0026 Murray Sargent, Elements of Quantum Optics Bartlett, S. D., Rudolph, T. \u0026 Spekkens, R. W. Dialogue Concerning Two Views on Quantum Coherence: Factist and Fictionist. Int. J. Quantum Inform. 04, 17–43 (2006). ","date":"2024-07-19","objectID":"/laser_quantum2/:4:0","tags":["量子光学"],"title":"激光的全量子理论","uri":"/laser_quantum2/"},{"categories":["量子信息"],"content":"SPDC产生的频率纠缠光，其中的闲置光经过光纤放大器，还与信号光纠缠吗？ 我们先用极限思维，考虑两个极限： 极限1：放大器的增益等于1，也就是没有任何增益 此时放大器相当于啥也没做，是一个identity channel。那么当然纠缠还是会保持的。（其实也不一定。即使增益为零，也可能引入额外的噪声，我们这里暂且忽略） 极限2：放大器的增益非常大。 假设此时纠缠能够保持，那么我们是可以得到宏观的薛定谔猫态的。但是这样的态实验上基本得不到，因为它早就退相干了。（当然，也有一些例外，例如 bright squeezed states） 那么，介于这两个极限之间，我们可以说，当增益比较小的时候，纠缠能够保持，但是增益比较大的时候（实际上这个“比较大”的数量级估计也就是～10，参考 N00N 态），由于噪声或者退相干，纠缠会消失掉。 下面我们分两种情况讨论，分别是基于 $\\chi^{(2)}$ 非线性的参量放大器和基于受激辐射的放大器。 ","date":"2024-05-27","objectID":"/spdc_optical_amp/:0:0","tags":["量子光学"],"title":"SPDC产生的频率纠缠光，其中的闲置光经过光纤放大器，还与信号光纠缠吗？","uri":"/spdc_optical_amp/"},{"categories":["量子信息"],"content":"一、基于 $\\chi^{(2)}$ 非线性的光放大器 如果这里的光纤放大器是基于 $\\chi^{(2)}$ 非线性，即 PDC，参量下转换。PDC 如果用来做光放大，那么也可以叫做 OPA，即光学参量放大。注意，这里的 PDC 要和 SPDC，即自发参量下转换区分开。 假设 SPDC 和 OPA 的 pump 足够强，那么它们的哈密顿量就分别可以写成： $H_\\text{SPDC}=\\mathrm{i}\\hbar(\\hat{a}^\\dag \\hat{b}^\\dag - \\hat{a} \\hat{b})$ $H_\\text{OPA} = \\mathrm{i}\\hbar(\\hat{b}^\\dag \\hat{c}^\\dag -\\hat{b}\\hat{c})$ 其中 $\\hat{a}$ 和 $\\hat{b}$ 代表 SPDC 的 idler 和 signal 模式上的湮灭算符， $\\hat{b}$ 和 $\\hat{c}$ 代表 OPA 的 signal 和 idler 模式上的湮灭算符。 那么最终的量子态就是 $|\\Psi\\rangle = \\exp[\\mathrm{i}g_\\text{2}H_\\text{OPA} /\\hbar]\\exp[\\mathrm{i}g_\\text{1}H_\\text{SPDC}/\\hbar] |0,0,0\\rangle_{abc}$ 其中 $g_1$ 是 SPDC 的增益的对数， $g_2$ 是 OPA 的增益的对数。 最后再 trace 掉 OPA 的 idler 就行了： $\\rho=\\operatorname{tr}_c[|\\Psi\\rangle\\langle\\Psi|]$ 严格的具体计算可能不太好算，做量子信息理论的大佬看到有兴趣的话可以帮忙算一下。另外还要考虑用什么 entanglement measure。PPT 准则肯定用不了，因为这是两个 mode，而不是两个 qubit。 不过也可以猜一下计算过程：盲猜经过 OPA 并且 trace 掉 OPA idler 的这个过程等价于一个 dephasing channel。然后我们再把 SPDC 态在低增益极限下近似为一个贝尔态。此时纠缠程度就直接取决于 dephasing 的强度了，这个强度与 OPA 的增益正相关，并且很可能正比于增益，也就是 $\\exp(g_2)$ 。考虑一个 20 分贝的增益，那么纠缠程度会减小 $10^{20/10} = 100$ 倍。 所以经过一通“如算”，我们得到结论：OPA 的增益越大，纠缠程度越小。 ","date":"2024-05-27","objectID":"/spdc_optical_amp/:1:0","tags":["量子光学"],"title":"SPDC产生的频率纠缠光，其中的闲置光经过光纤放大器，还与信号光纠缠吗？","uri":"/spdc_optical_amp/"},{"categories":["量子信息"],"content":"二、基于受激辐射的光放大器 以上说的是基于参量下转换的放大器。但最常用的 EDFA 并不是基于 $\\chi^{(2)}$ 非线性的，而是基于受激辐射光放大的，和激光的原理一样。 这个时候的哈密顿量就要比 OPA 复杂多了，因为涉及到原子。我们先考虑单模光场： $H = \\hbar\\omega a^\\dag a + \\sum_j \\hbar \\omega_a \\sigma^+_j \\sigma^-_j + \\hbar \\Omega \\sum_j (\\sigma^+_j a -\\sigma_j^- a^\\dag)$ 其中 $\\omega$ 是光场的频率， $\\omega_a$ 是原子的能级差， $\\sigma^{\\pm}$ 是原子能级的升降算符， $\\Omega$ 是拉比频率。 这其实就是 Tavis-Cummings model 的哈密顿量。这玩意儿是没有通用解析解的，所以只能做做微扰近似。 经过一顿微扰计算 [1]，我们可以得到： $(\\Delta X)^2 = G (\\Delta X_{0})^2 + (2 n_{\\text{sp}}-1)(G-1) \\frac{1}{4}$ 其中 $X$ 是光场的任意一个 quadrature，可以理解为电场强度的实部或虚部。 $G$ 是增益。 $n_\\text{sp} = \\frac{N_2}{N_2-N_1}$ 表示布居数反转的程度， $n_\\text{sp}$ 越大，反转程度越低， $n_\\text{sp}$ 越小，反转程度越高，最小为 1。 可以发现，EDFA 不仅将输入信号的噪声放大了 $G$ 倍，还额外引入了真空场的噪声，并且将真空场的噪声放大了 $ (2 n_{\\text{sp}}-1)(G-1)$ 倍。这就是 ASE，Amplified Spontaneous Emission，即被放大的自发辐射噪声。见下图： 经过 EDFA 的量子态的 Wigner 表示。图源 [1] 以上说的是动力学。这些动力学如何影响纠缠呢？ 众所周知，SPDC 得到的 signal 和 idler 是一个纠缠态： $|\\Psi\\rangle_\\text{SPDC} \\approx |\\text{vac}\\rangle + \\lambda \\int \\mathrm{d}\\omega_s \\mathrm{d}\\omega_i f(\\omega_s,\\omega_i)a^\\dag_s(\\omega_s) a^\\dag_i(\\omega_i) |\\text{vac}\\rangle$ ，其中 $f(\\omega_s,\\omega_i)$ 是联合频率分布，取决于相位匹配条件和 pump 的线宽（也就是动量守恒与能量守恒条件）。 $|\\text{vac}\\rangle$ 代表所有模式上的真空态， $\\lambda \\ll 1$ 表示低增益极限下的 SPDC 的平均光子数，这是实验上常用的情况。 $f(\\omega_s,\\omega_i)$ 通常不是可分的，即不能被写成 $f(\\omega_s,\\omega_i) = f_s(\\omega_s) f_i(\\omega_i)$ 。因此 SPDC 的 signal 和 idler 模式之间呈现出频率纠缠。 既然是频率纠缠，那么我们就要考虑多模情况。为了简单起见，我们只考虑两个频率模式 $\\omega = \\mu,\\nu$ 。那么可以将 SPDC 态写成： $|\\text{vac}\\rangle + \\lambda (|1\\rangle \\otimes |0\\rangle \\otimes |0\\rangle \\otimes |1\\rangle+ |0\\rangle \\otimes |1\\rangle \\otimes |1\\rangle \\otimes |0\\rangle)$ 其中从左到右四个模式分别是 signal 的 $\\mu$ 和 $\\nu$ 频率模式和 idler 的 $\\mu$ 和 $\\nu$ 频率模式。经过 EDFA 放大，得到： $|0\\rangle \\otimes |0\\rangle \\otimes |G,0\\rangle \\otimes |G,0\\rangle +\\lambda(|1\\rangle \\otimes |0\\rangle \\otimes |G,0\\rangle \\otimes |G,1\\rangle+ |0\\rangle \\otimes |1\\rangle \\otimes |G,1\\rangle \\otimes |G,0\\rangle)$ 其中 $|G,0\\rangle,|G,1\\rangle$ 分别表示 $|0\\rangle ,|1\\rangle$ 经过 EDFA 得到的态。这个东西我实在是不会算。但是我们可以从它们的 Wigner 函数的形状上看出一些端倪。 我们首先看一下 $|0\\rangle$ 和 $|1\\rangle$ 的 Wigner 函数： 真空态和单光子数态的 Wigner 函数，图源 Wikipedia 它们经过大增益的 EDFA 之后，就会像一张大饼一样，从原点向四面八方摊平，并且还要再加上被放大的自发辐射噪声（ASE），从而单光子数态的 Wigner negativity 应该也会消失。 此时的态已经完全是一个粒子数和相位不确定性都非常大的混态，类似于 thermal state。为什么我 claim 它是一个混态？这是因为在 Tavis-Cummings model 中，最后一步的计算要 trace 掉原子态，这几乎一定会给出一个混态。 在如此大的增益以及粒子数不确定性下， $|0\\rangle$ 和 $|1\\rangle$ 的区别已经不大，因此应当会有 $|G,0\\rangle \\approx |G,1\\rangle$ 。于是量子态就可以写成： $ [|0\\rangle \\otimes |0\\rangle+\\lambda(|1\\rangle \\otimes |0\\rangle + |0\\rangle \\otimes |1\\rangle)] \\otimes (|G,0\\rangle \\otimes |G,0\\rangle)$ 前两个模式是 signal 模式，后两个模式是 idler 模式，可见，现在它们不再纠缠，而是可分态。 总结一下就是，EDFA 会将输入信号的噪声放大，并且还额外引入 ASE 噪声，这些噪声会导致量子态变成一个混态。而一般来说，纠缠的纯态变成混态之后，纠缠程度会变低乃至消失。 如果实在非常想刨根问底，可以根据 [1] 中的步骤，在 Tavis-Cummings model 中用微扰论计算一下量子态的演化（[1] 中是在海森堡表象下计算，因此只能给出算符的期望值，而不是量子态）。 ","date":"2024-05-27","objectID":"/spdc_optical_amp/:2:0","tags":["量子光学"],"title":"SPDC产生的频率纠缠光，其中的闲置光经过光纤放大器，还与信号光纠缠吗？","uri":"/spdc_optical_amp/"},{"categories":["量子信息"],"content":"参考 Inoue, K. Quantum Noise in Optical Amplifiers. in Optical Amplifiers - A Few Different Dimensions (ed. Choudhury, P. K.) (InTech, 2018). doi:10.5772/intechopen.72992. ","date":"2024-05-27","objectID":"/spdc_optical_amp/:3:0","tags":["量子光学"],"title":"SPDC产生的频率纠缠光，其中的闲置光经过光纤放大器，还与信号光纠缠吗？","uri":"/spdc_optical_amp/"},{"categories":["量子信息"],"content":"太长不看版： “超距且瞬时（超光速）”的相互作用是一种过时的观点。根据狭义相对论，类空距离的事件之间不存在任何相互作用。学界的主流观点是将量子态和测量基矢共同作为 reality，这叫做互文性。非局域性是互文性的一个推论。 正文： 讨论量子纠缠的”速度”是没有意义的。 如果两个测量事件 a 和 b 之间的距离是类空的，那么 a 既不在 b 的过去，也不在 b 的未来。 这是因为，在狭义相对论中，如果 a 和 b 的距离是类空的，那么 a 在 b 的过去还是未来取决于观察者的参考系。因此 a 和 b 之间没有确定的时序，从而也不可能有因果关系。 此时我们应当说：a 和 b 的测量结果之间呈现出非局域的关联，而不是 a 的测量结果会影响到 b 的测量结果，或者 b 的测量结果会影响到 a 的测量结果。 具体看下图： 图源 [1]，虽然是 MDPI 的水刊，但是这个图很好 在上图中，a 和 b 两个事件在彼此的光锥之外，它们之间是不存在任何相互作用的，真正存在的是它们的测量结果之间的关联。 关联不难理解，因为它们都来源于一个贝尔对。 真正难以理解的是：当你改变测量基矢时（参考各种 Bell test 实验），你会发现这种关联也取决于测量基矢，即随着测量基矢的变化而变化。这导致以下几件事情至少有一个成立： 量子态 $|\\psi\\rangle$ 本身是不完备的，不能完全描述现实（reality）。只有在测量基矢 $\\mathsf{E}$ 确定时， $(|\\psi\\rangle,\\mathsf{E})$ 才是完备的。这就是互文性（contextuality），即 reality 仅当测量基矢确定后才存在，在此之前不存在。此时非局域性是互文性的一个推论。 如果你坚持局域且非互文的 reality 是存在的，并且提出一个局域且非互文性的隐变量理论，那么你就要接受负概率出现在这种理论中。此时你的理论不能用经典概率论来描述，而是要用 non-Kolmogorov 的概率论。 如果你认为负概率本身就违反 reality ，那就回到第一点。 第一点提到的互文性是目前学界的主流。现在有越来越多研究互文性的文章，应该算是量子信息研究中的一股小小的潮流吧。 互文性的核心思想就是：quantum reality 仅当测量仪器给出时才存在。有些人也把这个叫做sub-reality 或者 contexual reality。因此个人认为互文性这个翻译不是很好，应该叫做“语境依赖性”。“语境”在这里指的就是测量仪器。 但遗憾的是，相当一部分学者仍然不了解互文性，大部分标准教材中也没有介绍互文性，更不用指望它们出现在科普与大众文化中了。不过这也可以理解：互文性是上世纪 90 年代才提出的概念，比贝尔晚了 30 年，在一定程度上属于学术前沿。 总结：“超距且瞬时（超光速）”的相互作用是一种过时的观点。根据狭义相对论，类空距离的事件之间不存在任何相互作用。学界的主流观点是将量子态和测量基矢共同作为 reality，这叫做互文性。非局域性是互文性的一个推论。 ","date":"2024-05-27","objectID":"/contextuality/:0:0","tags":["量子信息"],"title":"量子纠缠的速度是否超过光速？","uri":"/contextuality/"},{"categories":["量子信息"],"content":"参考 Entropy 2021, 23(12), 1660 https://doi.org/10.3390/e23121660 ","date":"2024-05-27","objectID":"/contextuality/:1:0","tags":["量子信息"],"title":"量子纠缠的速度是否超过光速？","uri":"/contextuality/"},{"categories":["量子信息"],"content":"一般理性告诉我们，实际的位置测量不会产生 delta 函数，因为 delta 函数本身是病态的。那么实际的位置测量的坍缩态应该长什么样呢？ 太长不看版： 设待测系统的波函数为 $\\varphi(x)$ ，则坍缩后的波函数为： $\\varphi^{(q)}(x) = \\mathcal{A}\\psi(q-gx) \\varphi(x)$ 其中 $\\psi(x)$ 是仪器指针的初态波函数。 $q$ 是仪器指针的读数。 $g$ 是仪器和待测系统之间的耦合强度。$\\begin{aligned} \\mathcal{A} = \\left[\\int_\\mathbb{R}\\psi(q-gx) \\varphi(x)\\right]^{-1} \\end{aligned}$ 是合适的归一化常数。 ","date":"2024-05-27","objectID":"/position_measurement/:0:0","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"一、前置知识 ","date":"2024-05-27","objectID":"/position_measurement/:1:0","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"1.1 符号约定 $L^2(\\mathbb{R})$ ： $\\mathbb{R}$ 上平方可积函数构成的希尔伯特空间。 $\\mathcal{L}(\\mathcal{H})$ ：希尔伯特空间 $\\mathcal{H}$ 上的（有界）算符。 $\\mathbb{I}_{\\mathcal{H}}$ ：希尔伯特空间 $\\mathcal{H}$ 上的恒等算符。 $\\mathcal{E}(\\mathcal{H})$ ：希尔伯特空间 $\\mathcal{H}$ 上的 effect。定义为 $\\mathcal{E}(\\mathcal{H}) := \\\\{ E\\in \\mathcal{L}(\\mathcal{H}) | E =E^*, 0 \\le E\\le \\mathbb{I}_{\\mathcal{H}}\\\\}$ 。 $\\text{Leb}(\\mathbb{R})$ ： $\\mathbb{R}$ 上的 Lebesgue sigma algebra。 ","date":"2024-05-27","objectID":"/position_measurement/:1:1","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"1.2 量子信息的一些基础知识 PVM（投影测量）与 POVM Quantum channel 及其对偶 我不打算在此处详细介绍它们。维基百科或数学教科书已经有详尽的介绍，请自行参阅。也可以看我的文章：https://zhuanlan.zhihu.com/p/679038823 ","date":"2024-05-27","objectID":"/position_measurement/:1:2","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"1.3 测度、勒贝格积分 位置和动量算符的谱是连续的。数学上严格 formulate 连续的谱需要测度和勒贝格积分。 我不打算在此处详细介绍它们。维基百科或数学教科书已经有详尽的介绍，请自行参阅。 另外，PVM 和 POVM 中的字母 M 指的就是测度（Measure）。量子力学建立在概率论的基础上，概率论建立在测度论的基础上。所以关于测度的知识是必要的。 ","date":"2024-05-27","objectID":"/position_measurement/:1:3","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"1.4 位置与动量算符的谱分解 $L^2(\\mathbb{R})$ 上的位置算符 $Q \\in \\mathcal{L}(L^2(\\mathbb{R}))$ 有谱分解： $Q = \\int_\\mathbb{R} x\\mathsf{Q}(\\mathrm{d}x)$ 。这是一个勒贝格积分。 其中 $\\mathsf{Q}$ 是位置投影测量，即 PVM（Projection Valued Measure，是 POVM，Positive Operator Valued Measure 的特例），它定义为一个 operator-valued 的测度： $\\mathsf{Q}: \\text{Leb}(\\mathbb{R}) \\rightarrow \\mathcal{E}(L^2(\\mathbb{R}))$ ，$[\\mathsf{Q}(A) \\varphi](x):=\\chi_A(x) \\varphi(x)$，其中 $\\chi_A(x)=\\begin{cases} 1, \\quad x\\in A \\\\ 0, \\quad x \\notin A \\end{cases}$ 是集合 $A$ 的特征函数。 选读：动量 PVM 可以定义为 $\\mathsf{P}(A) = F^* \\mathsf{Q}(A) F$ ，其中 $F$ 是 Fourier-Plancherel 算子 $\\mathcal{F} \\in \\mathcal{L}(L^2(\\mathbb{R}))$ ，定义为： $(\\mathcal{F}\\varphi)(p)=\\frac{1}{\\sqrt{2\\pi}}\\int_{\\mathbb{R}}\\mathrm{e}^{-ipx}\\varphi(x)\\mathrm{d}x$ ","date":"2024-05-27","objectID":"/position_measurement/:1:4","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"二、测量模型 本节的整体思路如下： 考虑一个待测系统，其希尔伯特空间为 $\\mathcal{H}$ ，状态为 $\\rho$ 。接着我们将系统 $\\mathcal{H}$ 和另一个系统 $\\mathcal{K}$ 耦合到一起。可以将 $\\mathcal{K}$ 想象成一个仪器上面的指针，可以给出不同的读数。假设系统 $\\mathcal{K}$ 的初态为 $\\sigma$ ，于是复合系统的初态为 $\\rho \\otimes \\sigma \\in \\mathcal{H} \\otimes \\mathcal{K}$ 。 然后，我们让复合系统演化一段时间，于是系统状态变为 $U(\\rho\\otimes \\sigma) U^\\dag$ 。 最后，我们对辅助系统 $\\mathcal{K}$ 进行 PVM $\\mathsf{Z}$ 所给出的测量，根据玻恩规则，得到结果 $x$ 的概率为 $\\operatorname{tr}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ 。 这样，我们就实现了一个 POVM $\\mathsf{E}$ ，满足 $\\operatorname{tr}[\\rho \\mathsf{E(x)}]=\\operatorname{tr}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ 。 定义 $\\mathcal{I}_x(\\rho) :=\\operatorname{tr}_\\mathcal{K}[\\rho \\mathsf{E(x)}]=\\operatorname{tr}_\\mathcal{K}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ ，它是测量过程所诱导的 quantum channel。如果我们找到 quantum channel 的 Kraus operator $K_i$ 使得 $\\mathcal{I}_x(\\rho) :=\\sum_i K_i \\rho K_i^*$ ，就可以很容易求出 $\\mathcal{I}_x$ 的对偶 channel $\\mathcal{I}_x^*: \\mathcal{I}_x^*(\\mathcal{M}) = \\sum_i K_i^* \\mathcal{M} K_i$ ，于是测量后的坍缩态就是 $\\mathcal{I}_x^*(\\mathbb{I_\\mathcal{H}}) = \\sum_i K_i^* K_i$ 。 以上是整体思路，下面我们给出具体计算过程。 ","date":"2024-05-27","objectID":"/position_measurement/:2:0","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"2.1 待测系统和仪器的哈密顿量 考虑待测量的系统 $\\mathcal{H}$ 和仪器 $\\mathcal{K}$ ，且 $\\mathcal{H} \\cong \\mathcal{K} \\cong L^2(\\mathbb{R})$ ，即 $\\mathcal{H}$ 和 $\\mathcal{K}$ 都是 $\\mathbb{R}$ 上平方可积函数构成的希尔伯特空间。可以将 $\\mathcal{K}$ 想象成一个仪器上面的指针，可以给出不同的读数。 为了测量 $|\\psi\\rangle\\in \\mathcal{H}$ 的位置，我们需要仪器与待测系统耦合起来，并演化一段时间。 这个演化过程的哈密顿量为 $U =e^{-\\mathrm{i} g Q\\otimes P}$ 。其中 $Q$ 是 $\\mathcal{H}$ 上的位置算符， $P$ 是 $\\mathcal{K}$ 上的动量算符， $g$ 是耦合强度（已经将演化时间 $t$ 吸收进去）。这个哈密顿量不难理解，因为仪器的指针需要在表盘上移动以给出不同的读数，而平移的生成元就是动量算符。因此直观来看， $U$ 可以理解为根据 $|\\psi\\rangle\\in \\mathcal{H}$ 的位置生成 $\\mathcal{K}$ 上的平移。 ","date":"2024-05-27","objectID":"/position_measurement/:2:1","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"2.2 演化 根据谱分解 $Q = \\int_{\\mathbb{R}} x\\mathsf{Q}(\\mathrm{d}x)$ ，我们可以把 $U$ 写成： $U = \\int_\\mathbb{R} \\mathsf{Q}(\\mathrm{d}x) \\otimes e^{-\\mathrm{i}g x P}$ 设 $\\mathcal{H}$ 和 $\\mathcal{K}$ 的初态分别为 $\\rho$ 和 $\\sigma = |\\psi\\rangle\\langle\\psi|$ ，那么演化后的量子态为： $\\tau = U(\\rho \\otimes \\sigma) U^*=\\int_{\\mathbb{R}^2} \\mathsf{Q}(\\mathrm{d}x) \\rho \\mathsf{Q}(\\mathrm{d}y) \\otimes e^{-\\mathrm{i} g x P} |\\psi\\rangle\\langle \\psi | e^{-\\mathrm{i} g y P}$ ","date":"2024-05-27","objectID":"/position_measurement/:2:2","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"2.3 测量诱导的 Quantum channel 和 POVM 此时对系统 $\\mathcal{K}$ 进行位置测量会给出如下的 quantum channel： $ \\mathcal{I}_{A}(\\rho) =\\text{tr}_\\mathcal{K}[\\tau(\\mathbb{I}_\\mathcal{H} \\otimes \\mathsf{Q}(A)) ] $ 计算得： $\\begin{aligned} \\mathcal{I}_{A}(\\rho) \u0026= \\text{tr}_\\mathcal{K}[\\tau(\\mathbb{I}_\\mathcal{H} \\otimes \\mathsf{Q}(A)) ] \\\\ \u0026=\\text{tr}_\\mathcal{K}[U(\\rho \\otimes \\sigma) U^*(\\mathbb{I}_\\mathcal{H} \\otimes \\mathsf{Q}(A)) ] \\\\ \u0026= \\int_{\\mathbb{R}^2} \\langle e^{-\\mathrm{i}g y P} \\psi | \\mathsf{Q}(A)|e^{-\\mathrm{i}g x P }\\psi \\rangle \\mathsf{Q}(\\mathrm{d}x) \\rho \\mathsf{Q}(\\mathrm{d}y) \\\\ \u0026= \\int_A \\int_{\\mathrm{R}^2} \\psi(q-gy)^*\\psi(q-gx) \\mathsf{Q}(\\mathrm{d}x) \\rho \\mathsf{Q}(\\mathrm{d}y) \\mathrm{d}q \\\\ \u0026= \\int_A K(q) \\rho K(q)^* \\mathrm{d}q \\end{aligned}$ 其中 $K(q) := \\int_{\\mathrm{R}} \\psi(q - gx)\\mathsf{Q}(\\mathrm{d}x)$ 是 $\\mathcal{I}_A$ 的 Kraus operator，即 $[K(q) \\varphi] (x) := \\psi(q - gx) \\varphi(x)$ 。 这个 quantum channel 诱导了一个 $\\mathcal{H}$ 上的 POVM： $\\mathsf{E}(A) = \\mathcal{I}_A^*(\\mathbb{I}_\\mathcal{H}) = \\int_A K(q)^* K(q) \\mathrm{d}q = \\int_A\\int_\\mathbb{R} |\\psi(q - gx)|^2 \\mathsf{Q}(\\mathrm{d}x) \\mathrm{d}q$ 可以看出，这个测量并不是将量子态坍缩到一个 delta 函数上，而是将 delta 函数与仪器 $\\mathcal{K}$ 的初态做了一个卷积，而仪器的初态 $|\\psi\\rangle \\in\\mathcal{K}$ 肯定不是一个 delta 函数。所以此时的 POVM 是一个**“被展宽”的测量**。这个展宽来源于仪器探针态本身的展宽。 ","date":"2024-05-27","objectID":"/position_measurement/:2:3","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"2.4 坍缩后的态 此时，在 $\\mathcal{I}_{A}(\\rho)$ 中令 $A={q}$ ，得到待测系统 $\\mathcal{H}$ 的量子态坍缩为 $\\frac{K(q) \\rho K(q)^*}{\\text{tr}[K(q) \\rho K(q)^*]}$ ，其中 $q$ 是仪器的读数。 当 $\\rho = |\\varphi\\rangle\\langle\\varphi|$ 是纯态时，其坍缩后的波函数为： $\\varphi^{(q)}(x) = \\mathcal{A}\\psi(q-gx) \\varphi(x)$ 其中 $\\begin{aligned} \\mathcal{A} = \\left[\\int_\\mathbb{R}\\psi(q-gx) \\varphi(x)\\right]^{-1} \\end{aligned}$ 是合适的归一化常数。其中 $q$ 是探针的读数。 如果探针态是一个“展宽”的高斯波包： $\\psi(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left[-\\frac{x^2}{2\\sigma^2}\\right]$ ，那么 $\\varphi^{(q)}(x) = \\mathcal{A} \\exp\\left[-\\frac{(gx-q)^2}{2\\sigma^2}\\right] \\varphi(x)$ 这个几何意义已经非常直观了。 特别地，如果探针态本身就是 delta 函数 $\\psi(x) = \\delta(x)$ ，那么测量后的态坍缩为 $\\varphi^{(q)}(x) = \\delta(x-\\frac{q}{g})$ 同样是一个 delta 函数。 ","date":"2024-05-27","objectID":"/position_measurement/:2:4","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"2.5 测量模型 以上的分析过程十分有用。我们可以把它抽象为一个测量模型（Measurement model）： $\\mathfrak{M}=(\\mathcal{K},\\sigma,U,\\mathsf{Z})$ 。 其中 $\\mathcal{K}$ 是辅助系统（可以理解为仪器）， $\\sigma$ 是系统 $\\mathcal{K}$ 的初态， $U$ 是整体系统 $\\mathcal{H} \\otimes \\mathcal{K}$ 的演化 ， $\\mathsf{Z}$ 是对辅助系统的投影测量（PVM）。这些物理对象实现了一个 $\\mathcal{H}$ 上的 POVM 测量。 在实际实验中，辅助（ancilla）系统 $\\mathcal{K}$ 可以看作是仪器的探针，而 $\\mathsf{Z}$ 就是对探针进行读数。 ","date":"2024-05-27","objectID":"/position_measurement/:2:5","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"三、量子-经典过渡 最后，你可能想问：测量之后，探针态坍缩成什么态了？这是一个很有趣的问题。 因为我们对于仪器探针位置的测量使用的是 PVM $\\mathsf{Q}$ ，所以探针态似乎应该坍缩成 delta 函数。如此一来，以上分析似乎仅仅是把一个问题变成另一个问题。即：把待测系统量子态如何坍缩的问题，变成了仪器探针态如何坍缩的问题。 但在实验上，我们的仪器是宏观的经典系统，而不是一个量子系统，因此实际的情况更加复杂。如果你了解一些 POVM 与量子测量模型的知识，你就会知道：（非 PVM 的）POVM 本身只能给出测量结果的概率。坍缩后的态具体是什么，只能由一个测量模型给出，而这个测量模型必然会涉及到一个辅助系统 $\\mathcal{K}$ 。如果你想要知道 $\\mathcal{K}$ 的量子态，你就要用另外一个系统 $\\mathcal{M}$ 去测量系统 $\\mathcal{K}$ ，如此往复下去。这种循环往复的过程就是从量子到经典过渡的过程。从量子到经典的过渡涉及到 measurement problem，是量子力学悬而未决的问题，我不想在这里过多地讨论它。有兴趣的读者可以自行搜索文献深究。 如此一来，测量模型似乎和退相干一样，都是看似解决了 measurement problem，实则没有解决。即便如此，它们还是能为我们提供很多 insight。 当然，以上说的只是连续谱的可观测量的问题。对于离散谱的可观测量而言，实验上很好实现 PVM。PVM 可以直接给出测量后的态，且这个态性质良好，不存在 delta 函数那样的不良性质。 ","date":"2024-05-27","objectID":"/position_measurement/:3:0","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"四、经典仪器 为了避免上面说到的问题，我们可以定义一个 course-grained 的经典仪器，它只能区分粒子在或不在某一个区间内： $\\mathsf{Z}: \\{0,1\\} \\rightarrow \\mathcal{E}(L^2(\\mathbb{R}))$ $\\mathsf{Z}(1) = \\int_a^b \\mathsf{Q}(\\mathrm{d}x)$ $\\mathsf{Z}(0) = \\mathbb{I}_{L^2(\\mathbb{R})} - \\int_a^b \\mathsf{Q}(\\mathrm{d}x)$ 又或者是以一定精度 $g$ 区分粒子的位置： $\\mathsf{Z}: \\mathbb{Z} \\rightarrow \\mathcal{E}(L^2(\\mathbb{R}))$ $\\mathsf{Z}(n) =\\int_{gn}^{g(n+1)} \\mathsf{Q}(\\mathrm{d}x)$ 注意到它们都是 PVM，因此坍缩后的态也可以确定下来。 这两种情况的计算留给读者作为练习。 ","date":"2024-05-27","objectID":"/position_measurement/:4:0","tags":["量子测量理论"],"title":"位置测量的塌缩态","uri":"/position_measurement/"},{"categories":["量子信息"],"content":"产生湮灭算符的定义动机很简单，完全可以从经典力学中得到。 想想我们是怎么解经典谐振子的。由于位置和动量是耦合起来的： $\\begin{cases} \\frac{\\mathrm{d}x}{\\mathrm{d}t} = \\omega p \\\\ \\frac{\\mathrm{d}p}{\\mathrm{d}t} = -\\omega x \\end{cases}$ 即 $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\begin{bmatrix} x \\\\ p \\end{bmatrix} = \\begin{bmatrix} 0 \u0026 \\omega \\\\ -\\omega \u0026 0 \\end{bmatrix} \\begin{bmatrix} x \\\\ p \\end{bmatrix}$ 那么我们只要将它们解耦就可以了。对角化得到特征向量 $a^{\\pm} = x\\pm\\mathrm{i}p$ ，于是 $a^{\\pm}$ 的导数就只和自己有关： $\\frac{\\mathrm{d}a^{\\pm}}{\\mathrm{d}t}=\\mp\\mathrm{i}\\omega a^{\\pm},\\quad a^{\\pm}=a_0^{\\pm} \\exp (\\mp\\mathrm{i}\\omega t)$ 这一套流程里的 $a^{+}$ 和 $a^{-}$ 量子化之后就是湮灭和产生算符。 记 $a^{+}\\rightarrow\\hat{a},\\quad a^{-}\\rightarrow \\hat{a}^\\dag$ ，则 $[\\hat{a},\\hat{a}^\\dag]=[\\hat{x}+\\mathrm{i}\\hat{p},\\hat{x}-\\mathrm{i}\\hat{p}]=-\\mathrm{i}[\\hat{x},\\hat{p}] = 1$ 。 后面的故事大家都很熟悉了。 多模情况也很简单。每当我们解耦出来一个特征向量，我们都会把它叫做一个模式，对应的就是该模式上的产生湮灭算符。这就是准粒子（例如声子）的由来。 在经典力学里，$a^{+}$ 和 $a^{-}$ 只是为了方便求解而扩展到复数域的技巧，而在量子力学里，它们有实实在在的物理含义。所以量子力学离不开复数。 ","date":"2024-05-27","objectID":"/annilation_op/:0:0","tags":["数学物理方法"],"title":"产生湮灭算符是怎么得到的？","uri":"/annilation_op/"},{"categories":["量子信息"],"content":"本文旨在从基本量子动力学出发，推导出激光的相干态。 考虑一个二能级系统和一个单模光场的相互作用，且光场频率等于能级差。 二能级系统一开始处于激发态 $|e\\rangle$ ，光场处于真空态 $|0\\rangle$ 。 根据 Jaynes-Cummings model，即使光场处于真空态，也会产生自发辐射。经过一小段时间，量子态从 $|e,0\\rangle$ 演化为： $|\\psi\\rangle = a |e,0\\rangle + b |g,1\\rangle$ 其中 $|g,1\\rangle$ 表示二能级处于基态，且与其耦合的光场模式中有一个光子，也就是自发辐射所发射的光子。 现在考虑 $N$ 个处于激发态的二能级系统，它们之间没有耦合，而是只和光场耦合。一开始的自发辐射光子诱导其他二能级系统的受激辐射，那么总体量子态可以写成： $|\\Psi\\rangle = C|\\psi\\rangle^{\\otimes N} = C\\sum_k \\sum_m\\mathcal{P}_m[|e,0\\rangle^{\\otimes (N-k)} \\otimes |g,1\\rangle^{\\otimes k}]$ 其中 $C$ 是待定的归一化常数， $\\mathcal{P}_m$ 表示 $|e,0\\rangle^{\\otimes (N-k)} \\otimes |g,1\\rangle^{\\otimes k}$ 所有可能的置换方式，共有 $\\frac{N!}{(N-k)!,k!}$ 种置换方式。注意这里我们尚未使用 Fock space（还没有对全同玻色子做对称化）。 这一步非常不严谨，甚至可能是错误的，因为它没有说明为什么受激辐射意味着总体量子态是自发辐射态 $|\\psi\\rangle = a |e,0\\rangle + b |g,1\\rangle$ 的张量积。但是后面会看到它给出了正确的结果。因此这种推导一定包含了某种 insight，只是我现在还没有看出来。 光场的量子态就是总体量子态 trace 掉二能级系统的量子态： $\\rho = \\operatorname{Tr}_{\\text{a}}[|\\Psi\\rangle\\langle\\Psi|] = C^2 \\sum_k |a^{N-k}b^k |^2 \\sum_m\\mathcal{P}_m[(|0\\rangle\\langle 0|)^{\\otimes (N-k)} \\otimes (|1\\rangle\\langle 1|)^{\\otimes k}]$ 现在我们将全同粒子的张量积对称化并映射到Fock space，也就是众所周知的 $|1\\rangle ^{\\otimes k} \\rightarrow \\sqrt{k!} |k\\rangle$ ，于是上式变成 $\\rho = C^2 \\sum_k |a^{N-k}b^k |^2 \\left(\\frac{N!}{(N-k)!,k!}\\right)^2 k! |k\\rangle\\langle k |$ 当 $k \\ll N$ 时， $\\frac{N!}{(N-k)!} \\sim \\left(\\frac{N}{e}\\right)^k$ 。令 $\\alpha = \\frac{b}{a}\\cdot\\frac{N}{e}$ ，则上式可以写成： $\\rho = C^2 a^N\\sum_k \\frac{|\\alpha|^{2k}}{k!} |k\\rangle\\langle k |$ 对其进行归一化得到： $\\rho = e^{-|\\alpha|^2}\\sum_k \\frac{|\\alpha|^{2k}}{k!} |k\\rangle\\langle k |$ 这是一个平均粒子数为 $|\\alpha|^2$ 的泊松分布。它在相干态表象下可以写成： $\\rho = \\int_0^{2\\pi} \\frac{\\mathrm{d}\\theta}{2\\pi} |\\alpha e^{\\mathrm{i}\\theta}\\rangle\\langle\\alpha e^{\\mathrm{i}\\theta}|$ 可见它其实是一个相位随机的相干态。相干态 $|\\alpha\\rangle$ 对应一个振幅和相位都非常确定的经典电磁波，但是这里将它的相位从 $0$ 到 $2\\pi$ 积分了。这表现了我们对相位信息的无知，这种无知从根本上来源于我们对二能级系统（增益介质）的微观状态的无知。因此可以说这个 $\\rho = \\rho_{\\text{epistemic}}$ 是认识论的量子态。 而从本体论量子态的角度而言，系统的量子态应当坍缩为一个有确定相位的 $\\rho_{\\text{ontic}} = |\\alpha\\rangle$ ，只是我们没办法知道是哪个相位而已。这是因为在光学频率 $\\sim 10^{15} \\text{Hz}$ 下，人类是无法观测绝对相位的。不过相对相位可以观测，因此我们仍能观察到干涉现象。如果读者对此好奇，可以进一步阅读这篇文章 [1]。 ","date":"2024-05-27","objectID":"/laser_quantum/:0:0","tags":["量子光学"],"title":"激光的一种简单的量子描述","uri":"/laser_quantum/"},{"categories":["量子信息"],"content":"参考 Bartlett, S. D., Rudolph, T. \u0026 Spekkens, R. W. Dialogue Concerning Two Views on Quantum Coherence: Factist and Fictionist. Int. J. Quantum Inform. 04, 17–43 (2006). ","date":"2024-05-27","objectID":"/laser_quantum/:1:0","tags":["量子光学"],"title":"激光的一种简单的量子描述","uri":"/laser_quantum/"},{"categories":["量子信息"],"content":"前言 1992 年发表在 PRA 上的一篇文章 [1] 指出，光子也有轨道角动量（OAM，Orbital Angular Momentum）。与自旋角动量（即偏振，SAM，Spin Angular Momentum）只能取 $\\pm \\hbar$ 相比，轨道角动量可以取 $\\hbar$ 的任意整数倍。这样的轨道角动量可以由螺旋形状的波前所携带。 你可能会惊奇：人们竟然到 1992 年才发现这件事情？实际上，早在 1992 年之前，螺旋形状的波前已经被人研究过；携带大于 $\\hbar$ 的角动量的光子也早就已经被原子物理所预言（只不过它们来源于高阶跃迁过程，而高阶跃迁过程不满足选择定则，因此概率非常低，实验上基本没法观测）。直到 1992 年，Allen 等人才指出波前为螺旋形状的光束携带量子化的轨道角动量。 1992 年到 2001 年之间对 OAM 的研究基本处于宏观电磁波（大量光子的相干态）的范畴。诺奖得主 Zeilinger 组在 2001 年的一篇文章 [2] 中第一次研究了单个光子的轨道角动量及其纠缠。从此以后，OAM 也获得了量子信息和量子光学研究者们的兴趣。OAM 在量子信息中的一个可能的应用就是量子精密测量，这是因为它的 $e^{\\mathrm{i}l\\varphi}$ 因子有助于将角度测量的精度提升 $l$ 倍。另外，SAM 和 OAM 之间可以通过 q-plate 相互作用，有助于量子信息处理。OAM 还有许多其他经典应用 [3]，这里就不赘述了。 ","date":"2024-05-27","objectID":"/oam/:1:0","tags":["量子光学"],"title":"光子的轨道角动量","uri":"/oam/"},{"categories":["量子信息"],"content":"一、Hermite-Gaussian (HG) 光束 在介绍携带轨道角动量的拉盖尔-高斯光束（Laguerre-Gaussian 光束）之前，我们最好先介绍埃尔米特-高斯光束（Hermite-Gaussian 光束）。 为什么要介绍高斯光束？因为实验上能得到的电磁波并不是理想平面波，而是激光器所输出的高斯光束。 高斯光束的束腰宽度 w0、瑞利长度 zR 和发散角 theta，图源 Wikipedia 普通的埃尔米特-高斯光束的电场强度大小如下： $\\begin{aligned} E_{m,n}(x,y,z) = \u0026 ,E_0 \\color{blue}{ \\frac{w_0}{w(z)}\\exp\\left[-\\frac{x^2+y^2}{w(z)^2}\\right] } \\times \\\\ \u0026 \\color{green}{\\exp\\left[-\\mathrm{i}\\frac{k(x^2+y^2)}{2 R(z)}\\right]} \\color{orange}{\\exp\\left[\\mathrm{i}\\psi(z)\\right]} \\color{gray}{\\exp[-\\mathrm{i}kz]} \\times \\\\ \u0026 \\color{red}{H_m\\left[\\sqrt{2}\\frac{x}{w(z)}\\right]H_n\\left[\\sqrt{2}\\frac{y}{w(z)}\\right]} \\end{aligned} $ 其中： $\\color{blue}{w(z) = w_0 \\sqrt{1+\\left(\\frac{z}{z_R}\\right)^2}}$ 代表 $z$ 处的波束宽度， $z_R = \\pi\\frac{w_0^2}{\\lambda}$ 是瑞利长度（Rayleigh length），定义为波束宽度发散到束腰宽度的 $\\sqrt{2}$ 倍时的 $z$ 值。 $\\color{green}{R(z) = \\frac{z^2 + z_R^2}{z}}$ 代表 $z$ 处波前的曲率半径。 $\\color{orange}{\\psi(z)=\\arctan\\left(\\frac{z}{z_R}\\right)}$ 代表古伊相移（Gouy phase shift）。从负无穷远到正无穷远一共有 $\\pi$ 的额外相移。 $\\color{red}{H_m(t)}$ 是 $m$ 阶埃尔米特多项式。它们也是量子谐振子的能量本征解。当 $m,n$ 都等于零时，退化为基模高斯光束。大部分激光器输出的都是基模高斯光束。 可见，记忆高斯光束并不难，只要记住三个特征： $\\color{blue}{\\text{束腰发散}}$ 、 $\\color{green}{\\text{曲率半径}}$ 、 $\\color{orange}{\\text{古伊相移}}$ ，即可。 还有一个比较有用的量是发散角。从 $\\color{blue}{w(z) = w_0 \\sqrt{1+\\left(\\frac{z}{z_R}\\right)^2}}$ 中可以看出发散角的正切值为 $\\tan \\theta=\\frac{w_0}{z_R}$ ，于是有 $w_0 \\tan \\theta = \\frac{\\lambda}{\\pi}$ 。 高斯光束的形状完全由波长、束腰半径、发散角三个中的任意两个决定。这三者之间的关系已经由 $w_0 \\tan \\theta = \\frac{\\lambda}{\\pi}$ 给出。 $E_{m,n}(x,y,z)$ 只表示电场强度的大小，并未包含偏振信息。 加上偏振信息是很容易的：如果是 $x$ 方向偏振，只需要将 $E_{m,n}(x,y,z)$ 乘以 $x$ 方向的单位向量 $\\hat{x}$ 即可。如果是圆偏振，只要乘以 $\\hat{x} \\pm \\mathrm{i}\\hat{y}$ 即可。 注意到 $E_{m,n}(x,y,z)$ 是一个复数。对于经典电磁波而言，真正的电场强度是它的实部。对于量子电磁波而言，我们可以指定该模式上的一个湮灭算符，这个湮灭算符是平面波湮灭算符的线性组合，系数可以由傅里叶分析得到。 HG 模式，图源 Wikipedia ","date":"2024-05-27","objectID":"/oam/:2:0","tags":["量子光学"],"title":"光子的轨道角动量","uri":"/oam/"},{"categories":["量子信息"],"content":"二、Laguerre-Gaussian (LG) 光束 在二维量子谐振子的解中，除了 Hermite 多项式所代表的线性振动以外，还有 Laguerre 多项式所代表的旋转运动。 下面我们给出拉盖尔-高斯光束的形式： $\\begin{aligned} E_{l,p}(r,\\varphi,z) = \u0026 ,E_0 \\color{blue}{ \\frac{w_0}{w(z)}\\exp\\left[-\\frac{r^2}{w(z)^2}\\right] } \\times \\\\ \u0026 \\color{green}{\\exp\\left[-\\mathrm{i}\\frac{kr^2}{2 R(z)}\\right]} \\color{orange}{\\exp\\left[\\mathrm{i}\\psi(z)\\right]} \\color{gray}{\\exp[-\\mathrm{i}kz]} \\times \\\\ \u0026 \\color{red}{\\left(\\sqrt{2}\\frac{r}{w(z)}\\right)^{|l|} L_p^{|l|} \\left(2 \\frac{r^2}{w(z)^2}\\right) \\exp(-\\mathrm{i}l\\varphi)} \\end{aligned} $ 其中 $\\color{blue}{\\text{束腰发散}}$ 和 $\\color{green}{\\text{曲率半径}}$ 与埃尔米特-高斯光束相同，不同的有两点： 第一，高阶项由埃尔米特多项式变为拉盖尔多项式 $\\color{red}{L_p^{|l|} (t)}$ 。且额外的因子 $\\color{red}{\\left(\\sqrt{2}\\frac{r}{w(z)}\\right)^{|l|}}$ 和 $\\color{red}{\\exp(-\\mathrm{i}l\\varphi)}$ 分别表示原点处的奇点以及螺旋形的波前（带轨道角动量 $\\hbar l$ ）。 第二，古伊相移 $\\color{orange}{\\psi(z) = (2p + |l|+ 1)\\arctan \\frac{z}{z_R}}$ 变为 HG 模式的 $2p + |l|+ 1$ 倍。 LG 模式，图源 Wikipedia 正如旋转可以分解为振动的线性叠加，LG 模式也可以表示为 HG 模式的相干叠加。这和圆偏振可以分解为两个线偏振的叠加类似。 ","date":"2024-05-27","objectID":"/oam/:3:0","tags":["量子光学"],"title":"光子的轨道角动量","uri":"/oam/"},{"categories":["量子信息"],"content":"三、用 Q-Plate 操控自旋角动量和轨道角动量 2006 年提出的 q-plate [4]本质上就是一个光轴与位置有关的半波片，且光轴的角度 $\\alpha$ 满足 $\\alpha(r,\\varphi) = q \\varphi + \\alpha_0$ 。其琼斯矩阵为 $\\begin{bmatrix} \\cos 2\\alpha \u0026 \\sin 2\\alpha \\\\ \\sin 2\\alpha \u0026 -\\cos 2\\alpha \\end{bmatrix}$ 。 q-plate 的光轴图案，图源 [4] 考察一个 q-plate 作用到一个左旋偏振的基模高斯光束上，结果为： $\\begin{bmatrix} \\cos 2\\alpha \u0026 \\sin 2\\alpha \\\\ \\sin 2\\alpha \u0026 -\\cos 2\\alpha \\end{bmatrix} \\begin{bmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{\\mathrm{i}}{\\sqrt{2}} \\end{bmatrix} = e^{\\mathrm{i}2q\\varphi} \\begin{bmatrix} \\frac{1}{\\sqrt{2}} \\\\ -\\frac{\\mathrm{i}}{\\sqrt{2}} \\end{bmatrix}$ 可见，经过 q-plate，左旋偏振光变为带 $2q\\hbar$ 轨道角动量的右旋偏振光。 q-plate 是目前实验上制备 OAM 态最常用的方法。当然，用 SLM 也可以。 OAM 之所以吸引量子信息研究者的兴趣，其中一个原因是它的希尔伯特空间维数和谐振子一样是无穷大的，而不像偏振（SAM）那样只有两个。SAM 与 OAM 之间的相互作用引出了一个很直接的想法：利用 SAM 和 OAM 做一个 CNOT 门，其中 SAM 是控制比特，OAM 是目标比特。类似的实验很多，这里就不放文献了。 ","date":"2024-05-27","objectID":"/oam/:4:0","tags":["量子光学"],"title":"光子的轨道角动量","uri":"/oam/"},{"categories":["量子信息"],"content":"参考 Allen, L.; Beijersbergen, M. W.; Spreeuw, R. J. C.; Woerdman, J. P. Orbital Angular Momentum of Light and the Transformation of Laguerre-Gaussian Laser Modes. Phys. Rev. A 1992, 45 (11), 8185–8189. https://doi.org/10.1103/PhysRevA.45.8185. A. Mair, A. Vaziri, G. Weihs, and A. Zeilinger, “Entanglement of the orbital angular momentum states of photons,” Nature 412(6844), 313–316 (2001). Padgett, M. J. Orbital Angular Momentum 25 Years on [Invited]. Opt. Express 2017, 25 (10), 11265. https://doi.org/10.1364/OE.25.011265. Marrucci, L.; Manzo, C.; Paparo, D. Optical Spin-to-Orbital Angular Momentum Conversion in Inhomogeneous Anisotropic Media. Phys. Rev. Lett. 2006, 96 (16), 163905. https://doi.org/10.1103/PhysRevLett.96.163905. ","date":"2024-05-27","objectID":"/oam/:5:0","tags":["量子光学"],"title":"光子的轨道角动量","uri":"/oam/"},{"categories":["量子信息"],"content":"很多物理工作者向大众科普量子纠缠的时候都会举一个例子： 想象你有两个盒子，其中一个放了披萨，另一个放了汉堡，在打开盒子之前无法知道其中是什么。Alice 和 Bob 一人拿走一个盒子，并且走到相距很远的地方。此时 Alice 打开盒子就能知道遥远彼端的 Bob 的盒子里有什么。 这个例子肯定有什么不对…因为它压根就没有涉及到量子力学。 的确如此，这个例子表现的是经典关联，而非量子纠缠。令披萨为 $|0\\rangle$ ，汉堡为 $|1\\rangle$ ，那么在上面这个例子中，系统的状态为 $\\rho_{\\text{classical correlation}} = \\frac{1}{2} \\left( |01\\rangle\\langle 01| + |10\\rangle\\langle 10| \\right)$ 写成矩阵形式就是： $\\rho_{\\text{classical correlation}} = \\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 \\frac{1}{2} \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 \\frac{1}{2} \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}$ 而真正的量子纠缠应该如下： $\\rho_{\\text{quantum entanglement}} = |\\psi\\rangle\\langle\\psi | = \\frac{1}{2} \\left( |01\\rangle\\langle 01| + |10\\rangle\\langle 10| + |01\\rangle\\langle 10| + |10\\rangle\\langle 01 | \\right)$ 其中 $|\\psi\\rangle = \\frac{1}{\\sqrt{2}} (|01\\rangle + |10 \\rangle)$ 写成矩阵形式就是： $\\rho_{\\text{quantum entanglement}} = \\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 \\frac{1}{2} \u0026 \\frac{1}{2} \u0026 0 \\\\ 0 \u0026 \\frac{1}{2} \u0026 \\frac{1}{2} \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}$ 可见，真正的量子纠缠是有非对角项的。这些非对角项也叫相干项（coherences）。 同样可见，当上面的量子纠缠态退相干之后，才会得到经典关联。换句话说，经典关联是量子纠缠退相干之后的结果。 退相干也是**量子测量问题（measurement problem）**的一个诠释：当系统与环境纠缠后，如果考察系统部分的偏迹，会发现系统的状态是退相干的。这样一来，量子纠缠就变成了经典关联，此时密度矩阵只剩下了对角项。 但退相干不能解释波函数的坍缩问题。因为下面这个过程仍然是由系统和环境的整体波函数坍缩而导致的。 $\\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 \\frac{1}{2} \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 \\frac{1}{2} \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix} \\xrightarrow{\\text{collapse}} \\begin{cases} \\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}, \u0026 \\text{with }\\frac{1}{2} \\text{ probability} \\\\ \\begin{bmatrix} 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 1 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}, \u0026 \\text{with }\\frac{1}{2} \\text{ probability} \\end{cases}$ 这一步无法用退相干来解释。因此测量问题至今尚未解决。这也很好理解：退相干本身仍然是一个酉的演化过程，而波函数坍缩是非酉的。 所以，我们只能暂时接受：波函数坍缩在现代量子力学中是一个公设，而非可以导出的定理。这将会导致一个完备性问题：我们无法通过量子力学本身来决定一个过程应该是酉的演化过程还是非酉的坍缩过程。 这个问题也叫做 Heisenberg cut，即如何找到这样一个“cut”，使得在其之下系统都会正常演化，而在其之上会系统会坍缩。当然，由于我们现有的测量仪器都是粒子数很大的系统，所以我们无需担心这个问题——我们十分确定，我们的测量会诱导系统的坍缩。 在 categorical quantum theory 中，描述量子纠缠需要 $\\mathbf{Hilb}$ 张量范畴，而描述经典关联只需要 $\\mathbf{Rel}$ 张量范畴。前者的张量积是希尔伯特空间的张量积，而后者的张量积是集合的笛卡尔积。 笛卡尔积（以及直积、直和）是无法描述量子纠缠的。希尔伯特空间的张量积才是纠缠现象得以存在的根源。前者是经典的标志，可以描述经典关联，后者是量子的标志，可以描述量子纠缠。 然而，真正的经典物理是决定论的，它由 $\\mathbf{Set}$ 范畴描述。而 $\\mathbf{Rel}$ 范畴是概率论的，它介于 $\\mathbf{Hilb}$ 和 $\\mathbf{Set}$ 之间。也许，如何从 $\\mathbf{Rel}$ 范畴过渡到 $\\mathbf{Set}$ 范畴，才是解决测量问题的最后一步，而这一步本身就不在 $\\mathbf{Hilb}$ 范畴之内。 测量问题和统计力学中的一些问题比较相似，例如熵与时间之矢。这些问题的根源都是谷堆悖论式的：它们只在系统足够大时才涌现出来，以至于我们难以找到一个小与大的界限，也即 Heisenberg cut。 ","date":"2024-05-27","objectID":"/classical_correlation/:0:0","tags":["量子测量理论"],"title":"量子纠缠与经典关联的区别，以及量子测量问题","uri":"/classical_correlation/"},{"categories":["量子信息"],"content":"量子计量学（Quantum Metrology）简明入门 ","date":"2024-04-23","objectID":"/quantum_metrology/:0:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"一、量子计量学介绍 所谓量子计量学（Quantum Metrology），就是利用量子物态的量子性质进行精密测量的学问。 之所以要研究量子计量学，是因为任何物理量的测量精度都由量子力学中的海森堡不确定性原理所限制，这叫做海森堡极限（Heisenberg Limit）。如何逼近以及提升这个极限，就是量子计量学的目标。 当然，日常生活中的大部分测量都不需要达到海森堡极限（例如，称体重）。但是在高精度成像以及各种高精度科学实验中，人们的确早就已经接近了海森堡极限。 引力波：LIGO（Light Interferometer Gravitational-wave Observatory）是人们用来探测引力波的光干涉仪。它能探测到的干涉臂的长度变化达到了 $10^{-19}$ m 的级别，只有一个质子的大小的万分之一，更是光的波长的亿万分之一。在这个疯狂的精度级别下，LIGO 利用了光场的压缩态来降低量子噪声。 当然，量子噪声并非只在 LIGO 这样的极端情况下出现。下面我们给出两个关于成像的例子。 散粒噪声：你一定用过 CMOS 相机。你是否注意过，在环境较暗的情况下，拍出来的照片会有很多噪点？其实它们是由 散粒噪声（Shot noise） 导致的。 什么是散粒噪声？光子激发出来的电子是一个一个的，且这些电子的产生符合泊松分布（产生的时间完全随机），其相对方差反比于平均电子数，这个方差就是散粒噪声。 可见，当电子数量较少的时候，其相对方差会比较大，信噪比（SNR）较低，导致了噪点的出现。 散粒噪声是由粒子数-相位不确定性原理给出的，然而，由于一些历史原因，人们不把它叫做海森堡极限，而是把它叫做散粒噪声极限，或者标准量子极限，并把它与海森堡极限区分开来。 衍射极限：成像精度除了时间上的衡量（即信噪比）以外，还有空间上的衡量，即像素点的个数。如果我们无限增加像素点的个数，有可能达到无限的精度吗？ 学过光学的你知道这不可能，因为有衍射极限的存在。 实际上，衍射极限就是一种海森堡极限，因为它对应一种动量-位置不确定性。如果我们需要更准确的位置，衍射极限告诉我们，在不改变波长的前提下，需要增加入瞳（aperture）的大小。从海森堡原理的角度来看，这是因为以不同角度进入入瞳的光子拥有不同的动量，这些动量信息在成像的那一刻丢失了，而丢失的动量信息越多，光子的位置就测量地越准确。反过来，在不改变入瞳大小的前提下，我们需要减小波长，这是因为波长越小，动量越大，相同入瞳所接收到的光子的动量范围也越大。 这些例子都很有趣。希望你 enjoy。当然，更有趣的还在后头呢：人们用什么样的数学工具刻画量子噪声？人们怎样设计量子态以达到海森堡极限？看完这篇文章，你会深入了解这些问题，并且完成对量子计量学的入门。 ","date":"2024-04-23","objectID":"/quantum_metrology/:1:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"二、极大似然估计 什么是测量？首先，我们需要给测量下一个定义。注意到，对同一个物理量进行测量总是会以一定概率给出一系列各不相同的结果（无论是经典物理还是量子物理）。我们通常把这些结果的平均值作为最终结果。 可见，测量过程实际上给出了一系列随机变量（即各个单次测量结果），而我们通过构造像平均值这样的统计量（即随机变量的函数）来估计物理量本身。我们把这个统计量叫做估计量（estimator）。 这个估计量本身也是一个随机变量，也有均值和方差。我们将该估计量的取值称为测量结果，其方差称为测量误差。相对误差就是误差除以均值；测量精度就是相对误差的倒数。 到此为止，我们就定义好了测量过程，它本质上是一个参数估计问题： 参数估计：给定一个概率密度函数 $p(\\mathbf{x};\\theta)$，其中 $\\mathbf{x}$ 是测量结果，$\\theta$ 是要测量的物理量（它是概率密度函数的一个参数，而非自变量），构造估计量 $\\hat{\\theta} = \\hat{\\theta}(\\mathbf{x})$ 使得它的均值等于或尽量接近待估计的参数（无偏性），且方差尽可能地小（有效性）。另外，还有一个比较隐蔽的条件：我们要求样本数量越大，估计量就越接近参数的真实值（一致性）。 无偏性：无偏性就是指 $\\mathbb{E}(\\hat{\\theta}(X)) = \\theta$，即估计量的均值等于参数的真实值。 有效性：怎样刻画有效性？后面我们会介绍，估计量的方差有 CR 下界：$(\\Delta \\hat{\\theta})^2 \\ge \\frac{1}{F(\\theta)}$，其中 $F(\\theta)$ 叫做 Fisher 信息。有效性可以用 $F(\\theta)/(\\Delta \\hat{\\theta})^2 \\le 1$ 来刻画。当 $F(\\theta)/(\\Delta \\hat{\\theta})^2 = 1$，即达到下界时，我们就称该统计量是有效的。 一致性：一致性要求 $\\lim_{n\\rightarrow \\infty} P(|\\hat{\\theta} - \\theta|\u003e\\epsilon) = 0$ 对于任意正数 $\\epsilon \u003e 0$ 成立。其中 $n$ 是样本个数。这也叫做依概率收敛 $\\operatorname{plim}_{n\\rightarrow \\infty} \\hat{\\theta} = \\theta $ 。 统计学上对付参数估计问题最常用的方法就是极大似然估计（Maximum Likelihood Estimation，MLE）。它的思想很简单，就是在众多参数中找到这样一个参数，使得在该参数的前提下，测量到已有结果的概率是最大的。 具体步骤也很简单： 极大似然估计：设似然函数（likelihood function） $f(\\theta; \\mathbf{x}) = p(\\mathbf{x}; \\theta)$，并找它的最大点 $\\hat{\\theta}(\\mathbf{x}) = \\operatorname{arg,max} f(\\theta; \\mathbf{x})$。 $\\hat{\\theta}(\\mathbf{X})$ 就是极大似然估计所给出的估计量。 在实际操作中，人们通常先对似然函数取对数来简化计算，即 $\\log f(\\theta; \\mathbf{x})$，称为对数似然函数（log-likehihood function）。 实际上，极大似然估计通常不满足无偏性，但是人们依然非常青睐它。这是因为极大似然估计总是渐近有效（样本趋于无穷时，方差能够达到 CR 下界），且渐近无偏的（样本数量趋于无穷时，估计量的均值趋于参数真实值）。 在量子测量中，人们在绝大部分情况下也使用极大似然估计。因此这篇文章将会集中在极大似然估计上。 其他的参数估计方法还有贝叶斯估计、矩估计。它们和极大似然估计构成最重要的三种参数估计方法。 ","date":"2024-04-23","objectID":"/quantum_metrology/:2:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"三、Fisher 信息和 CR 下界 似然函数是极大似然估计的核心。我们来看看从似然函数出发能得到哪些量。 首先得到的量叫做 Score Function（不知道中文翻译），它是对数似然函数关于参数真实值的导数： Score Function: Score Function $s(\\theta; \\mathbf{x})$ 定义为： $s(\\theta; \\mathbf{x}) = \\frac{\\partial}{\\partial \\theta} \\log f(\\theta; \\mathbf{x})$， 其中 $f(\\theta; \\mathbf{x})$ 为似然函数。 它的意义也很明确：就是参数值的变化对似然函数的影响。如果导数为正，说明参数值需要变大，这是因为参数真实值变大会导致似然函数变大（即概率更大）；反之，如果导数为负，说明参数值需要变小。那么什么时候参数值是理想的呢？那当然就是导数为零的时候啦。这也很好理解：似然函数最大点的导数为零。 当然，导数为零只是必要条件，而不是充分条件。为了保证似然函数的导数零点对应最大值，还需要二阶导数为负。于是我们再定义 Fisher 信息： Fisher 信息（Fisher Information）：Fisher 信息是对数似然函数（关于参数 $\\theta$ 的）负二阶导数的（关于随机变量 $X$ 的）期望值： $F(\\theta) = \\mathbb{E}\\left(-\\frac{\\partial^2}{\\partial \\theta^2} f(\\theta, X)\\right)$ 其实可以证明，Fisher 信息总是非负的。因此令似然函数的导数为零总是能得到极大值。实际上，Fisher 信息也可以用一阶导的平方表示，因此肯定是非负的： $F(\\theta) = \\mathbb{E}\\left[\\left(\\frac{\\partial}{\\partial \\theta} f(\\theta, X)\\right)^2\\right]$，证略。 Fisher 信息的意义：Fisher 信息的意义是：似然函数在最大值附近对于参数的敏感程度。 直觉上来说，似然函数越敏感，我们的估计就越有效。因为在似然函数对参数敏感的情况下，参数的少量变动就会导致似然函数的急剧下降，因此我们能以较高的确信度将参数确定下来。反之，如果似然函数对参数不敏感，那我们就不能将参数确定在较小的范围内，这是因为参数在较大的范围内变动不会导致似然函数的显著下降。 理解了 Fisher 信息的意义之后，我们就能很快理解 Cramer-Rao 下界了： Cramér-Rao Bound：无偏估计量的方差有如下的下界： $(\\Delta \\theta)^2 \\ge \\frac{1}{F(\\theta)}$ 其中 $F(\\theta)$ 是 Fisher 信息。这叫做 Cramér-Rao 下界。 这其实就是将 Fisher 信息的意义量化为了一个不等式。Fisher 信息越大，似然函数对参数越敏感，参数的估计量的方差就可以越小。反之，Fisher 信息越小，似然函数对参数越不敏感，参数的估计量的方差就越大。 到此为止，我们介绍的极大似然估计、Fisher 信息以及 CR 下界，跟量子力学都没有任何关系，但它们都是必要的基础。在下一节中，我们将会引入量子 Fisher 信息和量子 CR 下界，并将它们应用到量子测量中。 ","date":"2024-04-23","objectID":"/quantum_metrology/:3:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"四、量子 Fisher 信息和量子 CR 下界 在本节中，我们会将上节涉及到的所有统计学概念应用到量子力学中。这是可以做到的，因为量子测量也可以用概率论描述。 我们首先要有一个概率密度函数。在量子力学中，给定了一个态和一个 POVM 之后，我们就能得到一个概率密度函数： 概率密度函数：$p_{\\rho}^{E}(x)=\\operatorname{tr}[\\rho E(x)]$，其中 $\\rho$ 是所测量的量子态，$E(x)$ 是 POVM，满足 $\\sum_{x\\in X} E(x) = \\mathbb{I}$，其中 $X$ 是所有可能的测量结果的集合，$\\mathbb{I}$ 是恒等算符。 在量子力学中，我们要测量的物理量是编码在量子态中的，即 $\\rho(\\theta)$，所以似然函数为： 似然函数：$f^{E}(\\theta; x) = p_{\\rho(\\theta)}^{E}(x) = \\operatorname{tr}[\\rho(\\theta) E(x)]$ 注意到这个似然函数是取决于 POVM $E$ 的。对于每一个 POVM，我们都有一个似然函数。 对似然函数求负二阶导并取期望值，我们得到 Fisher 信息如下： Fisher 信息：$F^{E}(\\theta) = \\mathbb{E}\\left[(\\frac{\\partial}{\\partial \\theta} f^{E}(\\theta; X))^2\\right]$ 注意到 Fisher 信息 不仅依赖于参数 $\\theta$，还依赖于所选取的 POVM，即所选取的测量手段。 现在我们可以定义量子 Fisher 信息了，它是在众多不同 POVM 所对应的 Fisher 信息中最大的那一个。 量子 Fisher 信息：$F(\\theta) = \\sup_{E\\in \\mathsf{E}} F^{E}(\\theta)$，其中 $\\mathsf{E}$ 是所有 POVM 的集合。换言之，量子 Fisher 信息是经典 Fisher 信息的上确界。 到目前为止，我们只是给出了一连串定义，并没有得到什么新的结果。下面我们来进一步对问题做出限定，从而希望得到一些有用的结果。 我们限定 $\\rho(\\theta)$ 的形式。参数 $\\theta$ 通常是编码在一个酉过程中的：$U = e^{-iH\\theta}$。将该酉过程作用在一个态 $\\rho_0$ 上，我们就能得到 $\\rho(\\theta) = e^{-iH\\theta}\\rho_0 e^{iH\\theta} $。其中 $\\rho_0$ 也可以叫做 probe state（探针态）。 为什么是酉编码 这里我们给出一个例子。如果我们想要知道一个双折射晶体在 H 和 V 两个偏振光之间引入的相位差，我们要考虑的变换就是 $e^{i\\frac{Z}{2}\\theta} = \\begin{bmatrix} e^{i\\theta/2} \u0026 0 \\\\ 0 \u0026 e^{-i\\theta/2} \\end{bmatrix}$，其中 $Z$ 是泡利 Z 矩阵。 如果希尔伯特空间不只是一个二能级系统（一个 qubit），而是可以是更大（qudit 或者多个 qubit），作用在态向量上的则是一个更大的酉变换，它总是可以对角化为 $\\sum_{k} e^{i\\theta_k} |k\\rangle\\langle k|$。 换言之，其特征值总是模为一的复数。因此，重要是这些复数的相位信息。如何通过设计测量线路来探测这些相位，就是量子相位估计（Quantum Phase Estimation）问题。量子相位估计是量子计算中一个基本且重要的算法 primitive。 接下来我们来看看 $\\rho(\\theta)$ 的导数。量子力学扎实的小伙伴应该很熟悉了，结果中会有一个对易子： $\\frac{\\partial}{\\partial \\theta} \\rho(\\theta) = i[\\rho, H]$ 但实际上还有一种导数表示，叫做对称对数导数（Symmetric Logarithmic Derivative，SLD）： Symmetric Logarithmic Derivative（SLD）：$\\frac{\\partial}{\\partial \\theta} \\rho(\\theta) = \\frac{1}{2}\\{\\rho, L_{\\rho}(H)\\} = \\frac{1}{2}[\\rho L_{\\rho}(H) + L_{\\rho}(H) \\rho]$ 其中 $L_{\\rho}(H)$ 定义为满足 $\\frac{1}{2}\\{\\rho, L_{\\rho}(H)\\} = i[\\rho, H]$ 的算符。它的显式形式为 SLD 的显式形式：$L_{\\rho}(H) = 2i\\sum_{k,l} \\frac{\\lambda_k - \\lambda_l}{\\lambda_k + \\lambda_l} \\langle k | H | l \\rangle | k \\rangle\\langle l |$，其中 $\\lambda_k$ 和 $|k\\rangle$ 分别是 $\\rho$ 的特征值和特征向量。读者自证不难，直接利用定义式即可。 为什么要定义 SLD？这是因为 SLD 在计算量子 Fisher 信息的过程中很有用。下面我们就来推导一下量子 Fisher 信息与量子 CR 下界。 前面我们说到，对于 POVM $E$，Fisher 信息为：$F^{E}(\\theta) = \\mathbb{E}\\left[(\\frac{\\partial}{\\partial \\theta} f^{E}(\\theta; X))^2\\right]$，现在我们把所有公式都代入： $\\begin{aligned} F^{E}(\\theta) \u0026= \\mathbb{E}\\left[\\left(\\frac{\\partial}{\\partial \\theta} f^{E}(\\theta; X)\\right)^2\\right] \\\\ \u0026= \\mathbb{E}\\left[\\frac{1}{p^{E}(X; \\theta)^2}\\left(\\frac{\\partial}{\\partial \\theta} p^{E}(X; \\theta)\\right)^2\\right] \\\\ \u0026= \\sum_{x\\in X}\\frac{p^{E}(x; \\theta)}{p^{E}(x; \\theta)^2}\\left(\\frac{\\partial}{\\partial \\theta} p^{E}(x; \\theta)\\right)^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left(\\frac{\\partial}{\\partial \\theta} \\operatorname{tr}[\\rho E(x)] \\right)^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left( \\operatorname{tr}\\left[\\frac{\\partial \\rho}{\\partial \\theta} E(x)\\right] \\right)^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left( \\operatorname{tr}\\left[\\frac{L \\rho + \\rho L}{2} E(x)\\right] \\right)^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left( \\operatorname{tr}\\frac{ L \\rho E(x) + E(x) \\rho L}{2} \\right)^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left[ \\operatorname{Re}\\left(\\operatorname{tr}[L \\rho E(x)] \\right)\\right]^2 \\\\ \u0026\\le \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left| \\operatorname{tr}[L \\rho E(x)] \\right|^2 \\\\ \u0026= \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]}\\left| \\operatorname{tr}[L \\rho^{\\frac{1}{2}}\\rho^{\\frac{1}{2}} E(x)^{\\frac{1}{2}} E(x)^{\\frac{1}{2}}] \\right|^2 \\\\ \u0026\\le \\sum_{x\\in X}\\frac{1}{\\operatorname{tr}[\\rho E(x)]} \\operatorname{tr}[\\rho E(x) L^2] \\operatorname{tr}[\\rho E(x)] \\\\ \u0026= \\operatorname{tr}\\left[\\rho \\left(\\sum_{x\\in X}E(x) \\right) L^2\\right] \\\\ \u0026= \\operatorname{tr}[\\rho L^2] \\end{aligned}$ 可见 Fisher 信息有上","date":"2024-04-23","objectID":"/quantum_metrology/:4:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"五、量子相位估计 前面我们提到了量子相位估计，即： 量子相位估计：给定一个酉变换，求它的特征值的相位。 如果考虑的希尔伯特空间为 n 维，则需要估计的相位有 (n-1) 个（可以提掉全局相位）。 我们还没有涉及多个参数的量子估计（我们会在附录中介绍）。我们现在考虑只有一个参数的情形。这样的情形有两种，二能级系统和谐振子系统。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.1 二能级系统 我们现在考虑一个二能级系统，哈密顿量为 $H = \\frac{\\hat{Z}}{2}$，且系统初态为纯态，即 $|\\psi(\\theta)\\rangle = e^{-i \\frac{\\hat{Z}}{2} \\theta} |\\psi_0\\rangle $。 此时量子 Fisher 信息为： $ \\begin{aligned} F(\\theta) \u0026= 4 \\left(\\Delta \\frac{\\hat{Z}}{2}\\right)^2 = (\\Delta \\hat{Z})^2 \\\\ \u0026= \\left\\langle \\psi_0 \\left| \\hat{Z}^2 \\right| \\psi_0 \\right\\rangle - \\left\\langle \\psi_0 \\left| Z \\right| \\psi_0 \\right\\rangle^2 \\\\ \u0026= 1 - \\left\\langle \\psi_0 \\left| \\hat{Z} \\right| \\psi_0 \\right\\rangle^2 \\end{aligned}$ 为了使量子 Fisher 信息最大化，我们要求 $\\left\\langle \\psi_0 \\left| \\hat{Z} \\right| \\psi_0 \\right\\rangle = 0$，换言之，$|\\psi_0\\rangle$ 应当在 Bloch 球的赤道上。这也符合我们的直觉：初态越靠近赤道，Bloch 球的旋转对初态的改变就越明显。如果初态在南极或者北极，那么 Fisher 信息将为零，即初态感受不到任何的旋转。 可观测量选择 $X$ 或者 $Y$ 都可以达到 CR 下界。我们不妨直接选择观测量为 $X + i Y$（这虽然不是一个可观测量，但是我们可以分别观测 X 和 Y，再将结果结合为一个复数），其期望值为 $e^{i\\theta}$，方差为 1。那么就有 $1 =|\\Delta e^{i\\theta}| = |ie^{i\\theta}\\Delta\\theta| = \\Delta \\theta$。也就是说 $\\Delta \\theta = \\frac{1}{F(\\theta)}$，即达到了 CR 下界。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:1","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.2 谐振子系统 我们现在考虑一个谐振子系统，哈密顿量为 $H = \\hat{N} = \\hat{a}^\\dag \\hat{a}$对应酉变换为 $e^{i\\hat{N}\\theta} = \\sum_{k=0}^{\\infty} e^{i N \\theta} |N\\rangle\\langle N|$。 此时量子 Fisher 信息为： $ \\begin{aligned} F(\\theta) \u0026= 4 \\left(\\Delta \\hat{N}\\right)^2 \\\\ \u0026= 4 [\\langle \\psi | \\hat{N}^2 | \\psi \\rangle - \\langle \\psi | \\hat{N} | \\psi \\rangle^2] \\end{aligned}$ 下面我们对不同的初态（probe state）进行分类讨论。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:2","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.2.1 粒子数态（number state） $| \\psi_0 \\rangle = | N \\rangle$ 此时量子 Fisher 信息为： $F(\\theta) = 0$。 这是很好理解的，因为粒子数态的相位是完全随机的（根据粒子数-相位不确定性原理）。可见粒子数态不能用来探测相位。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:3","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.2.2 相干态（coherent state） $|\\psi_0 \\rangle = | \\alpha \\rangle$ 此时量子 Fisher 信息为： $F(\\theta) = 4 |\\alpha|^2 = 4 \\bar{n}$。 它给出了测量误差的 CR 下界：$\\Delta \\theta \\ge \\frac{1}{2 \\sqrt{\\bar{n}}}$。这就是散粒噪声所允许的极限。它是由粒子数-相位不确定性关系给出的。然而，我们一般不把这个叫做海森堡极限，而是把它叫做散粒噪声极限，或者标准量子极限。文献中经常把这个与海森堡极限区分开来。这是因为我们还能继续提升 $\\Delta N$，从而降低 $\\Delta \\theta$。当 $\\Delta$ 正比于 $\\bar{n}$，即 $\\Delta \\theta \\sim \\frac{1}{\\bar{n}}$ 时，我们才把该情况叫海森堡极限。 $\\Delta N$ 还能正比于 $\\bar{n}$ 的更高次方吗？例如， $\\Delta N$ 可以正比于 $\\bar{n}^2$ 吗？量子统计告诉我们不可以。 $\\Delta N$ 最高只能正比于 $\\bar{n}$ 。 这是因为 $(\\Delta N)^2 = (g^{(2)}(0)-1)\\langle \\hat{N}\\rangle^2 + \\langle \\hat{N}\\rangle$ ，其中 $g^{(2)}$ 为二阶关联函数，它在 $t=0$ 处的取值是一个定值。可见，当 $g^{(2)}(0) \u003e 1 $ ，也就是使用聚束光（bunched light）时，我们能有$\\Delta N \\propto \\langle \\hat{N}\\rangle = \\bar{n}$ 。然而，相干态的 $g^{(2)}(0)$ 正好等于 1，所以只有 $\\Delta N \\propto \\sqrt{\\bar{n}}$ 。 有趣的是，热辐射的 $g^{(2)}(0)=2$ ，也就是说，热辐射光比激光更有利于相位估计（很反直觉吧）[1]！ 从这个角度来看，之所以人们不把相干态的海森堡极限叫做海森堡极限，是因为 bunched light 的海森堡极限比它要好。 下面是理解粒子数-相位不确定性原理的一个直观图示。 在相空间中，相干态是一个标准差为 1 的高斯函数。简单的几何学可以推导出粒子数-相位不确定性原理。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:4","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.2.3 NOON 态 $|\\Psi_0\\rangle = \\frac{|N\\rangle \\otimes |0\\rangle + |0\\rangle \\otimes |N\\rangle}{2}$ 在 NOON 态中，我们实际上引入了一个 ancilla （辅助）系统，并将探针态和 ancilla 纠缠起来：当探针有 n 个光子时，ancilla 有零个光子；反之亦然。此时整体的哈密顿量为 $\\hat{N} \\otimes \\mathbb{I}$。 此时量子 Fisher 信息为： $F(\\theta) = 4 [ \\langle \\Psi_0 | (\\hat{N} \\otimes \\mathbb{I})^2 | \\Psi_0 \\rangle - \\langle \\Psi_0 | \\hat{N} \\otimes \\mathbb{I} | \\Psi_0 \\rangle^2 ] = N^2$。 与相干态不同，NOON 态能够达到海森堡极限 $\\Delta \\theta = \\frac{1}{N}$。选取观测量为 $N_X + iN_Y$，其中 $N_X = |+ \\rangle\\langle +| - |-\\rangle\\langle - |$，$N_Y = |+i \\rangle\\langle +i| - |-i\\rangle\\langle -i |$，且 $|\\pm\\rangle = \\frac{|N\\rangle \\otimes |0\\rangle \\pm |0\\rangle \\otimes |N\\rangle}{\\sqrt{2}}$，$|\\pm i\\rangle = \\frac{|N\\rangle \\otimes |0\\rangle \\pm i |0\\rangle \\otimes |N\\rangle}{\\sqrt{2}}$。请读者验证该观测量的期望值为 $e^{iN\\theta}$，方差为 1，于是有 $1=|\\Delta e^{iN\\theta}| = |iN e^{iN\\theta} \\Delta \\theta| = N\\Delta \\theta$，即 $\\Delta \\theta = \\frac{1}{N}$，达到了海森堡极限。 然而，NOON 态是很脆弱的，当 N 稍微大一些就会退相干。实验上还没有制备出 N\u003e10 的 NOON 态。这是因为 NOON 态是类似于薛定谔的猫，当 N 较大时很快就会退相干。从这一点来看，NOON 态并不实用，还不如相干态。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:5","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"5.2.4 压缩态 我不打算给出压缩态的显式公式。实际上，你不需要公式也能理解压缩态。见下图 相位压缩 在相空间中，相干态是一个标准差为 1 的高斯函数。而压缩态其实就是将相干态在某一个 quadrature 上“压扁”了，从一个圆形变成了一个椭圆形。 压缩态仍然满足不确定性原理，只是在一个方向上的不确定性较大，在另一个方向上的不确定性较小。我们可以通过如上图所示的 Phase squeezing（相位压缩）来提高 $\\Delta N$ 从而降低 $\\Delta \\theta$ 。反之，如果我们想要降低 $\\Delta N$ ，我们可以通过提高 $\\Delta \\theta$ ，这就是 Amplitude squeezing（振幅压缩）。 振幅压缩态的 $g^{(2)}(0)\u003c1$，而相位压缩态的 $g^{(2)}(0) \u003e 1$ 。回想一下，我们有$(\\Delta N)^2 = (g^{(2)}(0)-1)\\langle \\hat{N}\\rangle^2 + \\langle \\hat{N}\\rangle$ 。可见，对于压缩态， $\\Delta N \\propto \\bar{n}$ ， $\\Delta \\theta \\propto \\frac{1}{\\bar{n}}$ ，达到了海森堡极限。压缩强度越大， $g^{(2)}(0)$ 就越大， $\\Delta \\theta \\sim \\frac{1}{k\\bar{n}}$ 的比例系数 $k$ 就越高。 与脆弱的 NOON 态相比，压缩态更加实用一些。在文章开头我们就介绍过，著名的探测引力波的 LIGO 就使用了压缩态。另外，在样品损伤阈值较低的时候（例如生物样品），我们不能通过提高激光功率来降低散粒噪声，此时人们也使用压缩态来在不提升功率的前提下进一步提高成像精度。 ","date":"2024-04-23","objectID":"/quantum_metrology/:5:6","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"六、量子成像与量子照明 ","date":"2024-04-23","objectID":"/quantum_metrology/:6:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"七、其他的量子参数估计问题 ","date":"2024-04-23","objectID":"/quantum_metrology/:7:0","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"7.1 Gain sensing ","date":"2024-04-23","objectID":"/quantum_metrology/:7:1","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"7.2 Noise sensing ","date":"2024-04-23","objectID":"/quantum_metrology/:7:2","tags":["量子计量学"],"title":"量子计量学（Quantum Metrology）简明入门","uri":"/quantum_metrology/"},{"categories":["量子信息"],"content":"Quantum State Tomography（量子态层析） Quantum state tomography（量子态层析）就是根据【对量子态系综的测量结果】反推【量子态】的过程。它的 formulation 非常简单，具体如下： 已知一系列测量算符 ${\\Pi_1,\\cdots,\\Pi_n}$ 及其对应的测量概率 $p_k=\\operatorname{Tr}[\\rho \\Pi_k]$ ，求量子态 $\\rho$ 。 换句话说，在 $p_k=\\operatorname{Tr}[\\rho \\Pi_k]$ 这 n 个公式里面，已知 $p_k$ 和 $\\Pi_k$ ，求 $\\rho$ 。 反过来，如果已知 $\\rho$ 和 $p_k$ 求 $\\Pi_k$ ，那么就叫 Detector tomography。不过这不是本篇文章的内容。 为什么要关心 state tomography？因为我们想要知道实验上制备的量子态具体长啥样。方法就是 state tomography。 从公式 $p_k=\\operatorname{Tr}[\\rho \\Pi_k]$ 中可以看出，如果 $\\rho$ 有 $n$ 个自由度，那么我们也至少需要 $n$ 个 测量算符，而且这些测量算符之间还要“相互独立”，这个条件叫做 tomographical completeness 或者 informational completeness。 为什么叫“层析”（tomography）？ State tomography 之所以叫“tomography”，是因为连续变量光子态的 tomography 和 医院里做的 CT（Compute tomography）真的很像。CT 是已知各个角度的投影图像，重建三维图像，而连续变量光子态的 tomography 就是已知各个角度的投影图像，重建 Wigner function。后者是一种“二维图像”。 当然，用离散变量也是可以理解的，因为（von Neumann）测量无非就是投影，而 tomography 就是根据测量到的投影来重建原量子态。 总之，tomography 之所以叫 tomography，就是因为它是一个根据投影来重建整体的过程。 ","date":"2024-04-22","objectID":"/state_tomography/:1:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"一个 Qubit 的 State tomography 一个 qubit 的密度算符只有三个自由度（Bloch vector），所以理论上只需要三个测量算符就可以了。例如可以选择 ${(\\mathbb{I}+X)/2,\\,\\, (\\mathbb{I}+Y)/2,\\,\\, (\\mathbb{I}+Z)/2 }$ 这三个测量算符（其中 $X,Y,Z$ 是泡利矩阵）。它们在 Bloch 球上对应 X, Y, Z 三个轴，相当于分别测量 Bloch vector 的 x, y, z 分量。 但问题是，在实验上，我们不是直接测量概率，而是测量结果的计数。我们如果想要知道概率 $p_Z=\\operatorname{Tr}[\\rho (\\mathbb{I}+Z)/2] = \\langle0|\\rho|0\\rangle$ ，就必须要利用计数 $p_Z=\\frac{N_Z}{N_Z+N_{-Z}}$ ，而测量 $N_{-Z}$ 又需要新的一个 测量算符 $(\\mathbb{I}-Z)/2$ 。 更一般地说，由于我们测量的是计数，需要 normalization，所以实际需要的测量算符数量总是比理论需要的多一个。而 N 个 qubit 的密度算符的自由度是 $4^n-1$ ，再加一刚好就是 $4^n$ 了。 对于 n=1 而言，我们就需要 4 个测量算符。这也是最早的光子态 tomography 文章[1]所采用的方法。 好了，withour further ado，我们来仔细研究一下一个 qubit 的 tomography，这对后面推广到多个 qubit 有帮助。 一个 qubit 的密度算符是 $\\rho = \\frac{\\mathbb{I}+xX+yY+zZ}{2}$ ，对其进行 tomography 就是要求解 $x, y,z$ 。正如前文所说，我们选取四个测量算符： ${(\\mathbb{I}+X)/2,\\,\\, (\\mathbb{I}+Y)/2,\\,\\, (\\mathbb{I}+Z)/2, \\,\\,(\\mathbb{I}-Z)/2 }$ 。那么测量到的计数分别为 $N_{X} = N p_X = N \\operatorname{Tr}[\\rho \\frac{\\mathbb{I}+X}{2}] = N\\frac{1+x}{2}$ $N_{Y} = N p_Y = N \\operatorname{Tr}[\\rho \\frac{\\mathbb{I}+Y}{2}] = N\\frac{1+y}{2}$ $N_{Z} = N p_Z = N \\operatorname{Tr}[\\rho \\frac{\\mathbb{I}+Z}{2}] = N\\frac{1+z}{2}$ $N_{-Z} = N p_{-Z} = N \\operatorname{Tr}[\\rho \\frac{\\mathbb{I}-Z}{2}] = N\\frac{1-z}{2}$ 联立这四个方程，我们就能求出 $x,y,z,N$ 四个未知数。 OK，完事了，就是这么简单。 ","date":"2024-04-22","objectID":"/state_tomography/:2:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"极大似然估计 等等，真有这么简单吗？敏锐的同学会发现，密度算符有正定性的要求，但是上面的求解过程没有任何一步能够确保正定性。 实际上，如果按照上面的步骤求解，是完全有可能解出非正定的密度算符的。换句话说，会求解出“非物理”（non-physical）的结果。 这是因为实验数据是有误差的，这种误差在某些情形下会导致非物理的结果。 注意，不是实验系统不理想导致的误差，而是量子统计本身的误差，或者说 fluctuation。例如，对于 coherent state，其计数分布是泊松分布，方差等于均值。在时间有限不能获取很多数据的时候，相对误差 $\\frac{\\Delta N}{N}=\\frac{1}{\\sqrt{N}}$ 会比较大。 有同学可能马上就会说：那我们再给结果加一个约束不就行了？在这个例子里，我们只要要求 $|x|,|y|,|z|\\le1$ 就可以保证正定性了。 但问题随之而来：加了约束以后，非正定的情形就直接变成无解了。 OK，既然无解是由误差导致的，那么我们可以退而求其次，把问题从【解方程问题】变成一个【拟合问题】。 什么是拟合问题？我们知道，两点确定一条直线。而在数据点本身误差较大的时候，我们需要很多个点，这些点几乎一定不在一条直线上，此时直线方程无解。 虽然无解，但是我们可以拟合呀！用最小二乘法就可以了！ 那么最小二乘法是从哪里来的？答案就是极大似然估计（Maximum Likelihood Estimation，MLE）。 极大似然估计的思想就是找到这样一条直线，使得这条直线（在诸多直线中）是最有可能产生我们所测量到的点的那一条直线。具体的执行方式就是设置一个似然函数，它的自变量是直线的参数，且它的函数值是在该直线的前提下，测量到已有结果的概率。然后整个问题就变成了一个优化问题：找到似然函数的最大值及其对应的直线参数。 在很多情况下，人们把实验误差假设为符合正态分布，那么似然函数就是一个指数形式 $L=e^{-\\mathcal{L}}$ ，然后我们会对似然函数取对数并取相反数得到新的似然函数 $\\mathcal{L}$ ，然后找新的似然函数 $\\mathcal{L}$ 的最小值。这个新的似然函数一般可以被解读为“在假设该直线的前提下，理论测量结果和实际测量结果之间的误差总和”。 以上所有思想都可以照搬到我们的 state tomography 中。我们可以设置一个似然函数，其自变量是正定矩阵 $\\rho$ 的自由度，其函数值是量子态为 $\\rho$ 的前提下，测量到所测量到的结果的概率。 下面我们把这些思想转化为算法： 定义合法的密度算符 $\\rho(x,y,z)=\\frac{\\mathbb{I}+xX+yY+zZ}{2}, |x|,|y|,|z|\\le1$ 定义似然函数为假设量子态为 $\\rho$ 时测量到实际结果的概率： $\\begin{aligned} \\mathcal{L}(x,y,z) \u0026= P(N_1=n_1,N_2=n_2,\\cdots) \\\\ \u0026= \\prod_k \\exp\\left[-\\frac{(n_k-\\hat{n}_k)^2}{2\\hat{n}_k}\\right]\\\\ \u0026= \\prod_k \\exp\\left[-\\frac{(n_k-N\\operatorname{Tr}[\\rho \\Pi_k])^2}{2N\\operatorname{Tr}[\\rho \\Pi_k]}\\right] \\end{aligned}$ 这里采用了连续的正态分布而不是离散的泊松分布，是因为在数量较大时（实验上通常为至少几百个到几千个），正态分布可以很好地近似泊松分布。 将似然函数取为泊松分布也可以，但是结果（见附录）没有那么直观，而且对于计算机来说负担也更大。 为方便计算，对其取负对数，并去掉不必要的常数 $N$，得到： $\\begin{aligned} \\mathcal{L}(x,y,z)=\\sum_k\\frac{\\left(p_k-\\hat{p}_k\\right)^2}{2\\hat{p}_k}=\\sum_k\\frac{\\left(p_k-\\operatorname{Tr}[\\rho(x,y,z)\\Pi_k]\\right)^2}{2\\operatorname{Tr}[\\rho(x,y,z)\\Pi_k]} \\end{aligned}$ 此时我们只要求 $(x_0,y_0,z_0) = \\underset{|x|,|y|,|z|\\le1}{\\operatorname{arg\\,min}} \\mathcal{L}(x,y,z)$ 即可。 这是一个有约束的优化问题。能不能将其转化为无约束的优化问题呢？见下文。 ","date":"2024-04-22","objectID":"/state_tomography/:3:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"多个 Qubit 的 state tomography n 个 qubit 的密度算符有 $4^n -1$ 个自由度，此时 Bloch vector 的对应物为 Pauli Correlator： $\\begin{aligned} \\rho = \\frac{1}{2^n}\\sum_{i_1,\\cdots,i_n=0}^{3} c_{i_1i_2\\cdots i_n} \\sigma_{i_1} \\otimes \\sigma_{i_2} \\otimes \\cdots \\sigma_{i_n} \\end{aligned}$ 其中 $\\sigma_i,\\,i=0,1,2,3$ 分别为恒等矩阵和泡利矩阵 $\\mathbb{I},X,Y,Z$ 。且 $c_{i_1i_2\\cdots i_n}$ 叫做 correlators。 此时我们至少需要 $4^n$ 个测量算符，在这些算符下测量得到计数，然后就可以做极大似然估计了。 此时的态 $\\rho$ 可以设置为 $\\rho(\\mathbf{t})=\\frac{T^\\dag(\\mathbf{t})T(\\mathbf{t})}{\\operatorname{Tr}(T^\\dag(\\mathbf{t})T(\\mathbf{t}))}$ ，其中 $T(\\mathbf{t})=\\begin{bmatrix} t_1 \u0026 0 \u0026 0 \u0026 \\cdots \u0026 0 \\\\ t_{2^n+1}+it_{2^n+2} \u0026 t_2 \u0026 0 \u0026 \\cdots \u0026 0 \\\\ t_{2^n+5}+it_{2^n+6} \u0026 t_{2^n+3}+it_{2^n+4} \u0026 t_3 \u0026 \\cdots \u0026 0 \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ t_{4^n - 1}+it_{4^n} \u0026 t_{4^n - 3}+it_{4^n-2} \u0026 t_{4^n - 5}+it_{4^n-4} \u0026 \\cdots \u0026 t_{2^n} \\end{bmatrix}$ 这是为了保证 $\\rho(\\mathbf{t})$ 的正定性。 相较于将 correlators $c_{i_1i_2\\cdots i_n}$ 作为参数且约束它们的绝对值不大于一而言，T(t) 这种参数化方式的好处是把即将要进行的极大似然估计从有约束的问题变成了无约束的问题（我们对 t 没有任何约束）。 此时的似然函数为： $\\begin{aligned} \\mathcal{L}(\\mathbf{t})=\\sum_k\\frac{\\left(p_k-\\hat{p}_k\\right)^2}{2\\hat{p}_k}=\\sum_k\\frac{\\left(p_k-\\operatorname{Tr}[\\rho(\\mathbf{t})\\Pi_k]\\right)^2}{2\\operatorname{Tr}[\\rho(\\mathbf{t})\\Pi_k]} \\end{aligned}$ ","date":"2024-04-22","objectID":"/state_tomography/:4:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"测量算符的选取 选取什么样的测量算符才是最好的呢？ 一般在偏振编码的光子 qubit 中，我们就简单地使用 H，V，D，A，R，L 这六个投影测量及其组合（它们是很好实现的，只需要使用波片即可）。那么对于 n 个 qubit 而言，此时我们就拥有 $6^n\u003e4^n$ 个投影算符，就够用了。 由于 $(|H\\rangle\\langle H|, |V\\rangle\\langle V|)$ 构成一个 POVM， $(|D\\rangle\\langle D|, |A\\rangle\\langle A|)$ 构成一个 POVM， $(|R\\rangle\\langle R|, |L\\rangle\\langle L|)$ 构成一个 POVM，也就是说 6 个投影测量对应 3 个 POVM，所以我们需要 $3^n$ 个 POVM，实验上就是 $3^n$ 个 measurement settings（所谓 measurement settings 就是波片的角度）。 但是问题来了，还有没有更好的办法可以减少 POVM 的数量，从而减少 tomography 所需的时间？毕竟 $6^n\u003e4^n$ 是冗余的。 从这里开始可以说算是学术界的前沿问题了，可以宣传我们组的一些工作。以后再更吧，哈哈哈。 ","date":"2024-04-22","objectID":"/state_tomography/:5:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"连续变量光子态的 state tomography 所谓连续变量的光子态（continuous-variable photonic states），就是考虑整个 Fock Space ，而不是只考虑 Fock Space 中的零光子和单光子的子空间。我们之所以关心连续变量，是因为光子本质上是一个谐振子系统，而非一个二能级系统。考虑前者更加自然，也更加符合光子的本质。实际上，我们日常生活中的经典电磁波就是一种连续变量的光子态（即 coherent state）。 单模连续变量光子态可以由准概率分布函数来描述。准概率分布函数有三种，Glauber P-，Husimi Q-，以及 Wigner 函数，它们分别简称 P-，Q-，W- 表示。由于只有 Wigner 函数的边缘分布对应实际观测量的概率分布，所以我们一般考虑 Wigner 函数。 Wigner 函数是什么？ 如何理解 Wigner 函数？我们可以先从经典电磁波出发。我们都知道，单模（单一频率）的电磁波可以用复平面上的一个点来描述（即用相图描述）。电磁波的叠加可以直接对应相图中的复数加法（或矢量加法）。 这个所谓的相图表示可以立刻推广到量子力学中。对于量子化的单模经典电磁场，它的相图表示不再是一个无限小的点，而是一个有一定大小的圆。实际上，它是一个复平面上的高斯函数，且该高斯函数的标准差由不确定性原理确定。这个高斯函数就是经典电磁波的 Wigner 函数，其边缘分布对应该 quadrature 的电场强度的概率分布（电场也是可观测量，是有不确定性的）。经典电磁波被量子化之后得到的量子态叫做 Coherent state。 对于一个更一般的量子光场，其 Wigner 函数可以长得奇形怪状，甚至可以取负值。当然，这不意味着我们得到了负的概率——在求边缘分布之后，我们得到的总是非负概率。这是因为这些负值所占据的面积足够小，以至于它们小于不确定性原理所允许的面积，也就是说不确定性原理保证了我们观测不到负概率。 一些有趣的光子态的 Wigner 函数。左图为压缩态，右图为薛定谔猫态。 连续变量光子态的 state tomography 是通过测量 quadrature 来完成的。此时所有的测量算符拥有如下形式： $\\begin{aligned} \\Pi_\\theta = \\frac{ae^{-i\\theta}+a^\\dag e^{i\\theta}}{2} \\end{aligned}$ 这就是所谓的“quadrature”（不知道中文译名是什么）。形象地来看，它是将整个 Wigner 函数投影到一条直线上，这条直线与 x 轴的夹角为 $\\theta$ 。 Quantum state tomography of continuous-variable optical states 量子信息理论告诉我们，如果我们想要（以无限精度）重建 Wigner 函数，我们就需要无限多个 $\\theta$ ，即无数个测量算符。当然，我们不需要无限的精度，所以我们只要把 $\\theta$ 取得密一些就可以了。例如以 0.01 弧度为步长，从 0 取到 2pi。 得到 quadrature 的概率密度分布函数之后，我们就可以使用逆 Radon 变换重建 Wigner 函数了。这和医院里的 CT 原理完全相同。 至于实验上如何测量 quadratures，很简单，和无线电里一样，将信号与本振进行混频就可以了。这叫做 homodyne measurement。具体来说就是将待测信号和一个激光用一个 beam splitter 混合，然后记录两路输出信号的差值。改变激光的相位就是改变 $\\theta$ 。 Homodyne Measurement ","date":"2024-04-22","objectID":"/state_tomography/:6:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"附录 泊松分布的极大似然估计 泊松分布对应的似然函数为 $ \\begin{aligned} \\mathcal{L}(\\mathbf{t}) \u0026= P(N_1=n_1,N_2=n_2,\\cdots) \\\\ \u0026= \\prod_k e^{-\\lambda_k} \\frac{\\lambda_k^{n_k}}{n_k!} \\\\ \u0026\\xrightarrow{-\\log} \\sum_k (\\lambda_k - n_k \\log \\lambda_k + \\cancel{\\log n_k!}) \\\\ \u0026\\xrightarrow{\\frac{1}{N}} \\sum_k(\\hat{p}_k(\\mathbf{t})-p_k \\log \\hat{p}_k(\\mathbf{t})) \\end{aligned}$ 其中 $\\lambda_k = N \\operatorname{Tr}[\\rho(\\mathbf{t}) \\Pi_k]= N \\hat{p}_k(\\mathbf{t})$ 。 对似然函数求导找极小值，可以发现极小值在 $\\hat{p}_k(\\mathbf{t}) = p_k$ 时取到。这说明采用泊松分布也是正确的。但是泊松分布的似然函数里有对数，而正态分布的似然函数里都是多项式，后者对于计算机更友好，收敛更快一些。所以我们一般采用正态分布对应的似然函数。 ","date":"2024-04-22","objectID":"/state_tomography/:7:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"参考 ^James, D. F. V., Kwiat, P. G., Munro, W. J. \u0026 White, A. G. Measurement of qubits. Phys. Rev. A 64, 052312 (2001). ","date":"2024-04-22","objectID":"/state_tomography/:8:0","tags":["量子光学"],"title":"【量光实验杂谈·三】量子态层析","uri":"/state_tomography/"},{"categories":["量子信息"],"content":"一个波包可以对应一个光子 例：一个光子可以处于不同频率的相干叠加态中： $|\\psi\\rangle=\\sum_{k}c_k|k\\rangle,\\quad \\sum_k|c_k|^2=1$ ，此时该光子可以表现为一个波包。 你可以想象一个原子退激发产生一个光子，这个光子当然会表现为一个波包。 有人可能会 argue：如果排除各种非理想因素，那么这个光子的线宽只取决于自然展宽（寿命），可以看成是单一频率，从而定域性较差，不能说是一个波包。的确如此。 但是如果考虑脉冲式泵浦且为 low-gain regime 下的参量过程所产生的单光子，其自然线宽本身就是非常大的。此时它的确处于不同频率的相干叠加态中，在时域上表现为一个定域性良好的波包。 定义 单光子态 形如 $\\sum_{k}c_k|0,\\cdots,\\underbrace{1}_{k-\\text{th}},\\cdots,0\\rangle$ 的态叫做单光子态，其中 $|0,\\cdots,\\underbrace{1}_{k-\\text{th}},\\cdots,0\\rangle$ 表示第 k 个模式上有一个光子，且 $\\sum_{k}|c_k|^2=1$ 。 直观来看，把不同模式上有一个光子的态相干叠加起来，仍然是单光子态。 ","date":"2024-04-13","objectID":"/photon_wave_packets/:0:1","tags":["量子光学"],"title":"光子和电磁场波包有什么关系","uri":"/photon_wave_packets/"},{"categories":["量子信息"],"content":"但是一个光子不一定是一个波包 反例 1：一个光子通过 NPBS（non-polarizing beam splitter）之后会同时走两条路：透射路和反射路。此时该光子是非定域的。 反例 2：一个圆偏振的光子在通过 PBS（polarizing beam splitter）之后会同时走两条路：透射路和反射路。此时该光子是非定域的。如果将路径看做希尔伯特空间的一个自由度，那么此时该光子处于路径和偏振的纠缠态。 反例 3：一个光子也可以是同一个路径上的两个波包：用一个 PBS 将一个光子分成两路，再用另一个 PBS 将这两路重新合起来，如果两路的光程不同，那么重新合起来之后，该光子就变成了一前一后两个波包。 **反例 4：**一个光子甚至可以自己与自己发生干涉：先把该光子分成两个波包，再控制两路的光程近似相同，最后将两个波包重新重合起来。这就是单光子级别下的迈克尔逊/马赫曾德尔干涉仪。 ","date":"2024-04-13","objectID":"/photon_wave_packets/:0:2","tags":["量子光学"],"title":"光子和电磁场波包有什么关系","uri":"/photon_wave_packets/"},{"categories":["量子信息"],"content":"更多有趣的光子态 以上三个反例都与时空模式有关，且都是非常熟知的事实，下面给出其他一些有意思的态，或许可以刷新你对光子的理解。 例 1：频率叠加态 正如上面所说，一个光子可以处于不同频率的叠加态中。更重要的是，光子在频域中也可以是两个波包而不是一个波包。例如，一个光子可以处于波长为 1557nm 和波长为 1563nm 的叠加态，实验上可以制备这样的态[1]。 例 2：电场叠加态（薛定谔猫态） 在光子数很少的情况下，电场和磁场也是有显著的不确定性的（正如动量和位置具有不确定性一样）。电场和磁场构成一对 canonical variables。 实验上可以制备薛定谔猫态，即电场处于 $|\\alpha\\rangle$ 和 $|-\\alpha\\rangle$ 的叠加态中。此时，如果你测量某一点（沿偏振方向）的电场，可能测到正，也可能测到负。 当光子数较多时，这样的态是很脆弱的，会快速退相干为 $|\\alpha\\rangle$ 和 $|-\\alpha\\rangle$ 的统计混合。 而在光子数较低的级别下，实验上可以制备这样的态[2]。 例 3：频率纠缠态 两个光子还可以处于频率纠缠态： $|\\psi\\rangle=\\frac{1}{2}(|\\mu\\rangle \\otimes|\\nu\\rangle+|\\nu\\rangle \\otimes|\\mu\\rangle)$ 。简而言之，如果观测到一个光子的波长是 1557nm，那么另一个光子的波长立刻就会坍缩到 1663nm，反之亦然[1]。 例 4：数量纠缠态 实验上可以制备 NOON 态： $|\\psi\\rangle=\\frac{1}{2}(|N,0\\rangle + |0,N\\rangle)$ ，即，如果一个模式有 N 个光子，那么另一个模式就没有光子，反之亦然。而且要么是 0，要么是 N，不能是别的数。 这两个模式可以是空间模式。此时你可以想象一群光子处于全都往左走和全都往右走的叠加态中。如果你在一边探测到 N 个光子，那么你就能立刻知道遥远的彼端没有光子，反之亦然。 当然，当光子数较多时，这样的态是比较脆弱的，很难保证各个光子之间保持稳定的相位关系。 总之，光子的自由度是很多的。你能想到的任何自由度，我们都可以进行叠加和纠缠。只是在光子数较大时有三个困难，一是难以制备，二是容易退相干，三是难以刻画（state tomography）。 一个光子可以是一个波包，也可以不是一个波包；一个波包可以是一个光子，也可以不是一个光子。重点在于理解量子力学中的相干叠加（coherent superposition）： $\\sum_{k}c_k|0,\\cdots,\\underbrace{1}_{k-\\text{th}},\\cdots,0\\rangle$ 。 ","date":"2024-04-13","objectID":"/photon_wave_packets/:0:3","tags":["量子光学"],"title":"光子和电磁场波包有什么关系","uri":"/photon_wave_packets/"},{"categories":["量子信息"],"content":"参考 ^abShukhin, A., Hurvitz, I., Trajtenberg-Mills, S., Arie, A. \u0026 Eisenberg, H. Two-dimensional Control of a Biphoton Joint Spectrum. Preprint at http://arxiv.org/abs/2311.09660 (2023). ^Lvovsky, A. I. et al. Production and applications of non-Gaussian quantum states of light. Preprint at http://arxiv.org/abs/2006.16985 (2020). ","date":"2024-04-13","objectID":"/photon_wave_packets/:1:0","tags":["量子光学"],"title":"光子和电磁场波包有什么关系","uri":"/photon_wave_packets/"},{"categories":["数学物理方法"],"content":"一 微分是无穷小？ 物理人喜欢把微分看做是一个很小的量，这在计算时总是很方便的，但是给人一种不严谨的感觉。 实际上，它确实不严谨，第二次数学危机就是因此产生的。 严谨性与易懂性永远是互补的。把微分看做无穷小，迎合感性的胃口，却无法通过理性的审查。 ","date":"2024-03-13","objectID":"/understanding_differentials/:1:0","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["数学物理方法"],"content":"二 微分是线性函数 我喜欢把微分看做一个机器，例如 $f:f(x,y)=x^2+2y^2$ 在 $(1,1)$ 处的微分 它就是这样一个机器： 它接受两个数，吐出一个数。 写出来就是这样： $\\mathrm{d}f|_{(1,1)}(a,b)=\\frac{\\partial f}{\\partial x}\\bigg|_{(1,1)}a+\\frac{\\partial f}{\\partial y}\\bigg|_{(1,1)}b=2a+4b$ 由于每一点的偏导可能不同，所以如果说某一点的微分是一个机器，那么，微分就是机器构成的海洋。 你可能还注意到了这个机器是“线性的”，它不过就是 $\\mathbb{R}^2$ 到 $\\mathbb{R}$ 的线性映射。 线性代数的知识告诉我们，线性函数的集合可以构成线性空间。换言之，线性函数自己就是个“矢量”，是可以加减数乘的。 回到上面的比喻，就是说，我们可以把两个机器加起来： $\\mathrm{d}f|_p+\\mathrm{d}g|_p$ ， 也可以将一个机器变为原来的 $\\lambda$ 倍大： $\\lambda \\cdot \\mathrm{d}f|_p $ 。 下标 p 表示在 p 点的微分。 把机器加起来是什么意思呢？举个例子，若 $\\mathrm{d}f|_p(a,b)=2a+4b,,, \\mathrm{d}g|_p(a,b)=a-b$ ， 则 $\\mathrm{d}f|_p(a,b)+\\mathrm{d}g|_p(a,b)=3a+3b$ 。 这很像是两个矢量的相加： $(2,4)+(1,-1)=(3,3)$ 。 实际上，它们就是矢量。是的，你没听错，微分是矢量（场）。 ","date":"2024-03-13","objectID":"/understanding_differentials/:2:0","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["数学物理方法"],"content":"三 微分是对偶矢量场 ","date":"2024-03-13","objectID":"/understanding_differentials/:3:0","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["数学物理方法"],"content":"3.1 切空间 如果你想要在一个弯曲的面上研究微分，那么你就需要重新定义一些概念。比如，微分是线性的，可是流形是弯曲的，所以我们需要在这弯曲中定义一个线性的东西出来。这个线性的东西就是切空间。 顾名思义，切空间就是一个曲面在某一个点处的切面。但是要怎么定义它呢？这里的弯曲并不是嵌在另一个空间里的弯曲，而是空间本身的弯曲，这种弯曲是内禀的。我们不能像古典解析几何那样去求切面方程。 我们换一个思路： 首先，它是线性的，也就是说它是一个向量空间。 向量空间就是一个配备了数乘的阿贝尔群。具体地说，它里面的元素（称为矢量）满足如下性质： （1）矢量的加法交换律 （2）矢量的加法结合律 （3）矢量的加法有单位元(类似于零) （4）矢量的加法有逆元(类似于相反数) 以上四个性质表明线性空间对于矢量加法而言是一个阿贝尔群。 （5）数乘有乘法单位元 （6）数乘的乘法结合律 （7）数乘的乘法分配律（对标量分配） （8）数乘的乘法分配律（对矢量分配） 向量空间不必是 $\\mathbb{R}^n,,\\mathbb{C}^n$，只要一个集合里定义了加法和数乘运算且满足以上性质，这个集合就是一个向量空间。 我们可以定义这样一个向量空间，它其中的元素是光滑函数的集合到实数域的线性映射： $v:\\mathcal{F}_M\\rightarrow\\mathbb{R}$ 满足 （1）$v(\\lambda f+\\mu g)=\\lambda v(f)+\\mu v(g)$ （线性律） （2） $v|_p(f\\cdot g)=f|_p\\cdot v(g)+g|_p\\cdot v(f)$ （莱布尼茨律） 其中 $\\mathcal{F}_M$ 是微分流形 $M$ 上所有光滑函数构成的集合。 可以证明， $v$ 的集合可以构成向量空间。 别看这个定义这么复杂，实际上就是对一个函数在某一点求方向导数。 以二元函数为例，我们显式地写出 $v$ 的一个实例： $\\left(a\\frac{\\partial}{\\partial x}+b\\frac{\\partial}{\\partial y}\\right)\\bigg|_p$ 如果以 $(\\frac{\\partial}{\\partial x}\\bigg|_p,\\frac{\\partial}{\\partial y}\\bigg|_p)$ 为基，那么它的坐标就是 $(a,b)$ 。 这个线性空间就是流形 $M$ 上点 $p$ 处的切空间，记作 $T_pM$ 。 以上所有操作都是在某一点 $p$ 的，每一点都长出了一个切空间。你可以想象成弯曲面上的每一点都长出了一个切平面。 ","date":"2024-03-13","objectID":"/understanding_differentials/:3:1","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["数学物理方法"],"content":"3.2 余切空间 刚才介绍了切空间 $T_p M$ 。我们现在把切空间的对偶空间 $T_p^*M$ 叫做余切空间。 某一点的微分正是余切空间中的元素。换言之，某一点的微分是一个余切矢量。 对偶空间中的元素（余切矢量）是线性泛函，能把原空间中的元素映射成一个数。这正是我们之前所说的机器： 只不过现在的输入应该是切空间中的元素 $\\left(a\\frac{\\partial}{\\partial x}+b\\frac{\\partial}{\\partial y}\\right)\\bigg|_p$ 。 我们说过，微分是机器的海洋。因此余切矢量的海洋（也就是微分）可以叫做余切矢量场。 在数学中，微分（余切矢量场）有一个酷炫的名字，叫做余切丛的截影。详见 https://zhuanlan.zhihu.com/p/629852598 说了这么多抽象废话，下面来定义一下： 流形 $M$ 上某一点 $p$ 处的微分是这样一个线性泛函，它作用到切空间的元素 $v|_p\\in T_pM$ 上，得到 $\\mathrm{d}f|_p(v|_p)=v|_p(f)$ 再举一个更显式的例子，以二元函数为例： $\\mathrm{d}f|_{p}:\\mathrm{d}f|_{p}(v|_p)=v|_p(f)= \\frac{\\partial f}{\\partial x} \\bigg|_{p} a+\\frac{\\partial f}{\\partial y}\\bigg|_{p}b$ ，其中 $v|_p=\\left(a\\frac{\\partial}{\\partial x}+b\\frac{\\partial}{\\partial y}\\right)\\bigg|_p$ ","date":"2024-03-13","objectID":"/understanding_differentials/:3:2","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["数学物理方法"],"content":"四 微分是 Jacobian 矩阵刻画的线性映射 到目前为止，我们讨论的都是到达域为 $\\mathbb{R},\\mathbb{C}, \\cdots$ 的函数。如果到达域可以是 $\\mathbb{R}^2, \\mathbb{R}^3,\\cdots$ 呢？ 例如 $\\bm{f}:\\mathbb{R}^n\\rightarrow\\mathbb{R}^m$ 。 此时，可以把 $\\bm{f}$ 看成 m 个函数： $f_i:\\mathbb{R}^n\\rightarrow\\mathbb{R},,,i=1,\\cdots,m$ 那么就有 $\\begin{bmatrix}\\mathrm{d}f_1 \\\\ \\mathrm{d}f_2 \\\\ \\vdots \\\\ \\mathrm{d}f_m \\end{bmatrix}= \\begin{bmatrix} \\frac{\\partial f_1}{\\partial x_1}\u0026\\frac{\\partial f_1}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_1}{\\partial x_n} \\\\ \\frac{\\partial f_2}{\\partial x_1}\u0026\\frac{\\partial f_2}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_2}{\\partial x_n} \\\\ \\vdots\u0026\\vdots\u0026\\ddots\u0026\\vdots \\\\ \\frac{\\partial f_m}{\\partial x_1}\u0026\\frac{\\partial f_m}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_m}{\\partial x_n} \\end{bmatrix}\\begin{bmatrix}\\mathrm{d}x_1 \\\\ \\mathrm{d}x_2 \\\\ \\vdots \\\\ \\mathrm{d}x_n \\end{bmatrix}$ 其中 $\\begin{bmatrix} \\frac{\\partial f_1}{\\partial x_1}\u0026\\frac{\\partial f_1}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_1}{\\partial x_n} \\\\ \\frac{\\partial f_2}{\\partial x_1}\u0026\\frac{\\partial f_2}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_2}{\\partial x_n} \\\\ \\vdots\u0026\\vdots\u0026\\ddots\u0026\\vdots \\\\ \\frac{\\partial f_m}{\\partial x_1}\u0026\\frac{\\partial f_m}{\\partial x_2}\u0026\\cdots\u0026\\frac{\\partial f_m}{\\partial x_n} \\end{bmatrix}$ 就是 Jacobian 矩阵。 实际上，微分就是 Jacobian 矩阵所表示的线性映射。下面我们来详细解释一下。 对于一元函数，Jacobian 矩阵就是导数。 虽然我们习惯把导数看做斜率，但是我们现在不妨换个看法：如果你把一元函数的作用看作是数轴的拉伸，那么导数就是局部的伸缩比率。这样的好处是容易推广到多元函数。 因为，对于多元函数，你通常很难像一元函数那样做出一条曲线来表示函数。所以，作为一种替代方法，你可以把多元函数看做是空间的拉伸，例如 f: R^2→R^2。你可以想象 R^2 的每一点都被 f 拉到了新的一点。 如果你放大这个拉伸的局部，它看起来也像一元函数的情形那样，是线性的——平行等距的线被拉伸成平行等距的线。 而我们所说的微分，正是这个局部的线性映射！这个线性映射的矩阵就是 Jacobian 矩阵。 Khan Academy 的 Multivariable Calculus 课程的第 71-72 集有更详细的解释： https://www.youtube.com/watch?v=bohL918kXQk 如果显示网络错误，你也可以看 b 站的搬运： https://www.bilibili.com/video/BV1NJ411r7ja?from=search\u0026seid=11489752606099978202 ","date":"2024-03-13","objectID":"/understanding_differentials/:4:0","tags":["微分几何"],"title":"微分的四层理解","uri":"/understanding_differentials/"},{"categories":["量子信息"],"content":"光子有时空表象下的波函数： $\\Psi(\\mathbf{r},t)=\\langle \\mathbf{r},t|\\psi\\rangle=\\langle 0 |E^{+}(\\mathbf{r},t)|\\psi\\rangle$ 其中 $\\begin{aligned} |\\mathbf{r},t\\rangle = E^{-}(\\mathbf{r},t) |0\\rangle = \\sum_{\\mathbf{k},\\lambda} \\sqrt{\\frac{\\hbar \\omega}{2 \\epsilon_0 V}} e^{\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{r}-\\omega_{\\mathbf{k}} t)} a^\\dag_{\\mathbf{k},\\lambda} |0\\rangle \\end{aligned}$ 。 直观来看，就是让场算符 $E^{-}(\\mathbf{r},t)$ 在时空点 $(\\mathbf{r},t)$ 处创造一个态 $|\\mathbf{r},t\\rangle$ ，再求这个态和 $|\\psi\\rangle$ 之间的 overlap。 当我们说到光子的时空模式时，例如高斯脉冲，双曲正割脉冲等等，我们实际上说的就是上述的时空表象下的波函数。 当然，这个波函数不是“薛定谔意义上”的波函数，因为薛定谔方程属于非相对论量子力学，而光子是相对论粒子。 当我们说光子没有良定义的波函数时，我们实际上说的是它没有良定义的位置算符。但是我们有场算符 $E^{\\pm}(\\mathbf{r},t) $ 呀，所以也不需要位置算符。 光子波函数的说法在文献中是很常见的，举几个例子： [1] Xu, Y., Choudhary, S. \u0026 Boyd, R. W. Efficient Measurement of the Bi-photon Spatial Mode Entanglement with Stimulated Emission Tomography. Preprint at http://arxiv.org/abs/2403.05036 (2024). [2] Tian, Z., Liu, Q., Tian, Y. \u0026 Gu, Y. Wavepacket interference of two photons: from temporal entanglement to wavepacket shaping. Preprint at http://arxiv.org/abs/2403.04432 (2024). [3] Moura, A. G. da C. \u0026 Monken, C. H. Einstein-Podolsky-Rosen correlations in spontaneous parametric down-conversion: Beyond the Gaussian approximation. Preprint at http://arxiv.org/abs/2403.04561 (2024). ","date":"2024-03-09","objectID":"/photon_wave_func/:0:0","tags":["量子光学"],"title":"光子有波函数吗？","uri":"/photon_wave_func/"},{"categories":["数学物理方法"],"content":"Baker-Campbell-Hausdorff 公式 可以用来计算海森堡表象下的算符演化： $e^X Y e^{-X}=Y+[X,Y]+\\frac{1}{2!}[X,[X,Y]]+\\frac{1}{3!}[X,[X,[X,Y]]]+\\cdots$ 这个公式其实只是 BCH 公式的小弟 因为海森堡表象下的算符演化规则是 $A\\rightarrow UAU^{\\dag}$ ，其中 $U$ 是酉演化算符。 如果 $U$ 由 $H$ 生成，那么就是 $A\\rightarrow e^{\\frac{t}{i\\hbar}H}Ae^{-\\frac{t}{i\\hbar}H}$ 了。 例 1：Phase Shifter（移相器） 哈密顿量为 $H=\\varphi n$ ，湮灭算符 $a$ 的演化为： $\\begin{aligned} e^{-i\\varphi n} a e^{i\\varphi n}\u0026= a + i\\varphi [n, a] - \\frac{\\varphi}{2!} [n,[n,a]] - \\cdots \\\\ \u0026= a (1+i\\varphi -\\frac{\\varphi^2}{2!} - \\cdots)\\\\ \u0026= e^{i\\varphi} a \\end{aligned}$ 例 2：Beam Splitter（分束器） 哈密顿量为 $H= \\theta e^{i\\varphi} a^{\\dag}b + \\theta e^{-i\\varphi} a b^\\dag$ ，演化如下： $\\begin{aligned} e^{-iH} a e^{iH} \u0026= \\cos \\theta ,a + i \\sin\\theta, e^{i\\varphi} b \\\\ e^{-iH} b e^{iH} \u0026= i \\sin\\theta ,e^{-i\\varphi} a + \\cos \\theta ,b \\end{aligned}$ 这就是熟悉的 Bogliubov Transformation 这俩例子感觉像是大炮打蚊子，下面来个有用点的： 例 3：Two-mode Squeezed State（双模压缩态） 哈密顿量为： $\\begin{aligned} H=i\\hbar\\left(g^*a b-g a^\\dag b^\\dag\\right) \\end{aligned}$ $\\begin{aligned} a \u0026\\rightarrow e^{\\frac{H}{i\\hbar}} a e^{-\\frac{H}{i\\hbar}} \\\\ \u0026= a + \\left[{\\frac{H}{i\\hbar}},a\\right]+\\left[{\\frac{H}{i\\hbar}},\\left[{\\frac{H}{i\\hbar}},a\\right]\\right] + \\cdots \\\\ \u0026=\\cosh(r) a - \\sinh(r)e^{i\\xi}b^\\dag \\end{aligned}$ 其中 $g = re^{i\\xi}$ 。 这个做 SPDC 和 OPO 的很熟。在薛定谔表象下计算反而很难，用海森堡表象加 BCH 公式则容易得多。 例 4：Rotated Quadratures 生成元是总粒子数 $N$ ，正则位置算符 $Q$ 和正则动量算符 $P$ 的演化为： $\\begin{aligned} e^{i\\theta N} Q e^{-i\\theta N} = \\cos \\theta, Q + i \\sin \\theta, P \\\\ e^{i\\theta N} P e^{-i\\theta N} = i \\sin \\theta, Q + \\cos \\theta P \\end{aligned}$ 看起来就是把相空间旋转了一下。其实跟 Phase Shifter 差不多。 这个变换在处理 Squeezed states 的时候比较有用。主要就是把坐标变换到 Squeezed Quadrature 上面去。 BCH 公式的一个小弟都这么有用了，那它的本尊岂不是更强大？！现在有请本尊： $e^{X}e^{Y}=e^Z$ $Z=X+Y+{\\frac {1}{2}}[X,Y]+{\\frac {1}{12}}[X,[X,Y]]-{\\frac {1}{12}}[Y,[X,Y]]+\\cdots $ 呃，好像有点不太好用的样子。 实际上我们更常用的是一种特殊情形，即 $[X,Y]$ 为常数的情形，此时 BCH 公式变成 $Z=X+Y+{\\frac {1}{2}}[X,Y]$ 例 5：Displacement Operator（平移算子） $\\begin{aligned} D(\\alpha)\u0026=e^{\\alpha a^\\dag-\\alpha^* a} \\\\ \u0026=e^{-\\frac{1}{2}|\\alpha|^2}e^{\\alpha a^\\dag}e^{-\\alpha^* a} \\\\ \u0026=e^{\\frac{1}{2}|\\alpha|^2}e^{-\\alpha^* a}e^{\\alpha a^\\dag} \\end{aligned}$ 可见 BCH 公式允许我们在正规排序（产生算子在湮灭算子前面）和反正规排序之间灵活切换。 实际上，平移算子本身既不是正规排序，也不是反正规排序，而是对称排序。 例 6：Weyl Operator（外尔算子） $W(q,p) = e^{i(-qP+pQ)} = e^{\\frac{i}{2}qp}U(q)V(p) = e^{-\\frac{i}{2}qp}V(p)U(q)$ 其中 $U(q)=e^{-iqP}$ 是位置平移算子， $V(p)=e^{ipQ}$ 是动量平移算子。根据 BCH 公式，可以将它们解耦出来。 这个 $W:\\mathbb{R}^2\\rightarrow \\mathcal{L}(L^2(\\mathbb{R}))$ 叫做 Weyl Representation。 更一般地，Weyl Transformation 可以将一个经典相空间中的概率密度函数给量子化，变成一个密度算符，反过来，Wigner Transformation 可以将一个密度算符映射为一个相空间中的概率密度函数，这就是量子光学中的 Wigner Representation。 例 7：Glauber P-, Husimi Q- 与 Wigner Representation 一个密度算子 $\\rho$ 的 Wigner 表示是其特征函数的傅里叶变换。 特征函数： $\\chi_W(\\lambda)=\\operatorname{Tr}[\\rho D(\\lambda)]$ ，其中 $D(\\lambda) = e^{\\lambda a^\\dag - \\lambda a}$ 为平移算子。 Wigner 表示： $\\begin{aligned} W(\\alpha)=\\frac{1}{\\pi^2}\\int \\chi_W(\\lambda) e^{-(\\lambda a^* - \\lambda^*\\alpha)} \\mathrm{d}^2\\alpha \\end{aligned}$ 如果把特征函数改成正规排序和反正规排序，我们就能得到 Glauber P 表示和 Husimi Q 表示： Glauber P 表示： $\\begin{aligned} P(\\alpha) = \\int \\operatorname{Tr}[\\rho e^{\\lambda a^\\dag}e^{\\lambda^*a}] e^{-(\\lambda \\alpha^* - \\lambda^* \\alpha)} \\mathrm{d}^2 \\alpha \\end{aligned}$ Husimi Q 表示： $\\begin{aligned} Q(\\alpha) = \\int \\operatorname{Tr}[\\rho e^{\\lambda^*a}e^{\\lambda a^\\dag}] e^{-(\\lambda \\alpha^* - \\lambda^* \\alpha)} \\mathrm{d}^2 \\alpha \\end{aligned}$ 这样一来，P 和 Q 有了简单的形式： $\\begin{aligned} P\u0026: \\quad \\rho = \\int P(\\alpha) |\\alpha \\rangle\\langle \\alpha | \\mathrm{d}^2 \\alpha \\\\ Q\u0026:\\quad Q(\\alpha) = \\frac{1}{\\pi} \\langle \\alpha | \\rho | \\alpha \\rangle \\end{aligned}$ 好处是我们可以很方便地通过 P 和 Q 表示来计算正规排序算子和反正规排序算子的期望值： $\\begin{aligned} \\langle a^{\\dag k} a^l\\rangle \u0026= \\operatorname{Tr}[a^l \\rho a^{\\dag k}] \\\\ \u0026= \\operatorname{Tr}\\left[\\int P(\\alpha) a^l |\\alpha\\rangle\\langle \\alpha | a^{\\dag k} \\mathrm{d}^2 \\alpha\\right] \\\\ \u0026= \\int \\alpha^l \\alpha^{* k} P(\\alpha) \\mathrm{d}^2 \\alpha \\end{aligned}$ $\\begin{aligned} \\langle a^l a^{\\dag k}\\rangle \u0026= \\operatorname{Tr}[a^{\\dag k} \\rho a","date":"2024-03-07","objectID":"/bch/:0:0","tags":["量子光学"],"title":"BCH 公式 - 量子力学爆算的大杀器","uri":"/bch/"},{"categories":["量子信息"],"content":"在经典力学中，复数只是一个用来简化计算的数学技巧。 在量子力学中，复数不再只是一个数学技巧，而是有一定的物理意义。考虑经典矢势： $\\begin{aligned} \\mathbf{A}(\\mathbf{r},t)=\\sum_{\\mathbf{k}\\lambda} \\left( A_{\\mathbf{k}\\lambda}e^{i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega_{\\mathbf{k}}t)} + \\text{c.c.}\\right)\\mathbf{e}_{\\mathbf{k}\\lambda} \\end{aligned}$ 其中 $\\mathbf{k}$ 和 $\\lambda$ 分别代表空间模式和偏振模式 对其进行量子化得到海森堡表象下的矢势算子： $\\begin{aligned} \\mathbf{A}(\\mathbf{r},t)=\\sum_{\\mathbf{k}\\lambda} \\left( C_{\\mathbf{k}\\lambda}\\hat{a}_{\\mathbf{k}\\lambda}e^{i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega_{\\mathbf{k}}t)} + C_{\\mathbf{k}\\lambda}^{*}\\hat{a}^{\\dag}_{\\mathbf{k}\\lambda} e^{i(\\mathbf{k}\\cdot\\mathbf{r}+\\omega_{\\mathbf{k}}t)}\\right)\\mathbf{e}_{\\mathbf{k}\\lambda} \\end{aligned}$ 可见顺时针旋转的部分对应湮灭算子 $\\hat{a}_{\\mathbf{k}\\lambda}$ ，而逆时针旋转的部分对应产生算子 $\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}$ 。由于这两个算子不对易（ $[\\hat{a}_{\\mathbf{k}\\lambda},\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}]=1$ ），导致真空不再是“真空”，而是充满了电磁场的涨落。 具体来说，电磁场的哈密顿量为： $\\begin{aligned} \\hat{H}\u0026=\\hbar\\sum_{\\mathbf{k}\\lambda}\\frac{\\omega_\\mathbf{k}}{2}\\left\\{\\hat{a}_{\\mathbf{k}\\lambda},\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\right\\} \\\\ \u0026= \\hbar \\sum_{\\mathbf{k}\\lambda}\\frac{\\omega_{\\mathbf{k}}}{2}\\left(\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\hat{a}_{\\mathbf{k}\\lambda}+\\hat{a}_{\\mathbf{k}\\lambda}\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\right) \\\\ \u0026= \\hbar \\sum_{\\mathbf{k}\\lambda}\\frac{\\omega_{\\mathbf{k}}}{2}\\left(\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\hat{a}_{\\mathbf{k}\\lambda}+\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\hat{a}_{\\mathbf{k}\\lambda} + [\\hat{a}_{\\mathbf{k}\\lambda},\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}]\\right) \\\\ \u0026=\\hbar \\sum_{\\mathbf{k}\\lambda}\\omega_{\\mathbf{k}}\\left(\\hat{a}_{\\mathbf{k}\\lambda}^{\\dag}\\hat{a}_{\\mathbf{k}\\lambda} + \\frac{1}{2}\\right) \\\\ \u0026= \\hbar \\sum_{\\mathbf{k}\\lambda} \\omega_{\\mathbf{k}}\\left(\\hat{n}_{\\mathbf{k}\\lambda}+\\frac{1}{2}\\right) \\end{aligned}$ 当所有模式的激发数都为零，也就是真空时，电磁场的能量并不为零。这是由真空涨落导致的。 ","date":"2024-02-16","objectID":"/complex_numbers_in_em/:0:0","tags":["量子光学"],"title":"复数对于描述电磁波有什么重要性？","uri":"/complex_numbers_in_em/"},{"categories":["量子信息"],"content":"上篇我们说了在 HBT 实验中，用非光子数分辨的单光子探测器测量量子二阶关联函数的原理。 https://zhuanlan.zhihu.com/p/679453473 这篇我们来看看量子二阶关联函数有什么用。除了老生常谈的用来区分【超泊松统计/泊松统计/亚泊松统计】以及区分【光子集聚/反集聚】以外，HBT 实验还可以用来测量多模压缩态的频谱纯度。 ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:0:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"SPDC 产生多模压缩态 SPDC（Spontaneous Parametric Down-Conversion，自发参量下转换）是一种实验上用来产生关联光子对的方法。 将一束激光打到非线性晶体上，如果满足相位匹配条件，则会发生自发参量下转换过程。在这个过程中，一个泵浦光子被转化为两个频率相等的光子，分别称为信号光子（signal photon）和闲频光子（idler photon），且满足能量守恒和动量守恒。其哈密顿量如下： $H = i\\hbar g,a^\\dag_s a^\\dag_i a_p + h.c.$ 其中 $g$ 代表作用强度。 当泵浦光很强，以至于其强度几乎不会被损耗的时候，我们可以只关注信号光子和闲频光子的子希尔伯特空间。此时哈密顿量为： $H = i\\hbar g \\alpha_p ,a^\\dag_s a^\\dag_i + h.c.$ 不失一般性，令 $\\alpha_p$ 为实数，且令 $\\chi=g\\alpha_p$ ，则有 $H = i\\hbar \\chi (a^\\dag_s a^\\dag_i - a_sa_i)$ 实际上，由于泵浦作用的空间有限，动量会具有不确定性，在频谱上表现为具有一定线宽。此时哈密顿量如下： $\\begin{aligned} H=i\\hbar \\chi \\int d\\omega_s d\\omega_i [f(\\omega_s,\\omega_i) a_s^\\dag(\\omega_s) a_i^\\dag(\\omega_i) -f^*(\\omega_s,\\omega_i) a_s(\\omega_s) a_i(\\omega_i)] \\end{aligned}$ 现在我们用 $L^2(\\mathbb{R^2})$ 的一组正交基函数（例如 Hermite 函数） ${\\varphi_k}_{k\\in \\mathbb{N}}$ 将 $f(\\omega_s,\\omega_i)$ 展开： $\\begin{aligned} f(\\omega_s,\\omega_i)=\\sum_{k,l} C_{kl}\\varphi_k(\\omega_s)\\varphi_l(\\omega_i) \\end{aligned}$ 并且记 $a_k^\\dag = \\int d\\omega_s ,\\varphi_k(\\omega_s)a_s^\\dag(\\omega_s),\\quad b_k^\\dag = \\int d\\omega_i ,\\varphi_k(\\omega_i) a_i^\\dag(\\omega_i)$ ，则有 $\\begin{aligned} H=i\\hbar \\chi \\sum_{k,l}\\left( C_{kl}a^\\dag_k b^\\dag_l - C^*_{kl} a_kb_l\\right) \\end{aligned}$ 对其进行施密特分解（奇异值分解），得 $\\begin{aligned} H=i\\hbar \\chi \\sum_{k}\\left( \\lambda_k A^\\dag_k B^\\dag_k - \\lambda_k A_k B_k\\right) \\end{aligned}$ 其中 $\\sum_k\\lambda^2_k=1$ 。 注意：由于奇异值分解的谱总是非负实数，所以 $\\lambda_k$ 是实数且大于零。 这其实就是多模压缩态的哈密顿量。 复习一下各种压缩态： 单模压缩态： $\\begin{aligned} H=i\\hbar\\left(g^*\\frac{a^2}{2}-g\\frac{a^{\\dag2}}{2}\\right) \\end{aligned}$ 双模压缩态： $\\begin{aligned} H=i\\hbar\\left(g^*a b-g a^\\dag b^\\dag\\right) \\end{aligned}$ 多模压缩态： $\\begin{aligned} H=i\\hbar\\sum_{k}\\left(g_k^*a_k b_k-g_k a_k^\\dag b_k^\\dag\\right) \\end{aligned}$ 现在我们分别来看看薛定谔绘景与海森堡绘景下的系统演化。 在薛定谔绘景下， $\\begin{aligned} |\\Psi_{\\text{out}}\\rangle \u0026=e^{\\frac{H\\tau}{i\\hbar}}|\\Psi_{\\text{in}}\\rangle \\\\ \u0026= \\sum_{k} \\frac{1}{\\cosh(r_k)}\\sum_{n=0}^{\\infty}\\tanh^n(r_k)|n_k,n_k\\rangle \\end{aligned}$ 其中 $r_k=\\chi \\tau \\lambda_k$ 。注意到它拥有热光场的形式。 当 $r_k$ 很小时，有 $|\\Psi_{\\text{out}}\\rangle\\approx \\sum_{k} \\left(|0_k,0_k\\rangle + r_k|1_k,1_k\\rangle\\right)$ 这也是大多数实验所符合的情况。 在探测到光子的前提下，条件量子态（Conditional State）为 $|\\Psi_\\text{conditional}\\rangle=\\sum_k\\lambda_k|1_k,1_k\\rangle$ 。这就是预报式单光子源的原理。 在海森堡绘景下， $\\begin{aligned} A_k \u0026\\rightarrow e^{\\frac{H\\tau}{i\\hbar}} A_k e^{-\\frac{H\\tau}{i\\hbar}} \\\\ \u0026= A_k + [e^{\\frac{H\\tau}{i\\hbar}},A_k]+[e^{\\frac{H\\tau}{i\\hbar}},[e^{\\frac{H\\tau}{i\\hbar}},A_k]] + \\cdots \\\\ \u0026=\\cosh(r_k) A_k - \\sinh(r_k)B_k^\\dag \\end{aligned}$ $\\begin{aligned} B_k \u0026\\rightarrow e^{\\frac{H\\tau}{i\\hbar}} B_k e^{-\\frac{H\\tau}{i\\hbar}} \\\\ \u0026= B_k + [e^{\\frac{H\\tau}{i\\hbar}},B_k]+[e^{\\frac{H\\tau}{i\\hbar}},[e^{\\frac{H\\tau}{i\\hbar}},B_k]] + \\cdots \\\\ \u0026=\\cosh(r_k) B_k - \\sinh(r_k)A_k^\\dag \\end{aligned}$ 其中 $r_k=\\chi \\tau \\lambda_k$ 。 ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:1:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"如何刻画频谱关联？ 频谱关联指的是信号光子和闲频光子的频谱之间的关联。一个无关联的联合频谱可以写成两个光子各自频谱的乘积： $f(\\omega_s,\\omega_i)=\\phi(\\omega_s)\\psi(\\omega_i)$ 。如果不能写成这个形式，就意味着有频谱关联。 具体如何刻画频谱关联呢？我们可以用施密特数来刻画频谱的关联程度，其定义如下： $\\begin{aligned} K= \\frac{1}{\\sum_k\\lambda^4_k} \\end{aligned}$ 例 对于无关联的联合频谱，有 ${\\lambda_k}={1}$ ， $K=1$ 。 对于有两个模式，且系数相等的联合频谱，有 ${\\lambda_k}={\\frac{1}{2},\\frac{1}{2}}$ ， $K=2$ 。 对于有 n 个模式，且系数相等的联合频谱，有 $K=n$ 。 对于有 n 个模式，且系数彼此不完全相等的联合频谱，有 $1\u003cK\u003cn$ 。 为什么我们会关心频谱关联？这是因为它和光子的纯度有密切的关系： 性质 在 $r_k$ 很小，且探测到光子的前提下，量子态为 $|\\Psi_\\text{conditional}\\rangle=\\sum_k\\lambda_k|1_k,1_k\\rangle$ 。 对于该量子态，将两个光子中的其中一个 trace 掉（做偏迹运算），剩下光子的量子态的纯度为 $P=\\frac{1}{K}$ 。这是因为： $\\begin{aligned} P \u0026= \\operatorname{tr}[\\operatorname{tr}_2[|\\psi\\rangle\\langle\\psi|]^2] \\\\ \u0026= \\operatorname{tr}\\left[\\operatorname{tr}_B\\left(\\sum_{k}\\lambda_k \\left| 1_k, 1_k\\right\\rangle\\sum_{l}\\lambda_l \\left\\langle 1_l ,1_l\\right|\\right)^2\\right] \\\\ \u0026= \\operatorname{tr}\\left[\\left(\\sum_{k}\\lambda_k^2 \\left|1_k \\right\\rangle\\left\\langle 1_k\\right|\\right)^2\\right] \\\\ \u0026= \\operatorname{tr}\\left[\\sum_{k}\\left(\\lambda_k^2\\left| 1_k \\right\\rangle\\left\\langle 1_k\\right|\\right)^2\\right] \\\\ \u0026= \\operatorname{tr}\\left[\\sum_{k}\\lambda_k^4 |1_k\\rangle\\langle 1_k|\\right] \\\\ \u0026=\\sum_{k}\\lambda_k^4=\\frac{1}{K} \\end{aligned}$ 可见，纯度与施密特数呈反比关系。也就是说，频谱关联越强，光子在频域上的纯度越低。这对预报式单光子源以及各种多光子干涉实验是不利的。对于前者，频谱关联会降低单光子的频域全同性，对于后者，频谱关联会降低干涉对比度。 ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:2:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"用 HBT 实验测量频谱关联 在上一篇中，我们说到 HBT 实验探测的是： $\\begin{aligned} \\frac{C_{12}R}{S_1S_2}=\\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} \\end{aligned}$ 其中 $C_{12}$ 是两个探测器的符合计数率， $S_1$ 和 $S_2$ 分别是第一个和第二个探测器的计数率， $R$ 是光子通量。 当各个模式的频率相同或相近时，有 $\\begin{aligned} \\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} \\approx g^{(2)}(0) \\end{aligned}$ 。 我们之所以说用 HBT 实验可以测量频谱关联，是因为 $\\begin{aligned} \\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} = 1+\\frac{1}{K} \\end{aligned}$ 。证明如下： $\\begin{aligned} \\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} \u0026=\\frac{\\langle n^2\\rangle-\\langle n\\rangle}{\\langle n\\rangle^2} \\\\ \u0026=\\frac{\\sum_{k} \\langle n_k^2 \\rangle + 2\\sum_{i\u003ej} \\langle n_i n_j \\rangle - \\langle n\\rangle}{\\langle n\\rangle^2} \\\\ \u0026= \\frac{ \\sum_{k} \\left(\\langle n_k \\rangle + 2\\langle n_k\\rangle^2 \\right) + 2\\sum_{i\u003ej} \\langle n_i \\rangle \\langle n_j \\rangle - \\langle n\\rangle}{\\langle n\\rangle^2} \\\\ \u0026= \\frac{\\langle n\\rangle + \\langle n\\rangle^2 +\\sum_{k} \\langle n_k\\rangle^2 - \\langle n\\rangle}{\\langle n\\rangle^2} \\\\ \u0026= 1+\\frac{\\sum_{k} \\langle n_k\\rangle^2}{ \\left\\langle \\sum_{k} n_k\\right\\rangle^2} \\\\ \u0026= 1 + \\frac{\\sum_k \\sinh^4(r_k)}{\\left(\\sum_k \\sinh^2(r_k)\\right)^2} \\\\ \u0026\\approx 1+\\frac{\\sum_k r_k^4}{\\left(\\sum_k r_k^2\\right)^2} \\\\ \u0026= 1 + \\frac{\\sum_k \\lambda_k^4}{\\left(\\sum_k \\lambda_k^2\\right)^2} \\\\ \u0026= 1+\\sum_k \\lambda_k^4 \\\\ \u0026= 1+\\frac{1}{K} \\\\ \u0026= 1+P \\end{aligned}$ 其中第三个等号用到了结论：对于热光场有 $ \\langle n_k^2 \\rangle =\\langle n_k \\rangle + 2\\langle n_k\\rangle^2$ ，且各个模式之间没有关联 $\\langle n_i n_j\\rangle=\\langle n_i\\rangle\\langle n_j\\rangle$ 。 第六个等号是因为在海森堡绘景下有： $\\begin{aligned} \\langle n_k\\rangle\u0026=\\langle 0|A_k^\\dag A_k|0\\rangle \\\\ \u0026\\rightarrow\\langle 0| (\\cosh(r_k) A_k^\\dag - \\sinh(r_k)B_k)(\\cosh(r_k) A_k - \\sinh(r_k)B_k^\\dag)|0\\rangle \\\\ \u0026= \\sinh^2(r_k) \\end{aligned}$ ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:3:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"结论 借助 HBT 实验，我们就能测量频谱关联和纯度，这不得不说是一件很神奇的事情。因为普通的方法需要用到 tunable filter 来测 JSI（Joint Spectral Intensity），再根据 JSI 计算频谱关联和纯度。而 HBT 实验甚至连 filter 都不需要，可见 HBT 实验的优越性。 ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:4:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"注 关于以上推导我能找到最早的文献是 [1]，但是文献 [1] 中跳了太多步骤，中间的逻辑链是我自己一点一点补上的。 利用 HBT 实验测频谱关联的文献见 [2] 和 [3]，它们引用的都是文献 [1]。 ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:5:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"参考文献 [1] Christ, A., Laiho, K., Eckstein, A., Cassemiro, K. N. \u0026 Silberhorn, C. Probing multimode squeezing with correlation functions. New J. Phys. 13, 033027 (2011). [2] Faruque, I. I. et al. Estimating the Indistinguishability of Heralded Single Photons Using Second-Order Correlation. Phys. Rev. Applied 12, 054029 (2019). [3] Paesani, S. et al. Near-ideal spontaneous photon sources in silicon quantum photonics. Nat Commun 11, 2505 (2020). ","date":"2024-02-05","objectID":"/hbt_spectral_correlation/:6:0","tags":["量子光学"],"title":"【量光实验杂谈·二】HBT实验测量SPDC多模压缩态的频谱关联与纯度","uri":"/hbt_spectral_correlation/"},{"categories":["量子信息"],"content":"HBT 实验 做量光实验的小伙伴一定知道 HBT 实验可以用来测二阶关联函数 g2，即将一束光用 50:50 的分束器分成两束，再分别用两个探测器探测，并统计两边光强的关联随延迟的变化，如下图所示： Hanbury Brown and Twiss Experiment 经典 normalized g2 的定义为 $\\begin{aligned} g^{(2)}(r_1,r_2;\\tau)\u0026=\\frac{\\langle E^*(r_1,t)E^*(r_2,t+\\tau) E(r_2,t+\\tau)E(r_1,t)\\rangle}{\\langle |E(r_1,t)|^2\\rangle\\langle |E(r_2,t+\\tau)|^2\\rangle} \\\\ \u0026= \\frac{\\langle I(r_1,t)I(r_2,t+\\tau)\\rangle}{\\langle I(r_1,t)\\rangle\\langle I(r_2,t+\\tau)\\rangle} \\end{aligned}$ 其中 $E$ 代表电场， $I$ 代表光强。可见，根据定义，HBT 实验测量的就是经典 g2（将关联光强除以两边各自的光强的乘积即可）。 ","date":"2024-02-05","objectID":"/hbt_g2/:1:0","tags":["量子光学"],"title":"【量光实验杂谈·一】非光子数分辨探测器测二阶关联函数（g2）的原理","uri":"/hbt_g2/"},{"categories":["量子信息"],"content":"量子二阶光联函数 量子 normalized g2 的定义为： $\\begin{aligned} g^{(2)}(r_1,r_2;\\tau)\u0026=\\frac{\\langle E^-(r_1,t)E^-(r_2,t+\\tau) E^+(r_2,t+\\tau)E^+(r_1,t)\\rangle}{\\langle E^-(r_1,t)E^+(r_1,t)\\rangle\\langle E^-(r_2,t+\\tau)E^+(r_2,t+\\tau)\\rangle} \\end{aligned}$ Comment：对于量子情况，分子里的算符要换成电场的 Counter-rotating Term $E^-$ 和 Co-rotating Term $E^+$ ，它们分别含有产生和湮灭算符。 而且，产生算符一定要在湮灭算符前面，因为一个光子被探测是一个湮灭的过程，这和经典情况不同。经典情况的相干态 $|\\alpha\\rangle$ 是湮灭算符的本征态 $a|\\alpha\\rangle=\\alpha|\\alpha\\rangle$ ，多一个光子少一个光子没有什么区别。 在单模的情况下，由于 $E^+=i\\sqrt{\\frac{\\hbar \\omega}{2\\epsilon_0 V}}a$ ， $E^-=i\\sqrt{\\frac{\\hbar \\omega}{2\\epsilon_0 V}}a^\\dag$ ，于是量子 g2 可以化简为 $\\begin{aligned} g^{(2)}(r_1,r_2,\\tau)\u0026=\\frac{\\langle a^\\dag(r_1,t)a^\\dag(r_2,t+\\tau)a(r_2,t+\\tau)a(r_1,t)\\rangle}{\\langle n(r_1,t)\\rangle\\langle n(r_2,t+\\tau) \\rangle} \\end{aligned}$ 于是，为了测量子 g2，我们要把光强探测器换成光子探测器，并且这个光子探测器可以分辨光子数。 然而问题来了，目前可以分辨光子数的单光子探测器都不太行：TES 回复时间太长；空间和时间上 Demultiplex 的方案只是伪光子数分辨；而 SNSPD 又很昂贵，需要低温，且多光子效率也未必很高。 ","date":"2024-02-05","objectID":"/hbt_g2/:2:0","tags":["量子光学"],"title":"【量光实验杂谈·一】非光子数分辨探测器测二阶关联函数（g2）的原理","uri":"/hbt_g2/"},{"categories":["量子信息"],"content":"NPNR-SPD 测 g2 幸运的是，不能分辨光子数的单光子探测器（NPNR-SPD，Non-Photon-Number-Resolving Single-Photon-Detectors）也可以测 g2，即使它们不能分辨光子数！ Comment：所谓“不能分辨光子数”的意思，就是它们只能区分“没有光子”和“有一个或多个光子”两种情况。常见的 APD 探测器就不能分辨光子数。 方法很简单：只要让 NPNR-SPD 的量子效率足够低就可以！ 所谓量子效率 $\\eta$ ，就是在有一个光子进入探测器的前提下，探测器能探测到这个光子的概率。反过来，这个光子被“损耗”掉的概率就是 $1-\\eta$ 。 一开始我觉得很奇怪，怎么会效率越低越好呢？但是只要稍微想一想，就能明白其中原理： 当效率足够低的时候， $k$ 个光子没有全部被损耗掉的概率是 $1-(1-\\eta)^k\\approx k\\eta$ ，也就是说 NPNR-SPD 探测到光子的概率正比于 $k$ 。这样，我们就通过“低效率”变相实现了“光子数分辨”。 下面是正式（无聊）的数学推导，可以跳过： 设探测器 1 的计数率为 $S_1$ ，探测器 2 的计数率为 $S_2$ ，两个探测器的符合（同时探测到光子的）计数率为 $C_{12}$ ，单位时间内光束里的光子数为 $R$ ，则有： $\\begin{aligned} S_i \u0026=R\\sum_{n=1}^{\\infty}\\frac{P_n}{2^n}\\sum_{k=1}^{n}C_n^k[1-(1-\\eta)^k] \\\\ \u0026\\approx R \\sum_{n=1}^{\\infty}\\frac{P_n}{2^n}\\sum_{k=1}^{n}C_n^k\\cdot k\\eta \\\\ \u0026= R\\frac{\\eta}{2} \\sum_{n=1}^{\\infty} n P_n \\end{aligned}$ $\\begin{aligned} C_{12}\u0026=R\\sum_{n=1}^{\\infty}\\frac{P_n}{2^n}\\sum_{k=1}^{n-1} C_n^k[1-(1-\\eta)^k][1-(1-\\eta)^{(n-k)}] \\\\ \u0026\\approx R \\sum_{n=1}^{\\infty}\\frac{P_n}{2^n}\\sum_{k=1}^{n}C_n^k\\cdot k\\eta \\cdot (n-k)\\eta \\\\ \u0026= R \\frac{\\eta^2}{4} \\sum_{n=2}^{\\infty} n(n-1)P_n \\end{aligned}$ 于是 $\\begin{aligned} \\frac{C_{12} R}{S_1 S_2} \u0026= \\frac{\\sum_{n=2}^{\\infty} n(n-1)P_n }{\\left(\\sum_{n=1}^{\\infty} n P_n\\right)^2} \\\\ \u0026= \\frac{\\langle n(n-1) \\rangle}{\\langle n\\rangle^2} \\end{aligned}$ 熟悉量子光学的人应该已经看出这就是 g2 了。推导如下： $\\begin{aligned} g^{(2)}(r_1,r_2,\\tau)\u0026=\\frac{\\langle a^\\dag(r_1,0)a^\\dag(r_2,\\tau)a(r_2,\\tau)a(r_1,0)\\rangle}{\\langle n(r_1)\\rangle\\langle n(r_2) \\rangle} \\end{aligned}$ 令 $r_1=r_2,\\quad \\tau=0$ 得 $\\begin{aligned} g^{(2)}(\\tau=0)\u0026=\\frac{\\langle a^\\dag a^\\dag a a \\rangle}{\\langle n\\rangle^2} \\\\ \u0026= \\frac{\\langle a^\\dag(aa^\\dag -1) a\\rangle}{\\langle n\\rangle^2} \\\\ \u0026= \\frac{\\langle n^2-n\\rangle}{\\langle n\\rangle^2} \\end{aligned}$ 测 g2 有什么用呢？除了教科书里常见的区分【超泊松统计/泊松统计/亚泊松统计】以及区分【光子集聚/反集聚】以外，还有一个意想不到的作用：测量光子的频谱关联。下篇我们就来讨论这一点。 ","date":"2024-02-05","objectID":"/hbt_g2/:3:0","tags":["量子光学"],"title":"【量光实验杂谈·一】非光子数分辨探测器测二阶关联函数（g2）的原理","uri":"/hbt_g2/"},{"categories":["量子信息"],"content":"尾声：多模情况 前面我们埋下了一个小伏笔：我们假设了被探测光是单模的。于是 $E^+$ 可以正比于 $a$ ： $E^+=i\\sqrt{\\frac{\\hbar \\omega}{2\\epsilon_0 V}}a$ 。 但如果被探测光是多模的会如何？此时 $E^+=i\\sum_{k}\\sqrt{\\frac{\\hbar \\omega_k}{2\\epsilon_0 V}}a_k$ ，$E^+$ 不再正比于 $a$ 了，而是有一个频率依赖： $E^+_k\\propto \\sqrt{\\omega_k}a_k$ 。 由于原本的 g2 探测的是光强，而光强等于 频率乘以光子数，因此这里有一项 $\\sqrt{\\omega_k}$ 是不奇怪的。 不过只要各个模式的频率相同，我们还是可以约掉 $\\sqrt{\\omega_k}$ ，得到: $\\begin{aligned} g^{(2)}(0)=\\frac{\\left\\langle :\\left(\\sum_k a^\\dag_k a_k\\right)^2:\\right\\rangle}{\\left\\langle \\sum_k a^\\dag_k a_k\\right\\rangle^2} \\end{aligned}$ 其中 $::$ 代表正规排序，即将所有产生算符都移到湮灭算符的前面。 令 $n=\\sum_ka^\\dag_k a_k$ ，有 $\\begin{aligned} g^{(2)}(0)=\\frac{\\langle n(n-1)\\rangle}{\\langle n\\rangle^2} \\end{aligned}$ 可见，虽然有多个模式存在，但如果这些模式的频率（近似）相同，那么 HBT 实验测量量子 g2 的方法仍然是有效的。 ","date":"2024-02-05","objectID":"/hbt_g2/:4:0","tags":["量子光学"],"title":"【量光实验杂谈·一】非光子数分辨探测器测二阶关联函数（g2）的原理","uri":"/hbt_g2/"},{"categories":["数学物理方法"],"content":"一 性质上的异同点 李导数 $\\mathcal{L}_V$ 和协变导数 $\\nabla_V$ 有很多共同点： $\\mathcal{L}_V$ 和 $\\nabla_V$ 都保持张量的型号，即都是 $\\mathcal{T}^p_q(M)$ 到 $\\mathcal{T}^p_q(M)$ 的映射。 $\\mathcal{T}^p_q(M)$ 表示 $M$ 上全体 (p, q) 型光滑张量场的集合 特别地，对于 (0,0) 型张量场，也就是标量场 $f\\in \\mathcal{F}(M)$ ，有 $\\mathcal{L}_V f=\\nabla_V f=Vf$ 。 都满足线性和莱布尼茨律 $ \\begin{aligned} \\mathcal{L}_V(\\mu A + \\lambda B) \u0026= \\mu \\mathcal{L}_V A + \\lambda \\mathcal{L}_V B, \\\\ \\mathcal{L}_V (A \\otimes B) \u0026= (\\mathcal{L}_V A)\\otimes B + A \\otimes (\\mathcal{L}_V B) \\end{aligned} $ $\\begin{aligned} \\nabla_V(\\lambda A+\\mu B) \u0026= \\lambda \\nabla_V A + \\mu \\nabla_V B \\\\ \\nabla_V(A\\otimes B) \u0026= (\\nabla_V A)\\otimes B + A \\otimes (\\nabla_V B) \\end{aligned}$ 都与缩并可交换 $ \\mathcal{L}_V \\circ C = C \\circ \\mathcal{L}_V $ $ \\nabla_W \\circ C = C \\circ \\nabla_W $ 那它们究竟区别在哪呢？其实最重要的区别如下： 4. 协变导数有对 $V$ 的 $\\mathcal{F}$-线性，而李导数只有普通的线性： $ \\nabla_{fV+gW} = f\\nabla_V + g\\nabla_W \\quad f,g\\in\\mathcal{F}(M) $ $ \\mathcal{L}_{\\lambda V+\\mu W} = \\lambda \\mathcal{L}_V + \\mu \\mathcal{L}_W \\quad \\lambda,\\mu\\in\\mathbb{R}$ 其中 $\\mathcal{F}(M)$ 表示 $M$ 上全体标量场的集合。 这看起来貌似很有趣，但是它意味着什么呢？带着这个问题，我们看下一节。 ","date":"2024-01-26","objectID":"/lie_derivative/:1:0","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":["数学物理方法"],"content":"二 李导数和协变导数的意义 众所周知，导数就是将两点处的对象做差，再取这两点靠近时的极限。但是在流形上，我们会遇到一个问题：不同点处的切空间/余切空间是完全不同的空间，也就是说不同点处的张量根本不在同一个空间中，这样我们就没办法比较不同点处的张量（不能做差了）。 因此，为了比较两个不同的点处的张量，我们必须设法让其中一个点处的张量通过某种方式移动到另外一个点处。有两种办法进行这样的移动，第一种是“流动”，第二种是“平移”。前者对应李导数，后者对应协变导数。 ","date":"2024-01-26","objectID":"/lie_derivative/:2:0","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":["数学物理方法"],"content":"2.1 流动——李导数 前置知识：拉回与推前（pull back / push forward） 假定我们有一个微分同胚： $\\phi:M\\rightarrow N$ 。微分几何的知识告诉我们，可以将 $N$ 上的张量场拉回（pull back）到 $M$ 上。当然，反过来也可以将 $M$ 上的张量场推前（push forward）到 $N$ 上。 $M$ 上一个光滑向量场 $V$ 的积分曲线族（例如电场的电场线）可以给出一个微分同胚 $\\Phi_t:M\\rightarrow M, \\quad \\gamma(t_0)\\mapsto \\gamma(t_0+t)$ 这个微分同胚可以由一个实数 $t$ 来参数化。形象一点理解，就是说流形上的每一点都顺着它所在的积分曲线往下游“流动”了一段距离。于是利用拉回映射（pull back）我们又可以诱导出如下映射： $\\Phi^*_t: \\mathcal{T}^p_q(M) \\rightarrow \\mathcal{T}^p_q(M)$ 这就给出了“将一个点处的张量通过某种方式移动到另外一个点处”的方法： 先让点 $P$ 随着积分曲线往下游“流动”一段距离到点 $Q$ 处，即 $\\Phi_t (P) =Q$ ， 再将点 $Q$ 处的张量通过 $\\Phi^*_t$ 拉回到点 $P$ 处。 即给出了一种将点 $Q$ 处的张量移动到点 $P$ 处的办法。 于是我们就可以定义李导数了： $ \\begin{aligned} \\mathcal{L}_V A \u0026:= \\left.\\frac{\\mathrm{d}}{\\mathrm{d}t}\\right|_{t=0} (\\Phi^*_t A) \\\\ \u0026= \\lim_{t\\rightarrow 0}\\frac{\\Phi^*_\\epsilon A - A}{\\epsilon} \\end{aligned} $ 它的想法是：先让一个点往下游方向流动一小段距离，再把该点处的张量拉回到原来的地方，与原来的点处的张量作比较。如果结果相同，则导数为零，否则导数不为零。 注：其实把 $\\Phi^*_t$ 写成 $(\\Phi^{V}_t)^*$ 会明确一点，即明确了 $\\Phi^*_t$ 是关于 $V$ 的，但是这样写太丑陋了。 ","date":"2024-01-26","objectID":"/lie_derivative/:2:1","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":["数学物理方法"],"content":"2.2 平移——协变导数 李导数的“将一点处的张量移动到另一点”的方法总还是让人感觉有些别扭。这是因为，为了将点 $Q$ 处的向量通过某一条路径移动到点 $P$ ，我们需要找到这样一个向量场，使得它有一条积分曲线与该路径重合。这并总不是很方便。 更致命的是，即使两个不同的向量场有一条完全重合的积分曲线——即便如此，移动的结果也不一定是相同的。 即，$(\\Phi^{V}_{Q\\rightarrow P})^*$ 与 $(\\Phi^{W}_{Q\\rightarrow P})^*$ 一般是不同的，即使路径完全相同。 换句话说，某点的关于向量场 V 的李导数依赖于 V 在该点邻域的性质。这就是我们为什么说“协变导数有对 $V$ 的 $\\mathcal{F}$-线性，而李导数没有”。 于是，我们更希望有这样一种办法，使得我们可以直接任意地移动张量，而不需要像李导数那样先找到一条积分曲线。在这种办法中，我们才是规则的制定者——也就是说张量移动的规则由我们来决定，并不需要借助任何向量场的局部结构来完成。 给定了局部坐标系后，这样的一种人为规则可以由一组数据来刻画，这组数据就是克氏符号 $\\Gamma^i_{jk}$ ： $\\nabla_{k} e_j =: \\Gamma^i_{jk}e_i, \\quad \\nabla_i := \\nabla_{e_i}$ $\\Gamma^i_{jk}$ 三个下标意思分别是：$k$ 代表沿第 $k$ 个基的方向移动，$j$ 表示我们在考虑第 $j$ 个基的变化，$i$ 代表变化量在第 $i$ 个基上的分量。 然而，这样一组数据实在是太任意了：对于一个 $n$ 维流形，我们需要给定 $n^3$ 个数，才能将克氏符号确定下来。 为了确定起见，我们可以借助流形上的额外结构——度规。我们希望协变导数是保度规的，即满足 $ \\nabla_k g_{ij}=0 $ ，这可以给出 $n^2(n+1)/2$ 个约束，还剩下 $n^3-n^2(n+1)/2=n^2(n-1)/2$ 个自由度。 我们还可以通过要求协变导数无挠，来给出剩下 $n^2(n-1)/2$ 个约束，从而消除了任意性，得到了一个唯一的联络。这就是 Riemann / Levi-Citiva 联络。 这样一来，我们可以利用协变导数为零，反过来定义“平移”。 正因为平移的规则是人为指定，所以协变导数不依赖向量场的邻域，因而协变导数有对 $V$ 的 $\\mathcal{F}$-线性。 ","date":"2024-01-26","objectID":"/lie_derivative/:2:2","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":["数学物理方法"],"content":"2.3 回到李导数 当然，这不是说李导数一无是处。李导数的意义并不在于用来移动张量，而是在于刻画“流”的性质。例如，可以用李导数对单位体积形式的作用来定义散度： $\\begin{aligned} \\mathcal{L}_V \\omega_g =: (\\operatorname{div} V)\\omega_g \\end{aligned}$ 几何意义也很明显：如果我们让流形上的一小块体积随着向量场的积分曲线流动一小段距离，这一小块体积的缩放比率就是向量场在该点处的散度。 李导数使得对很多概念的定义都有了一套更优雅的语言。如果散度不用李导数来定义，那么就只能定义成 $\\operatorname{div} V = \\star_g \\mathrm{d} \\star_g \\flat_g V$ ，涉及了升降算子、霍奇星算子、外微分算子，乍一看不知是什么不可名状之物。 另外，挠率，曲率等等都可以借助李导数来给出漂亮的（且不依赖于局部坐标系的）定义，已有的答案都有提到，本文就不赘述了。 而且，从名字中也可以看出来，李导数与李群李代数有很深的联系。李导数可以用来证明左不变向量场的李括号也是左不变向量场，从而能够诱导出切空间上的李括号，让切空间成为一个李代数。 ","date":"2024-01-26","objectID":"/lie_derivative/:2:3","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":["数学物理方法"],"content":"三 显式公式 最后我们来对比一下李导数和协变导数的显式公式吧： 李导数： $ \\begin{aligned} (\\mathcal{L}_V A)^{i…j}_{k…l} \u0026= V^m A^{i…j}_{k…l,m} + \\\\ \u0026+ V^m_{,k} A^{i…j}_{m…l} + \\cdots + V^m_{,l} A^{i…j}_{k…m} \\\\ \u0026- V^i_{,m}A^{m…j}_{k…l} + \\cdots - V^j_{,m} A^{i…m}_{k…l} \\end{aligned} $ 协变导数： $ \\begin{aligned} (\\nabla_V A)^{i…j}_{k…l} \u0026 = V^{m} A^{i…j}_{k…l,m} \\\\ \u0026 - \\Gamma^{n}_{km} V^{m} A^{i…j}_{n…l} - \\cdots - \\Gamma^{n}_{lm} V^m A^{i…j}_{k…n} \\\\ \u0026 + \\Gamma^{i}_{nm} V^{m} A^{n…j}_{k…l} + \\cdots + \\Gamma^{j}_{nm} V^m A^{i…n}_{k…l} \\end{aligned} $ 式中逗号加下标表示求偏导，即 $A_{,k}:=\\frac{\\partial}{\\partial k}A$ 。 从公式中也可以看出来，某点处的李导数 $\\mathcal{L}_V$ 是依赖于 $V$ 在该点的邻域的性质的，因为它涉及向量场的分量的偏导 $V^m_{,k}$ 。 而在协变导数中，只出现了向量场分量本身 $V^m$ ，不涉及分量的偏导 $V^m_{,k}$ ，也就是说协变导数不依赖于邻域。这就是为什么协变导数拥有 $\\mathcal{F}$-线性，而李导数没有。 ","date":"2024-01-26","objectID":"/lie_derivative/:3:0","tags":["微分几何"],"title":"李导数与协变导数有什么联系？","uri":"/lie_derivative/"},{"categories":null,"content":"分两种情况讨论：物理地址和虚拟地址。 如果说的是物理地址 0x0，那他一点都不孤独，每次复位的时候，程序计数器都会跟他打个招呼： “嘿，哥们，请问复位的中断服务函数怎么走？” “去 0x100000！” “谢了！” 这是因为在大部分架构中，中断向量表都放在物理地址 0x0。而第一个中断就是复位中断。 至于虚拟地址 0x0，由于它没有被映射到任何一个物理地址，那么也就无所谓它所在的物理位置的字节了，更谈不上孤独与否：你不能问一个不存在的人是否孤独。 之所以不让虚拟地址 0x0 对应一个实际存在的物理地址，是为了防止程序员失误，传了一个空指针，然后这个空指针还被翻译到一个真实存在的物理地址了。这样会导致意外访问了程序员本来不想访问的地方。 为了避免程序员失误，现代操作系统干脆就保留 0x0，不让它对应任何一个真实存在的地址。这样程序员写错之后就能马上被操作系统告知自己写错了。 如果绕过了操作系统，强行访问虚拟地址 0x0，多半会报一个 MMU Translation fault 吧。因为 MMU 找不到 0x0 对应的物理地址。这种错误是硬件上的错误，属于致命错误，多半会导致死机或者蓝屏，需要硬件复位才能解决。 当然，一般人也不会闲到绕过操作系统。此时操作系统会温柔地告诉你出错了，这种错误不会导致死机或者蓝屏。从这里我们可以看出，程序员的岁月静好，离不开操作系统的负重前行。 ","date":"2024-01-26","objectID":"/pointer0/:0:0","tags":null,"title":"0指针不能访问，那那个位置的字节会不会很孤独?","uri":"/pointer0/"},{"categories":["量子信息"],"content":"投影测量 传统意义上的（Von Neumann 意义上的）测量是一系列投影算符。对可观测量所对应的自伴算子进行谱分解 $O=\\sum_i\\lambda_i |\\varphi_i\\rangle\\langle\\varphi_i|$ ，即可得到这些投影算符 $|\\varphi_i\\rangle\\langle\\varphi_i|$ 。这一部分学过初等量子力学的同学都很熟悉。 除了 Von Neumann 测量外，还有一种更加一般的测量，叫做广义测量（Generalized Measurements），或称 POVM（Positive Operator Valued Measure）。 ","date":"2024-01-26","objectID":"/povm/:1:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["量子信息"],"content":"广义测量（Generalized Measurements, POVM） 定义：POVM POVM 是一个映射 $\\mathsf{E}: X \\rightarrow \\mathcal{L}(\\mathcal{H})$ ，满足 $\\mathsf{E}(x) \\ge 0,\\quad \\forall x\\in X$ $\\sum_{x\\in X}\\mathsf{E}(x) = \\mathbb{I}_{\\mathcal{H}}$ 其中 $X$ 代表有限个可能的测量结果的集合， $\\mathcal{L}(\\mathcal{H})$ 代表 $\\mathcal{H}$ 上所有的有界算子的集合。 玻恩规则 对于一个量子态 $\\rho$ 进行 POVM $\\mathsf{E}$ 所给出的测量，结果为 $x$ 的概率为 $p_{\\rho}^{\\mathsf{E}}(x) = \\operatorname{tr}[\\rho \\mathsf{E}(x)]$ 当我第一次看到 POVM 的时候，我并不清楚它是如何实现的。因为传统意义上的测量是一个投影算符，满足 $\\mathsf{E}(x)^2=\\mathsf{E}(x),\\quad \\forall x\\in X$ 。而一般的 POVM 不满足这一条件。 实际上，传统意义上的投影测量也叫做 PVM（Projection Valued Measure），是一类特殊的 POVM。 PVM 之于 POVM，就像纯态之于混合态。也就是说，POVM 是 PVM 的统计混合（statistical mixture），正如混合态是纯态的统计混合。 ","date":"2024-01-26","objectID":"/povm/:2:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["量子信息"],"content":"如何实现 POVM 那么如何实现 POVM 呢？其实我们可以利用 PVM 和复合系统来实现 POVM。 考虑一个系统，其希尔伯特空间为 $\\mathcal{H}$ ，状态为 $\\rho$ 。 接着我们将系统 $\\mathcal{H}$ 和另一个系统 $\\mathcal{K}$ 耦合到一起。假设系统 $\\mathcal{K}$ 的初态为 $\\sigma$ ，于是复合系统的初态为 $\\rho \\otimes \\sigma \\in \\mathcal{H} \\otimes \\mathcal{K}$ 。 然后，我们让复合系统演化一段时间，于是系统状态变为 $U(\\rho\\otimes \\sigma) U^\\dag$ 。 最后，我们对子系统 $\\mathcal{K}$ 进行 PVM $\\mathsf{Z}$ 所给出的测量，根据玻恩规则，得到结果 $x$ 的概率为 $\\operatorname{tr}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ 。 这样，我们就实现了一个 POVM $\\mathsf{E}$ ，满足 $\\operatorname{tr}[\\rho \\mathsf{E(x)}]=\\operatorname{tr}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ 。 ","date":"2024-01-26","objectID":"/povm/:3:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["量子信息"],"content":"测量模型（Measurement Model） 我们整理一下上面实现 POVM 所涉及到的物理对象：辅助（ancilla）系统 $\\mathcal{K}$ ，系统 $\\mathcal{K}$ 的初态 $\\sigma$ ，复合系统的演化 $U$ ，以及对辅助系统的投影测量 $\\mathsf{Z}$ 。这些物理对象实现了一个 POVM 测量。 于是我们可以定义 $\\mathfrak{M}=(\\mathcal{K},\\sigma,U,\\mathsf{Z})$ ，并称之为一个测量模型（Measurement Model）。 在实际实验中，辅助（ancilla）系统 $\\mathcal{K}$ 可以看作是仪器的探针，而 $\\mathsf{Z}$ 就是对探针进行读数。 ","date":"2024-01-26","objectID":"/povm/:4:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["量子信息"],"content":"测量后的状态 POVM 本身不能决定测量后的状态。真正决定测量后的状态的是测量的具体实现，即测量模型。 对于测量模型 $\\mathfrak{M}=(\\mathcal{K},\\sigma,U,\\mathsf{Z})$ ，测量后系统 $\\mathcal{H}$ 的状态为 $\\rho_x=\\operatorname{tr}_{\\mathcal{K}}[U(\\rho\\otimes \\sigma) U^\\dag(\\mathbb{I}_{\\mathcal{H}}\\otimes \\mathsf{Z(x)})]$ ，其中 $\\operatorname{tr}_{\\mathcal{K}}[\\cdot]$ 表示取偏迹。 ","date":"2024-01-26","objectID":"/povm/:5:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["量子信息"],"content":"量子仪器（Quantum Instruments） POVM 给出了各个测量结果的概率，却没有给出测量后的状态。于是我们希望找到一个数学对象，能将测量概率和测量后的状态都包括进来。这个数学对象叫做 Quantum Instrument。 定义 Quantum Instrument 称 $\\mathcal{I}_{x}: \\mathcal{I}_{x}(\\rho) = \\rho_x$ 为一个 Quantum Instrument，如果 $\\operatorname{tr}\\left[\\sum_{x\\in X} \\rho_x \\right]=\\operatorname{tr}[\\rho]=1$ 。 可以看出， $\\mathcal{I}_x$ 不仅给出了测量的概率 $p_x=\\operatorname{tr}[\\rho_x]$ ，还给出了测量后的状态 $\\frac{\\rho_x}{\\operatorname{tr}[\\rho_x]}$ 。 显然，同一个 POVM 对应无数个 Quantum Instrument。 那么对于任意一个 Quantum Instrument，我们是否总是可以实现它？答案是肯定的。 定理 给定任意一个 Quantum Instrument，我们总是能找到一个 Measurement Model 来实现它（实际上有无数个）。证略。 ","date":"2024-01-26","objectID":"/povm/:6:0","tags":["量子测量理论"],"title":"广义量子测量：POVM 简介","uri":"/povm/"},{"categories":["日常"],"content":" 项目 日期 评论 PYNQ-Z2 + RTL-SDR 收音机 2023.06 是 Jupyter Notebook 里的 App，不是独立的 Web App WIFI 天气时钟 2023.01 不会 LvGL。。界面有亿点简陋 光立方 2023.01 只是采购了 BOM 来焊接。。固件不是我写的 康威生命游戏 2022.12 有触摸功能～ ","date":"2023-07-01","objectID":"/side_proj/:0:0","tags":["嵌入式系统"],"title":"做过的一些好玩（但无聊）的小项目","uri":"/side_proj/"},{"categories":["CS"],"content":"先看一段 Jupyter Notebook 中的代码： import time import ipywidgets as widgets from IPython.display import display slider = widgets.IntSlider() display(slider) while True: print(slider.value) time.sleep(1) 运行上面的代码，IntSlider() 会显示一个可交互的滑块小组件。当用户滑动滑块时，它的值应当改变，变化的值应当可以在 while 循环内打印出来。 然而，如果你实际运行上面这段代码，你会发现打印的滑块值不会有任何改变，一直是初始值。 实际上，只有在所有代码块运行完成之后，滑块的值才会开始更新。在那之前，UI 组件的更新会被运行中的代码块所阻塞。 为了在循环里拉取 UI 组件的值，可以使用 jupyter-ui-poll 库。改动后的代码如下： import time import ipywidgets as widgets from IPython.display import display from jupyter_ui_poll import ui_events slider = widgets.IntSlider() display(slider) while True: with ui_events() as poll: poll(1) # poll one event print(slider.value) time.sleep(1) 这段代码每隔 1 秒钟拉取（poll）一次 UI 组件的状态，从而实现想要的功能。 下面是一段应用示例，可以与 python 异步编程结合使用： import nest_asyncio nest_asyncio.apply() import asyncio from jupyter_ui_poll import ui_events from pyrtlsdr import RtlSdr sdr = RtlSdr() sdr.center_freq = 92_700_000 # an FM radio station running at 92.7MHz async def streaming(): it = 0 async for data in sdr.stream(): # perform FM demodulation audio = fm_demodulation(data) # poll UI events with ui_events() as poll: poll(10) sdr.center_freq = slider.value # play the audio display(Audio(audio, autoplay=True, rate=48000, normalize=False)) it = it + 1 if it == it_num: break slider = widgets.IntSlider() display(slider) asyncio.run(streaming()) 上面这段代码模拟了一个 FM 收音机。 ","date":"2023-06-30","objectID":"/ui_poll/:0:0","tags":["Python","Jupyter Notebook"],"title":"运行时拉取 Jupyter Widgets UI 组件的状态","uri":"/ui_poll/"},{"categories":["EECS"],"content":"1 基础 SPI 有三线模式和四线模式。三线模式有 SS（Slave Select）, SCK（SPI Clock）, MOSI（Master-Out-Slave-In）三条线。四线模式多了一条 MISO（Master-In-Slave-Out）。 信号 全称 功能 SS Slave Select 片选 SCK SPI Clock 时钟信号 MOSI Master-Out-Slave-In 主器件向从器件发送指令和数据 MISO Master-In-Slave-Out 从器件向主器件返回数据 SPI 的时钟有四种模式，分别对应 CPOL=0/1 和 CPHA=0/1。CPOL（Clock Polarity）代表时钟信号在空闲的时候是高还是低；CPHA（Clock Phase）代表在时钟信号相位为 0 度还是 180 度的时候读取数据。 ","date":"2023-06-29","objectID":"/spi/:0:1","tags":["SPI","嵌入式系统"],"title":"AXI SPI IP 核的软硬件设计","uri":"/spi/"},{"categories":["EECS"],"content":"2 AXI Quad SPI IP 核 当 Zynq PS 的 SPI 控制器不够用，或者因为其他原因（例如 MIO 被占用）而无法使用的时候，可以在 PL 端使用 SPI 控制器的 IP 核，叫做 AXI Quad SPI。 本文只涉及 Standard Mode + Master Mode，不涉及 Dual/Quad Mode 以及 Slave Mode / Multi-master Mode。 AXI Quad SPI IP 核 在上图中， io1_i 连接 MISO 信号；ext_spi_clk 和 s_axi_clk 都连接同一个系统时钟即可。ip2intc_irpt 可以连接 Zynq 的中断 pl_ps_irq。 可以双击 IP 核配置时钟分频、片选信号个数等等。 ","date":"2023-06-29","objectID":"/spi/:0:2","tags":["SPI","嵌入式系统"],"title":"AXI SPI IP 核的软硬件设计","uri":"/spi/"},{"categories":["EECS"],"content":"3 裸机编程 编程顺序如下 首先，初始化 SPI 控制器。将各个寄存器的值恢复到默认状态。 其次，根据使用场景，配置 SPI 控制器，例如时钟模式的 CPHA 和 CPOL、片选模式为自动还是手动等等。 再次，根据需要读写的字节数，向数据发送寄存器（DTR，Data Transmit Register）中写入相应数量的字节。每写入一个字节，该字节都会被压到 TX FIFO 中。 注意，假设发送的字节数为 n_tx，接收的字节数为 n_rx，那么不仅要向 DTR 写入 n_tx 个发送的字节，还要再写入 n_rx 个 “dummy” 字节。这是因为 SPI 本质上是一种全双工的协议：为了接收 n_rx 个数据，编程人员也必须要发送 n_rx 个数据。 最后，从数据接收寄存器（DRR，Data Receive Register）中依次读取字节。每读取一个字节，该字节就会从 RX FIFO 出队。 注意，根据场景，编程人员在接收数据时可能需要丢弃前 n_tx 个数据。这是因为在主器件发送指令/数据时，从器件可能还没有做出相应，而是要等到前 n_tx 个数据都发送完成之后才会返回有效的数据。而由于 SPI 的全双工特性，前 n_tx 个无效数据同样会被压入 RX FIFO，因此需要丢弃这些数据。 如果采用手动片选模式，需要在收发数据之前手动下拉片选信号，并在收发数据之后手动上拉片选信号。 下述代码向 Slave 发送了 [0x00 0x37] 两个字节，并从 Slave 读取一个字节。 #include \"xspi.h\" // axi quad spi #include \"xparameters.h\" #include \"xstatus.h\" #include \"xplatform_info.h\" #include \"xil_printf.h\" #include \"sleep.h\" #define SPI_DEVICE_ID XPAR_SPI_0_DEVICE_ID #define SPI_BASEADDR XPAR_SPI_0_BASEADDR XSpi Spi; int main() { /* * SPI Initialize */ XSpi_Config *spi_config_ptr; spi_config_ptr = XSpi_LookupConfig(SPI_DEVICE_ID); if (spi_config_ptr == NULL) { return XST_DEVICE_NOT_FOUND; } status = XSpi_CfgInitialize(\u0026Spi, spi_config_ptr, spi_config_ptr-\u003eBaseAddress); if (status != XST_SUCCESS) { return XST_FAILURE; } // Start the SPI driver so that the device is enabled. XSpi_Start(\u0026Spi); // Disable Global interrupt to use polled mode operation XSpi_IntrGlobalDisable(\u0026Spi); /* * 1. Enable master mode. * 2. CPHA = 1, CPOL = 0 * 3. Manual Slave Select * 4. TX/RX FIFO Reset */ u32 control; control = XSpi_ReadReg(SPI_BASEADDR, XSP_CR_OFFSET); control |= XSP_CR_MASTER_MODE_MASK | // Master Mode XSP_CR_CLK_PHASE_MASK | // Clock Phase XSP_CR_MANUAL_SS_MASK | // Manual Slave Select XSP_CR_TXFIFO_RESET_MASK| // TX FIFO Reset XSP_CR_RXFIFO_RESET_MASK // RX FIFO Reset ; XSpi_WriteReg(SPI_BASEADDR, XSP_CR_OFFSET, control); // write [0x00 0x37] and then read one byte XSpi_WriteReg(SPI_BASEADDR, XSP_DTR_OFFSET, 0x00); XSpi_WriteReg(SPI_BASEADDR, XSP_DTR_OFFSET, 0x37); XSpi_WriteReg(SPI_BASEADDR, XSP_DTR_OFFSET, 0x00); /* * SPI write */ XSpi_WriteReg(SPI_BASEADDR, XSP_SSR_OFFSET, 0xE); // slave select // 0xE: 0b1110 // initiate a transfer control = XSpi_ReadReg(SPI_BASEADDR, XSP_CR_OFFSET); control |= XSP_CR_ENABLE_MASK; control \u0026= ~XSP_CR_TRANS_INHIBIT_MASK; XSpi_WriteReg(SPI_BASEADDR, XSP_CR_OFFSET, control); /* * SPI read */ // wait for the transmit FIFO to be empty while (!(XSpi_ReadReg(SPI_BASEADDR, XSP_SR_OFFSET) \u0026 XSP_SR_TX_EMPTY_MASK)); control = XSpi_ReadReg(SPI_BASEADDR, XSP_CR_OFFSET); control |= XSP_CR_TRANS_INHIBIT_MASK; XSpi_WriteReg(SPI_BASEADDR, XSP_CR_OFFSET, control); // read data receive register while ((XSpi_ReadReg(SPI_BASEADDR, XSP_SR_OFFSET) \u0026 XSP_SR_RX_EMPTY_MASK) == 0) { data = XSpi_ReadReg(SPI_BASEADDR, XSP_DRR_OFFSET); } // we know (in advance) that the slave will return one byte, so we know this loop will be executed three times. // slave de-select XSpi_WriteReg(SPI_BASEADDR, XSP_SSR_OFFSET, 0xF); // 0xF: 0b1111 xil_printf(\"MISO: 0x%x\\n\\r\", data); return 0; } ","date":"2023-06-29","objectID":"/spi/:0:3","tags":["SPI","嵌入式系统"],"title":"AXI SPI IP 核的软硬件设计","uri":"/spi/"},{"categories":["EECS"],"content":"4 Linux 编程 为了在 Linux 中使用 AXI Quad SPI IP 核，需要在 Linux 设备树中添加一个 spidev 节点，从而允许通过读写 /dev/spidevx.y 文件来读写 SPI。 在 /dev/spidevx.y 中，x 代表第 x 个 SPI 控制器，y 代表第 y 个片选。如果使用 PS SPI，那么设备名可能为 /dev/spidev0.0；如果使用 PL SPI（AXI SPI），则设备名可能为 /dev/spidev1.0。 设备树通常在启动时被 U-Boot 加载好，并且不可修改。但是 4.14 版本之后的 Linux 内核增加了对 device tree overlay（以下简称 DTO）的支持。DTO 允许在运行时动态加载新的设备树。下面是一段 DTO 的源码： /dts-v1/; /plugin/; / { fragment@0 { target = \u003c\u0026amba\u003e; overlay0: __overlay__ { axi_quad_spi_0: axi_quad_spi@80000000 { ... status = \"okay\"; #address-cells = \u003c1\u003e; #size-cells = \u003c0\u003e; spidev0: spidev@0 { compatible = \"spidev\"; reg = \u003c0\u003e; spi-max-frequency = \u003c5000000\u003e; }; }; }; }; }; 有几个值得注意的点： 需要在 /dts-v1/; 后面增加一行 /plugin/; 来表示这是一个 Device Tree Overlay 而不是普通的 Device Tree。ADI 的 recipes-bsp 就是通过观察文件中是否包含 /plugin/; 来判断设备树是否是 Overlay。 target 表示修改哪一个节点。这里是 \u003c\u0026amba\u003e，它会被扩展为符号为 amba 的节点的 phandle。例如，如果 amba 节点的 phandle 为 70，那么 \u003c\u0026amba\u003e 实际上代表 \u003c70\u003e。一个 phandle 唯一标识了一个节点，往往是由编译器（dtc）分配的。 往往需要增加编译选项 -@。该选项启用符号功能，从而允许通过符号对设备树节点进行引用。否则，只能通过 phandle 的绝对值来引用。为了查看 phandle 的绝对值，需要对设备树二进制进行反编译。 通过 DTO 增加 spidev 节点后，在 /dev 文件夹下就会多出一个 /dev/spidev1.0 文件。可以通过读写该文件来进行 SPI 通信。可以用 ioctl 来实现。 ","date":"2023-06-29","objectID":"/spi/:0:4","tags":["SPI","嵌入式系统"],"title":"AXI SPI IP 核的软硬件设计","uri":"/spi/"},{"categories":["EECS"],"content":" 给从今年三月到现在断断续续的工作做一个总结 ","date":"2023-06-25","objectID":"/work_2023_3-6/:0:0","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"1 RTL-SDR \u0026 PYNQ-Z2 ","date":"2023-06-25","objectID":"/work_2023_3-6/:1:0","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"1.1 现有工作 这个工作是将 RTL-SDR 通过 USB2.0 与 PYNQ-Z2 连接来配合使用。RTL-SDR 将射频信号下变频为基带信号；PYNQ-Z2 通过 USB2.0 接口接收 RTL-SDR 返回的基带信号，并使用 FPGA 进行信号处理。最后，可以在 PYNQ Jupyter Notebook 中实现一个简单的 FM 收音机的网页应用。 PYNQ-Z2 + RTL-SDR 详情见 github 仓库 视频展示 ","date":"2023-06-25","objectID":"/work_2023_3-6/:1:1","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"1.2 可能的改进 在 Jupyter Notebook 中用滑块小组件进行调谐，会有些卡顿。如果将更多的 CPU 操作 offload 到 FPGA，就可以减轻 CPU 压力，从而减少卡顿。 ","date":"2023-06-25","objectID":"/work_2023_3-6/:1:2","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"2 AD9361 + PYNQ 内核 ","date":"2023-06-25","objectID":"/work_2023_3-6/:2:0","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"2.1 现有工作 这个工作基本上来说就是通过 Petalinux 将 PYNQ 和 AD9361 的驱动构建到同一个内核中。国内 MicroPhase 做过这个工作，但并未使用 FPGA 进行数据处理。 在 ZedBoard 上，2019_R1 + PYNQ v2.4 版本可以成功。启星和我在这个链接中总结了构建的步骤以及各种可能的问题和解决办法。 在 PYNQ-ZU 上，由于 PYNQ-ZU 的 BSP 只有 PYNQ v2.7 及以后的版本，而 PYNQ v2.7 需要配合 2020 年版本的工具链，并且在该版本遇到了一些问题（见 2.2.1 节），因此没有成功。 ","date":"2023-06-25","objectID":"/work_2023_3-6/:2:1","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"2.2 遇到的问题 2.2.1 ADI 的 Yocto Layer 与 PYNQ 不兼容 2019 年之后的版本的 meta-adi 的 recipes-bsp 会覆盖掉 PYNQ 的 recipes-bsp 所引入的修改。 如下是文件 meta-adi-xilinx/recipes-bsp/device-tree/device-tree.bbappend 的一部分： do_configure:append() { ... cp \"${KERNEL_DTB_PATH}/${KERNEL_DTB}.dts\" \"${DT_FILES_PATH}/system-top.dts\" ... } 它直接将 system-top.dts 覆盖掉。而更合适的实践应该是向 system-top.dts 中增加代码（PYNQ 就是这么做的）。 由于这个原因，没有构建出 ADI master branch + PYNQ v3.0.1 的内核。也许可以对 recipes-bsp 做一些修改从而使其与 PYNQ 兼容，但是这个工作搁置了。并且我们有理由搁置这个工作，见下一节（第 2.2.2 节）。 另外，Yocto 官方建议，当使用多个 Yocto Layer 的时候，应该要去 OpenEmbedded Layer Index 和 Yocto Project Compatible Index 查看不同的 Layer 之间是否兼容。不幸的是，这两个 Index 并未收录 meta-pynq 和 meta-adi。 2.2.2 FPGA MANAGER 的问题 meta-adi-xilinx 的文档明确提到了他们没有对 FPGA MANAGER 的官方支持。而如果禁用 FPGA MANAGER，那么就无法在板卡启动之后重载比特流。这让 PYNQ 失去了意义。 我猜 ADI 的想法是将 FPGA 作为一个功能固定的外设，即，设备树和比特流都在系统启动的时候加载好，并且不希望被修改。这与 PYNQ 的想法从根本上是矛盾的。 因此，不建议将 AD9361 和 PYNQ 的驱动集成在一个内核中，而是允许系统启动后动态地加载 AD9361 的设备树和比特流，见下一节（第 3 节）。 ","date":"2023-06-25","objectID":"/work_2023_3-6/:2:2","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"3 User-Space AD9361 驱动 ","date":"2023-06-25","objectID":"/work_2023_3-6/:3:0","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"3.1 已有的工作 为了绕开上一节提到的困难，可以在用户空间中使用 AD9361 驱动，而不是将驱动集成到内核中。但是，为了与 AD9361 的 SPI 接口通信，需要在 Linux 设备树中添加一个 spidev 节点，从而允许通过读写 /dev/spidevx.y 文件来读写 SPI 在 /dev/spidevx.y 中，x 代表第 x 个 SPI 控制器，y 代表第 y 个片选。如果使用 PS SPI，那么设备名可能为 /dev/spidev0.0；如果使用 PL SPI（AXI SPI），则设备名可能为 /dev/spidev1.0。 设备树通常在启动时被 U-Boot 加载好，并且不可修改。但是 4.14 版本之后的 Linux 内核增加了对 device tree overlay（以下简称 DTO）的支持。DTO 允许在运行时动态加载新的设备树。PYNQ 库也提供了 API 来实现这个操作： class pynq.overlay.Overlay(bitfile_name, dtbo=None, download=True, ignore_version=False, device=None, gen_cache=False) 这个 API 不仅允许下载比特流（bitfile_name），而且允许动态增量加载新的设备树（dtbo）。如下是通过 AXI SPI 加入 spidev 的设备树代码： /dts-v1/; /plugin/; / { fragment@0 { target = \u003c\u0026amba\u003e; overlay0: __overlay__ { axi_quad_spi_0: axi_quad_spi@80000000 { ... status = \"okay\"; #address-cells = \u003c1\u003e; #size-cells = \u003c0\u003e; spidev0: spidev@0 { compatible = \"spidev\"; reg = \u003c0\u003e; spi-max-frequency = \u003c5000000\u003e; }; }; }; }; }; 有几个值得注意的点： 需要在 /dts-v1/; 后面增加一行 /plugin/; 来表示这是一个 Device Tree Overlay 而不是普通的 Device Tree。ADI 的 recipes-bsp 就是通过观察文件中是否包含 /plugin/; 来判断设备树是否是 Overlay。 target 表示修改哪一个节点。这里是 \u003c\u0026amba\u003e，它会被扩展为符号为 amba 的节点的 phandle。例如，如果 amba 节点的 phandle 为 70，那么 \u003c\u0026amba\u003e 实际上代表 \u003c70\u003e。一个 phandle 唯一标识了一个节点，往往是由编译器（dtc）分配的。 往往需要增加编译选项 -@。该选项启用符号功能，从而允许通过符号对设备树节点进行引用。否则，只能通过 phandle 的绝对值来引用。 上述文件编译出的 DTO 配合 AXI SPI 是可以正常使用的。这就是启星他们之前的工作。但是，在将子卡从 V3 的 FMC9361_1.0 换成 FMCOMMS2/FMCOMMS3 之后，SPI 通信出现了一些问题，见下一节（第 3.2 节）。 ","date":"2023-06-25","objectID":"/work_2023_3-6/:3:1","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"3.2 遇到的问题 3.2.1 SPI 通信问题 AD9361 的 SPI 指令为两个字节，格式为： D15 D14 D13 D12 D11 D10 D9:D0 W/R NB2 NB1 NB0 X X A[9:0] 其中 W/R 代表写还是读（1为写，0为读）； NB2:NB0 代表读写的字节数； A[9:0] 代表寄存器地址。 在发送（写）数据的情况下，要发送的数据要跟在上述两字节的指令之后；在接收（读）数据的情况下，发送指令之后即可开始读取数据。 AD9361 的地址为 0x037 的寄存器中存储了 PRODUCT_ID。对于 AD9361 Rev 2，PRODUCT_ID 应当为 0x0A。 初始化 AD9361 时，驱动先通过 GPIO_RESETB 进行硬件复位（至少 1us），再读取 0x037 寄存器，判断 PRODUCT_ID。 在将 V3 的 FMC9361_1.0（以下简称 V3）换成 FMCOMMS2（以下简称 S2）和 FMCOMMS3（以下简称 S3），并修改了管脚约束之后，SPI 通信出现了问题。 S2/S3 几乎可以看成同一张卡。它们的引脚定义是相同的。 V3 这张卡在网上没有公开的资料。因此希望转向 ADI 官方的 FMCOMMS2/FMCOMMS3 评估板。 具体来说，在 Master（AXI SPI 控制器）向 MOSI 上发送 0x037（读地址为 0x037 的寄存器）之后，Slave（AD9361）并未在 MISO 上发送 0x0A（PRODUCT_ID）。实际情况如下： 子卡 现象 波形 V3 MISO上正确返回0x0A S2 MISO一直为低，因此读到的是0x00 S3 MISO一直为高，因此读到的是0xFF 尝试过 Linux 的 SPI 驱动以及裸机程序，现象相同。 考虑的因素如下： 因素 考虑 管脚约束 再三通过原理图确认过四线 SPI 的 MOSI、MISO、CS 和 CLK 的管脚约束 复位 通过 ILA 确认了 GPIO_RESETB 被拉低了 1ms SPI 模式 确认了 SPI 模式为 0x01（CPOL=0，CPHA=1） SPI 时钟 已经在 Block Design 中将 AXI SPI 的时钟频率设置得很低（10ns 系统时钟的 80 倍分频）。应该可以排除时钟质量问题。 电平标准 在 ZU 的原理图中确认了 VADJ 为 1.8V；VCCO 也为 1.8 V；符合要求。 驱动问题 可以确定不是软件问题，因为 S2/S3 和 V3 用的是同一个驱动程序。 SPI 和硬件复位涉及的管脚\rPYNQ-ZU + FMCOMMS2/3 # pynqzu + fmcomms2/3 set_property -dict {PACKAGE_PIN AG6 IOSTANDARD LVCMOS18 } [get_ports gpio_resetb]; #Bank 64, FMC_LPC_LA28_P set_property -dict {PACKAGE_PIN AG1 IOSTANDARD LVCMOS18 } [get_ports spi_clk]; #Bank 64, FMC_LPC_LA26_N set_property -dict {PACKAGE_PIN AF1 IOSTANDARD LVCMOS18 PULLTYPE PULLUP } [get_ports spi_csn]; #Bank 64, FMC_LPC_LA26_P set_property -dict {PACKAGE_PIN AF3 IOSTANDARD LVCMOS18 } [get_ports spi_miso]; #Bank 64, FMC_LPC_LA27_N set_property -dict {PACKAGE_PIN AE3 IOSTANDARD LVCMOS18 } [get_ports spi_mosi]; #Bank 64, FMC_LPC_LA27_P PYNQ-ZU + V3 (FMC9361_V1.0) # pynqzu + v3 (fmc9361_v1.0) #set_property -dict {PACKAGE_PIN AC9 IOSTANDARD LVCMOS18 } [get_ports gpio_resetb]; # LA23_P #set_property -dict {PACKAGE_PIN AD1 IOSTANDARD LVCMOS18 } [get_ports spi_clk]; # LA18_N #set_property -dict {PACKAGE_PIN AB2 IOSTANDARD LVCMOS18 PULLTYPE PULLUP } [get_ports spi_csn]; # LA19_P #set_property -dict {PACKAGE_PIN AB4 IOSTANDARD LVCMOS18 } [get_ports spi_miso]; # LA20_P #set_property -dict {PACKAGE_PIN AD2 IOSTANDARD LVCMOS18 } [get_ports spi_mosi]; # LA18_P ZCU104 + FMCOMMS2/3 # zcu104 + fmcomms2/3 set_property -dict {PACKAGE_PIN M13 IOSTANDARD LVCMOS18 } [get_ports gpio_resetb]; #Bank 64, FMC_LPC_LA28_P set_property -dict {PACKAGE_PIN B8 IOSTANDARD LVCMOS18 } [get_ports spi_clk]; #Bank 64, FMC_LPC_LA26_N set_property -dict {PACKAGE_PIN B9 IOSTANDARD LVCMOS18 PULLTYPE PULLUP } [get_ports spi_csn]; #Bank 64, FMC_LPC_LA26_P set_property -dict {PACKAGE_PIN A7 IOSTANDARD LVCMOS18 } [get_ports spi_miso]; #Bank 64, FMC_LPC_LA27_N set_property -dict {PACKAGE_PIN A8 IOSTANDARD LVCMOS18 } [get_ports spi_mosi]; #Bank 64, FMC_LPC_LA27_P 总结\r在 ZU + S2/S3 平台上遇到了 SPI 读不到 PRODUCT_ID 的问题。 但是 104/102 + S2/S3 平台可以读到 PRODUCT_ID，这说明问题很可能与 ZU 本身的 FMC 引脚相关。 之所以在 V3 子卡上没有出现这个问题，是因为 V3 和 S2/S3 的 SPI 对应的 FMC 引脚不同。 进一步测试可能需要示波器。 可以暂时放弃 ZU 板卡，而是转向 104 + S2 平台，实现后续的 PYNQ + SDR 应用。 3.2.2 *Device Tree Overlay 问题 在 ZCU102/ZCU104 上加载 Device Tree Overlay (*.dtbo) 没有报错，但并未出现 /dev/spidev1.0 设备。 ZCU102/104 的 Vivado 工程除了管脚约束和芯片型号以外都相同，因此通过 xsa 文件生成的 pl.dtsi 与 ZU 的没有区别。 初步判断原因可能和 dtc 编译器有关（之前似乎遇到过类似的问题，并且是 dtc 版本导致的）。 xsa 生成的 pl.dtsi\r/dts-v1/; /plugin/; / { fragment@0 { target = \u003c\u0026fpga_full\u003e; overlay0: __overlay__ { ... }; }; fragment@1 { target = \u003c\u0026amba\u003e; overlay1: __overlay__ { ... }; }; fragment@2 { target = \u003c\u0026amba\u003e; overlay2: __overlay__ { #address-cells = \u003c2\u003e; #size-cells = \u003c2\u003e; ... axi_quad_spi_0: axi_quad_spi@80000000 { bits-per-word = \u003c8\u003e; clock-names = \"ext_spi_clk\", \"s_axi_aclk\"; clocks = \u003c\u0026zynqmp_clk 71\u003e, \u003c\u0026zynqmp_clk 71\u003e; compatible = \"xlnx,axi-quad-spi-3.2\", \"xlnx,xps-spi-2.00.a\"; fifo-size = \u003c16\u003e; interrupt-names = \"ip2intc_irpt\"; interrupt-parent = \u003c\u0026gic\u003e; interrupts = \u003c0 104 1\u003e; num-cs = \u003c0x1\u003e; reg = \u003c0x0 0x80000000 0x0 0x10000\u003e; xlnx,num-ss-bits = \u003c0x1\u003e; xlnx,spi-mode = \u003c0\u003e; }; ... }; }; }; system.dtso\r/dts-v1/; /plugin/; / { fragment@0 { ","date":"2023-06-25","objectID":"/work_2023_3-6/:3:2","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":["EECS"],"content":"4 总结 项目 结果 问题 PYNQ-Z2 结合 RTL-SDR 使用 实现了一个基于 Jupyter Notebook 的 FM 收音机网页小程序 性能还有提升空间 将 AD9361 的驱动集成到 PYNQ 内核 PYNQ v2.4 + meta-adi 2019_R1 成功 在 2019 年以后的版本中，meta-adi 不支持 FPGA_MANAGER 在用户空间驱动 AD9361 在 V3 子卡上成功实现。硬件部分集成了 FFT 和 FIR 的数据处理 IP 核 在 ZU + S2/S3 平台上遇到了 SPI 读不到 PRODUCT_ID 的问题。但是 104/102 + S2/S3 平台可以读到 PRODUCT_ID，这说明问题很可能与 ZU 本身 FMC 引脚相关。之所以在 V3 子卡上没有出现这个问题，是因为 V3 和 S2/S3 的 SPI 对应的 FMC 引脚不同。进一步测试可能需要示波器。可以暂时放弃 ZU 板卡，而是转向 104 + S2 平台，实现后续的 PYNQ + SDR 应用。 ","date":"2023-06-25","objectID":"/work_2023_3-6/:4:0","tags":["SDR","PYNQ","FPGA","设备树"],"title":"2023 年 3-6 月工作总结","uri":"/work_2023_3-6/"},{"categories":null,"content":" Hansenne, K., Qu, R., Weinbrenner, L. T., de Gois, C., Wang, H., Ming, Y., … \u0026 Gühne, O. (2024). Optimal overlapping tomography. arXiv preprint arXiv:2408.05730. ","date":"2023-06-22","objectID":"/publication/:0:0","tags":null,"title":"Publication","uri":"/publication/"},{"categories":["CS"],"content":"最近做项目用到 Python 协程/异步，现在总结一下： ","date":"2023-06-13","objectID":"/python_asyncio/:0:0","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["CS"],"content":"导入 import asyncio 如果在 IPython 环境里使用，需要加两行： import nest_asyncio nest_asyncio.apply() import asyncio ","date":"2023-06-13","objectID":"/python_asyncio/:1:0","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["CS"],"content":"协程 协程（coroutines）是 Python 异步编程的核心。一个 coroutine 要用 async def 来定义。 async def main(): # do something print(\"Hello world!\") 为了运行它，不能直接调用 main()，而是需要用 run()： asyncio.run(main()) 如何在一个协程里嵌套另一个协程呢？就像我们在一个函数里嵌套另一个函数那样。你需要使用 await 语句： import asyncio async def coro_1(): print(\"I am the coroutine 1.\") async def coro_2(): print(\"I am the coroutine 2.\") async def main(): await coro_1() await coro_2() print(\"Hello World!\") asyncio.run(main()) 协程嵌套在另一个协程里，需要使用 await 来调用。如果直接写成下面这样： async def main(): coro_1() coro_2() print(\"Hello World!\") 则会收到警告如下： 01.py:10: RuntimeWarning: coroutine 'coro_1' was never awaited coro_1() RuntimeWarning: Enable tracemalloc to get the object allocation traceback 01.py:11: RuntimeWarning: coroutine 'coro_2' was never awaited coro_2() RuntimeWarning: Enable tracemalloc to get the object allocation traceback Hello World! 可以看到，coro_1 和 coro_2 并没有被调用。 ","date":"2023-06-13","objectID":"/python_asyncio/:2:0","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["CS"],"content":"任务 如果像上一节那样使用协程，那么协程就失去了它的意义。协程真正有用的地方，在于它们可以并发执行。考虑如下代码： import asyncio async def coro_1(): print(\"I am the coroutine 1.\") async def coro_2(): print(\"I am the coroutine 2.\") async def main(): task_1 = asyncio.create_task(coro_1()) task_2 = asyncio.create_task(coro_2()) await task_1 await task_2 print(\"Hello World!\") asyncio.run(main()) 在这个代码中，我们用 create_task 为 coro_1 和 coro_2 分别创建了任务 task_1 和 task_2。它们实际上是被一起执行的。为了验证这一点，我们加入一些延时： import asyncio import time async def coro_1(): print(\"I am the coroutine 1.\") await asyncio.sleep(1) async def coro_2(): print(\"I am the coroutine 2.\") await asyncio.sleep(1) async def main(): st = time.time() task_1 = asyncio.create_task(coro_1()) task_2 = asyncio.create_task(coro_2()) await task_1 await task_2 et = time.time() print(\"Elapsed: %f s\" % (et - st)) asyncio.run(main()) 运行结果如下： I am the coroutine 1. I am the coroutine 2. Elapsed: 1.001298 s 而如果不使用 create_task，直接 await 两个协程： import asyncio import time async def coro_1(): print(\"I am the coroutine 1.\") await asyncio.sleep(1) async def coro_2(): print(\"I am the coroutine 2.\") await asyncio.sleep(1) async def main(): st = time.time() await coro_1() await coro_2() et = time.time() print(\"Elapsed: %f s\" % (et - st)) asyncio.run(main()) 那么结果如下： I am the coroutine 1. I am the coroutine 2. Elapsed: 2.002527 s 也就是说，如果不使用 create_task 来创建任务，那么 coro_2() 实际上是在 coro_1() 执行完之后才开始被执行的。 从这个例子中我们可以看出，await 真正的意思是“等待任务完成”。 另外，也可以使用 gather 来同时运行两个协程： import asyncio async def coro_1(): print(\"Coroutine 1 starts\") await asyncio.sleep(1) print(\"Coroutine 1 finishes\") async def coro_2(): print(\"Coroutine 2 starts\") await asyncio.sleep(2) print(\"Coroutine 2 finishes\") async def main(): print(\"Starting main coroutine\") await asyncio.gather(coro_1(), coro_2()) print(\"Main coroutine finished\") asyncio.run(main()) ","date":"2023-06-13","objectID":"/python_asyncio/:3:0","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["CS"],"content":"异步循环 现在我们来看看 async for。 import asyncio import time async def async_generator(): for i in range(10): await asyncio.sleep(1) yield i async def custom_coroutine(): async for item in async_generator(): print(item) time.sleep(1) st = time.time() asyncio.run(custom_coroutine()) et = time.time() print(\"Elasped: %f s\" % (et - st)) 运行结果为 0 1 2 3 4 5 6 7 8 9 Elasped: 10.013134 s 将 async for 和 yield 组合使用，可以得到一个异步生成器。实际上，一个异步生成器是定义了 __aiter__ 和 __anext__ 方法的类实例。下面给出与上述代码等价的实现： import asyncio import time class AsyncGenerator: def __init__(self, N): self.i = 0 self.N = N def __aiter__(self): return self async def __anext__(self): i = self.i if i \u003e= self.N: raise StopAsyncIteration await asyncio.sleep(1) self.i += 1 return i async def main(): async for p in AsyncGenerator(10): print(p) st = time.time() asyncio.run(main()) et = time.time() print(\"Elasped: %f s\" % (et - st)) ","date":"2023-06-13","objectID":"/python_asyncio/:3:1","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["CS"],"content":"案例 最后给出一个我在项目中使用到的案例： sdr = RtlSdr() sdr.center_freq = 92_700_000 # an FM radio station running at 92.7MHz async def main(): async for data in sdr.stream(): # perform FM demodulation audio = fm_demodulation(data) # play the audio display(Audio(audio, autoplay=True, rate=48000, normalize=False)) asyncio.run(main()) 这是一个 FM 收音机应用，使用 async for 来从收音机读取数据，然后在 async for 循环内对数据进行解调和播放。以这种方式，我们就能实现对音频数据的实时流处理。 ","date":"2023-06-13","objectID":"/python_asyncio/:4:0","tags":["Python"],"title":"Python 协程/异步IO","uri":"/python_asyncio/"},{"categories":["EECS"],"content":"Windows 在控制面板中设置能上网的网卡，共享给以太网。此时以太网的 IP 会变成 192.168.137.1。 然后在开发板终端中设置网关为 192.168.137.1 即可： sudo route add default gw 192.168.137.1 IP 设置为 192.168.137.x，x 不是 1 和 255（网关地址和广播地址）就行： sudo ifconfig \u003cyour-ifdev\u003e 192.168.3.x 如果还是不行，要检查一下 /etc/resolv.conf 里的 DNS 对不对，可以加一行： nameserver 8.8.8.8 ","date":"2023-06-12","objectID":"/boards_networking/:0:1","tags":["网络","Linux"],"title":"开发板通过 PC 连接互联网","uri":"/boards_networking/"},{"categories":["EECS"],"content":"Ubuntu 在 PC 的网络设置里，将以太网的 IPv4 一栏改为共享方式。此时以太网的 IP 会变成 10.42.0.1（在 Ubuntu Linux 上是这样，其他 Linux 分发版我就不清楚了）。 然后在开发板终端中设置网关为 10.42.0.1 即可： sudo route add default gw 10.42.0.1 IP 设置为同一个子网下的任意一个 IP，只要 IP 的子网部分不是网关地址和广播地址就行： sudo ifconfig 10.42.0.2 如果还是不行，要检查一下 /etc/resolv.conf 里的 DNS 对不对，可以加一行： nameserver 8.8.8.8 ","date":"2023-06-12","objectID":"/boards_networking/:0:2","tags":["网络","Linux"],"title":"开发板通过 PC 连接互联网","uri":"/boards_networking/"},{"categories":["EECS"],"content":"错误排查 先看能不能 ping 通主机。如果不能 ping 通主机，可能是网关没有设置对。 如果能 ping 通主机但是不能 ping 通外网 IP，可能是没有在 PC 里给开发板以太网设置共享，也可能是代理没有设置正确，也可能是网关没有设置对。 如果能 ping 通外网 IP，但是不能 ping 通域名，基本上就是 DNS 配置的问题。 ","date":"2023-06-12","objectID":"/boards_networking/:0:3","tags":["网络","Linux"],"title":"开发板通过 PC 连接互联网","uri":"/boards_networking/"},{"categories":["CS"],"content":"Xilinx 的工具链也太占内存了，有时候会导致系统死机。。毕竟我这个小破本才 8G 内存。没办法，只能加虚拟内存了。 增加了 swapfile 之后就好很多了： sudo swapoff /swapfile sudo dd if=/dev/zero of=/swapfile bs=1M count=16384 sudo mkswap /swapfile sudo swapon /swapfile ","date":"2023-06-12","objectID":"/increase_swapfile/:0:0","tags":["存储/分区","Linux"],"title":"给 Linux 增加 swapfile","uri":"/increase_swapfile/"},{"categories":["EECS"],"content":"为了在 Linux 中给 SD 卡分区和格式化，先将 SD 卡接入 PC，然后在 bash 命令行使用 fdisk 给 SD 卡分区，最后使用 mkfs 给 SD 卡创建文件系统（即格式化）。 主要命令如下： 首先，使用 sudo fdisk -l 确认 SD 卡对应 /dev 中的哪一个设备。 接着，假设我们已经确定 SD 卡对应 /dev/sde，那么我们可以输入 sudo fdisk /dev/sde 来开始分区操作： 输入 d 来删除分区。不断输入，直到所有分区被删除。 输入 n 来创建第一个分区，作为启动分区。 输入 t 来将分区类型改成 W95 FAT32。启动分区一般都是这个类型。。 输入 a 来将分区设置为启动分区。 输入 n 来创建第二个分区，作为根文件系统分区。 由于根文件系统分区类型一般是 Linux，而默认的分区类型正是 Linux，因此无需再输入 t 来改变分区类型。 输入 t 保存退出。 最后，在分好区之后，我们就可以来创建文件系统了： sudo mkfs.vfat -F 32 -n \"BOOT\" /dev/sde1 sudo mkfs.ext4 -L \"rootfs\" /dev/sde2 其中第一行为启动分区创建 FAT32 文件系统，并将其命名为 BOOT；第二行为根文件系统分区创建 ext4 文件系统，并将其命名为 rootfs。 ","date":"2023-06-12","objectID":"/linux_sd_card/:0:0","tags":["存储/分区","Linux"],"title":"在 Linux 中给 SD 卡分区并创建文件系统","uri":"/linux_sd_card/"},{"categories":["CS"],"content":"为了在 Windows 中挂载 EFI 分区，我们可以在 PowerShell 中运行如下命令 diskpart list disk # make sure which is the disk that contains the EFI partition. usually 0 select disk 0 list partition # make sure which is the EFI partition. normally 0 select disk 0 assign letter=z 然后我们就将 EFI 挂载为盘符为 Z 的盘了。 使用 Windows + Ubuntu 双系统时可能会用到这个操作：有时候，移除了 Ubuntu 系统之后，只留下 Windows 系统，但每次开机时仍然会弹出 grub 界面。这个时候就需要将旧的 ubuntu EFI 分区给删掉。 ","date":"2023-06-12","objectID":"/efi_partition/:0:0","tags":["存储/分区","Linux"],"title":"在 Windows 中挂载 EFI 分区的方法","uri":"/efi_partition/"},{"categories":["数学物理方法"],"content":"1 微分形式 在介绍旋度之前，我们得先介绍一下微分形式和外微分算子。 一个 $n$ 阶形式可以定义为一个交替多重线性映射 $\\omega:(T_pM)^n\\rightarrow \\mathbb{R}$ 。它把多个向量映射成一个实数。另外，它还满足交替性，即交换两个输入向量，输出多一个负号。 因此可以显式地定义 $n$ 阶形式如下： $\\omega^1\\wedge \\omega^2\\wedge\\cdots\\wedge \\omega^n(v_1,v_2,\\cdots,v_n)= \\begin{vmatrix} \\omega^1(v_1) \u0026 \\cdots \u0026 \\omega^{1}(v_n) \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\omega^n(v_1) \u0026 \\cdots \u0026 \\omega^n(v_n) \\end{vmatrix}\\in\\mathbb{R}$ $T_pM$ 上所有 $n$ 阶形式的集合可以写成 $\\bigwedge^n(T^*_pM)$ 。 至于“微分形式”，它与“形式”的不同之处在于，它是“形式的场”，即流形上每一点都对应一个该点处的形式。换句话说，“形式”是相对于某一点来说的，而“微分形式”是相对于整个流形来说的。 ","date":"2023-06-10","objectID":"/curl_in_n_dimension/:0:1","tags":["矢量微积分"],"title":"高维空间中的旋度","uri":"/curl_in_n_dimension/"},{"categories":["数学物理方法"],"content":"2 外微分 外微分算子的定义如下： 外微分算子是一个映射 $\\mathrm{d}: \\bigwedge^n(T_p^*M)\\rightarrow \\bigwedge^{(n+1)}(T_p^*M)$ ，它作用到一个 $n$ 阶微分形式： $\\varphi=\\sum_{I}f_I\\mathrm{d}x^{I}=\\sum_{(i_1,\\cdots,i_n)}f_{(i_1,\\cdots,i_n)}\\mathrm{d}x^{i_1}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_n}$ 上，得到一个 $(n+1)$ 阶微分形式： $\\mathrm{d}\\varphi=\\sum_{I}\\sum_{i}\\frac{\\partial f_I}{\\partial x_i}\\mathrm{d}x_i\\wedge x_I$。 评论 这一堆指标太丑陋了，不如看下面的例子。 例 对于一个 3 维流形上的二阶微分形式： $ \\varphi=z^2\\mathrm{d}x\\wedge\\mathrm{d}y+x\\sin y\\,\\mathrm{d}y\\wedge \\mathrm{d}z $ ，其外导数为： $$\\begin{aligned} \\mathrm{d}\\varphi \u0026=\\left(\\frac{\\partial z^2}{\\partial x}\\mathrm{d}x+\\frac{\\partial z^2}{\\partial y}\\mathrm{d}y+\\frac{\\partial z^2}{\\partial z}\\mathrm{d}z\\right)\\wedge\\mathrm{d}x\\wedge\\mathrm{d}y \\\\ \u0026 +\\left(\\frac{\\partial (x\\sin y)}{\\partial x}\\mathrm{d}x+\\frac{\\partial (x\\sin y)}{\\partial y}\\mathrm{d}y+\\frac{\\partial (x\\sin y)}{\\partial z}\\mathrm{d}z\\right)\\wedge\\mathrm{d}y\\wedge\\mathrm{d}z \\\\ \u0026=(2z+\\sin y)\\,\\mathrm{d}x\\wedge\\mathrm{d}y\\wedge\\mathrm{d}z \\end{aligned} $$ ","date":"2023-06-10","objectID":"/curl_in_n_dimension/:0:2","tags":["矢量微积分"],"title":"高维空间中的旋度","uri":"/curl_in_n_dimension/"},{"categories":["数学物理方法"],"content":"3 N 维空间中的旋度 在下面的例子中，我们将会给出旋度与外微分的关系： 例 在三维流形上，外导数算子 \\mathrm{d} 作用到一个一阶微分形式后，会得到一个二阶微分形式： $$ \\begin{aligned} \\mathrm{d}(f_i\\mathrm{d}x^i)\u0026=\\frac{\\partial f_1}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^1+\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^1+\\frac{\\partial f_1}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^1 \\\\ \u0026+\\frac{\\partial f_2}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^2+\\frac{\\partial f_2}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^2+\\frac{\\partial f_2}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^2 \\\\ \u0026+\\frac{\\partial f_3}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^3+\\frac{\\partial f_3}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^3+\\frac{\\partial f_3}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^3 \\end{aligned} $$ 对它使用一次 Hodge 星算子，会得到一个一阶微分形式： $$ \\begin{aligned} \\star \\mathrm{d}(f_i\\mathrm{d}x^i)\u0026=\\phantom{+\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3}-\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3+\\frac{\\partial f_1}{\\partial x^3}\\mathrm{d}x^2 \\\\ \u0026\\phantom{=}+\\frac{\\partial f_2}{\\partial x^1}\\mathrm{d}x^3 \\phantom{\\,\\,\\,\\,-\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3} -\\frac{\\partial f_2}{\\partial x^3}\\mathrm{d}x^1 \\\\ \u0026\\phantom{=}-\\frac{\\partial f_3}{\\partial x^1}\\mathrm{d}x^2+\\frac{\\partial f_3}{\\partial x^2}\\mathrm{d}x^1 \\\\ \u0026=\\left(\\frac{\\partial f_3}{\\partial x^2}-\\frac{\\partial f_2}{\\partial x^3}\\right)\\mathrm{d}x^1 + \\left(\\frac{\\partial f_1}{\\partial x^3}-\\frac{\\partial f_3}{\\partial x^1}\\right)\\mathrm{d}x^2 + \\left(\\frac{\\partial f_2}{\\partial x^1}-\\frac{\\partial f_1}{\\partial x^2}\\right)\\mathrm{d}x^3 \\end{aligned} $$ 它可以写成旋度和切向量的内积： $\\star\\mathrm{d}f:\\star\\mathrm{d}f(v)=\\langle \\nabla \\times f^{\\sharp}\\mid v \\rangle$ 我们暂时不介绍什么是 Hodge 星算子，现在，你只需要知道，在 3 维流形上，Hodge 算子作用到一个的 $n$ 阶微分形式上会得到一个 $(3-n)$ 阶微分形式。 具体地，如果配备了内积 $\\langle\\mathrm{d}x^i,\\mathrm{d}x^j\\rangle=\\delta^{j}_i$ ，则有： $$\\star(\\mathrm{d}x^i \\wedge \\mathrm{d}x^j)=\\mathrm{d}x^k$$ $$\\star\\mathrm{d}x^i =\\mathrm{d}x^j\\wedge \\mathrm{d}x^k$$ $$\\star(f\\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k)=f$$ $$\\star f=f \\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k$$ 其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个偶置换。 另外，注意到我们用了一个升号： $\\sharp$ 。这是因为旋度是作用在切向量场，而非余切向量场上的。 具体来说，旋度 $\\nabla\\times$ 把切向量场映射成一个切向量场： $\\Gamma(TM)\\rightarrow \\Gamma(TM)$ 。但是 $f\\in \\Gamma(T^*M)$ 是一个余切向量场（一阶微分形式），因此我们先要给将它“升”为切向量场： $f^\\sharp\\in \\Gamma(TM)$ 。 这其实就是物理人喜闻乐见的指标升降： $g^{ij}X_i=X^j$ 。同理， $\\flat$ 代表将切向量场“降”为余切向量场： $g_{ij}X^i=X_j$ 。 回到上面的例子，我们有一个由内积诱导的典范同构： $$\\sharp:\\star \\mathrm{d}f\\mapsto \\nabla\\times f^{\\sharp}$$ 或写成： $$(\\star \\mathrm{d}f)^\\sharp = \\nabla\\times f^{\\sharp}$$ 或写成： $$\\star \\mathrm{d}f(v) = \\langle\\nabla\\times f^{\\sharp}\\mid v\\rangle$$ 其中 $f$ 是一个一阶微分形式。 我们还可以写成： $\\nabla\\times F=(\\star \\mathrm{d} (F^{\\flat}))^{\\sharp}$ 其中 $F=f^\\sharp$ 是一个切向量场， $f$ 是一个余切向量场（一阶微分形式）。 通过上面例子的启发，我们可以将旋度定义为 $$ \\begin{aligned} (\\nabla\\times) :\\quad \u0026 \\Gamma(TM)\\rightarrow \\Gamma\\left(\\bigwedge^{n-2}TM\\right)\\ \u0026F\\mapsto(\\star \\mathrm{d} (F^{\\flat}))^{\\sharp} \\end{aligned} $$ 其中 $F$ 是一个切向量场； $F^{\\flat}$ 是一个余切向量场（一阶微分形式）； $\\mathrm{d} (F^{\\flat})$ 是一个二阶微分形式， $\\star \\mathrm{d} (F^{\\flat})$ 是一个 (n-2) 阶微分形式。 因此，一个 $n$ 维流形上的切向量场 $F$ 的旋度 $(\\star \\mathrm{d} (F^{\\flat}))^{\\sharp}$ 是一个 $(n-2,0)$ 型反对称张量场。或者说是一个 (n-2)-向量场。 在 3 维流形中，旋度退化为一个切向量场。在 2 维流形中，旋度退化为一个标量场。 ","date":"2023-06-10","objectID":"/curl_in_n_dimension/:0:3","tags":["矢量微积分"],"title":"高维空间中的旋度","uri":"/curl_in_n_dimension/"},{"categories":["数学物理方法"],"content":"1 引子 我们在物理书中经常看到所谓“赝矢量”（pseudo-vector）和“赝标量”（pseudo-scalar）的说法。 其实，在 3 维流形上，“赝矢量”是两个切矢量的外积 $v\\in T_pM\\wedge T_pM=\\bigwedge^2(T_pM)$ ，“赝标量”是三个切矢量的外积 $s\\in T_pM\\wedge T_pM\\wedge T_pM=\\bigwedge^3(T_pM)$ 。 在配备了内积（或者非退化双线性形式）之后， $\\bigwedge^2(T_pM)$ 和 $\\bigwedge^1(T_pM)$ 之间有 Hodge 对偶关系，所以我们“误把”赝矢量当作矢量了。同理，由于 \\bigwedge^3(T_pM) 和 $\\bigwedge^0(T_pM)$ （标量场）之间有 Hodge 对偶关系，所以我们“误把”赝标量当作标量了。 实际上，3 维流形上的赝矢量，在数学上就是 2-矢量（bivector，2-vector）。它和 2-form 的定义是类似的，只不过 2-vector 在切空间的外积中 $v\\in\\bigwedge^2(T_pM)$ ，而 2-form 在余切空间的外积中 $\\omega\\in\\bigwedge^2(T_p^*M)$ 。 ","date":"2023-06-10","objectID":"/pseudovectors/:1:0","tags":["外代数"],"title":"赝矢量到底是什么？","uri":"/pseudovectors/"},{"categories":["数学物理方法"],"content":"2 空间反演变换 回想一下，我们之所以把“赝矢量”叫做“赝矢量”，是因为它们在空间反演变换下会有奇怪的行为。但是如果你把它当作两个矢量的外积，那么一切怪异的行为都有了解释。 具体地，看下图，在空间反演变换下，磁场竟然调转了方向！这就类似于你往一个方向移动，但是镜子里的你往另一个方向移动。这不得不说是一个灵异事件。 磁场是一个 bivector。如果你把磁场看成 vector，就会出现图中这种灵异的现象：磁场照了一下镜子，发现自己的头变成脚了。 但实际上，点 $p$ 处的磁场并非一个 vector，而是一个 bivector。即 $B|_p\\in (T_pM)\\wedge (T_pM)$ 。它的基为 $\\frac{\\partial}{\\partial x}\\wedge \\frac{\\partial}{\\partial y},\\,\\frac{\\partial}{\\partial y}\\wedge \\frac{\\partial}{\\partial z},\\,\\frac{\\partial}{\\partial z}\\wedge \\frac{\\partial}{\\partial x}$ 。 所以说，并没有什么灵异事件（欢迎收看《走近科学》）。在空间反演变换下，磁场对应的两个 vector 分别都朝向了正确的方向，只不过人类非要用右手螺旋定则，将一个 bivector 看成是一个 vector，这才导致了诡异现象的出现。 虽然数学上对 bivector 有完善的定义，但我们还是想问：怎样画出 bivector？答案是：可以把一个 bivector 画成有取向的面元。不同形状的面元，只要它们相互平行，且面积相同，就指的是同一个 bivector。换句话说，同一个 bivector 可以有许多不同的画法，只要保证它们平行，且面积和取向相同即可。 平行、面积相同、取向相同的面元，对应同一个 bivector。 实际上，将 bivector 通过右手螺旋定则，看成一个 vector ，这只在三维流形中可行。因为只有在三维流形中，三减二才恰好等于一。在四维流形中，由于四减二等于二，我们只能把 bivector 对偶成另外一个 bivector ，而不是一个 vector。 而在五维流形中，bivector 可以对偶成一个 trivector ，…，在 n 维流形中，bivector 可以对偶成一个 (n-2)-vector。 ","date":"2023-06-10","objectID":"/pseudovectors/:2:0","tags":["外代数"],"title":"赝矢量到底是什么？","uri":"/pseudovectors/"},{"categories":["数学物理方法"],"content":"3 麦克斯韦方程的外代数形式 顺便一提，电场也是一个 bivector，它的基为 $\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial x},\\,\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial y},\\,\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial z}$ ，有一个时间维度。之所以它看起来不是“赝矢量”，是因为我们只考虑了空间反演变换，没有考虑时间反演变换。 如果考虑余切空间中的电磁 2-形式（采取自然单位制）: $$ \\begin{aligned} F\u0026=E_x\\mathrm{d}t\\wedge\\mathrm{d}x+E_y\\mathrm{d}t\\wedge\\mathrm{d}y+E_z\\mathrm{d}t\\wedge\\mathrm{d}z \\\\ \u0026+B_x \\mathrm{d}y\\wedge\\mathrm{d}z + B_y \\mathrm{d}z\\wedge\\mathrm{d}x + B_z\\mathrm{d}x\\wedge\\mathrm{d}y \\end{aligned} $$ 由于我们可以通过度规张量来任意升降一个张量的指标，所以对上式升指标，我们也可以写出一个 $(2,0)$ 型电磁张量，它以 $\\frac{\\partial}{\\partial t},\\frac{\\partial}{\\partial x},\\frac{\\partial}{\\partial y},\\frac{\\partial}{\\partial z}$ 的外积为基。 不过我们暂时先采用 $(0,2)$ 型反对称张量（微分形式），因为这样做可以利用外微分（Exterior Derivative）的符号 $\\mathrm{d}$ 。 现在，再考虑电流 1-形式： $J=-\\rho\\mathrm{d}t+J_x\\mathrm{d}x+J_y\\mathrm{d}y+J_z\\mathrm{d}z$ 于是，在闵可夫斯基度规 $\\text{diag}(-1,1,1,1)$ 下，麦克斯韦方程就可以写成很简洁的形式： $$ \\left\\{\\quad \\begin{aligned} \\mathrm{d}F\u0026=0 \\\\ \\star \\, \\mathrm{d}\\star F \u0026= J \\end{aligned} \\right. $$ 其中 $\\star$ 是 Hodge 星算子（也就是 Hodge 对偶）。 可以看出，在外代数的语言中，电磁场是一个 2-vector 或者 2-form，而不是一个 vector 或者 1-form。 不过电流确实是一个 vector（或 1-form）。 ","date":"2023-06-10","objectID":"/pseudovectors/:3:0","tags":["外代数"],"title":"赝矢量到底是什么？","uri":"/pseudovectors/"},{"categories":["日常"],"content":"博客迁移 发现了这个制作个人网站的神器 - Hugo。感觉酷炫且好用。以后把知乎的博客都慢慢迁移过来！ ","date":"2023-06-10","objectID":"/blog_migration/:0:0","tags":["日常"],"title":"博客迁移","uri":"/blog_migration/"},{"categories":["数学物理方法"],"content":"前言 作为物理人，你很可能听过张量，微分形式，李代数 … 等等概念的其中一个或者多个。但是你可能像我一样，每次听到这些概念的时候都感觉云里雾里。因此，本文旨在帮助物理人，为这些彼此紧密联系的诸概念进行一个梳理。 本文的结构如下： a. 在第一章中，我们引入物理学的舞台：微分流形，并定义流形上的标量场。 b. 在第二章中，我们引入切空间和切丛等概念，并定义流形上的矢量场和张量场。最后，我们还定义内积和度规张量，它们是通往黎曼流形和广义相对论的门票。 c. 在第三章中，我们引入外积、外代数等概念，并在流形上研究微分（外微分）。最后，我们介绍一下 Hodge 对偶，它将内积与外积一种美妙的方式联系起来。 d. 在第四章中，我们引入两种导数，即协变导数和李导数。 协变导数描述了流形上的联络，并可以用来定义平移、测地线和曲率。基于这些概念，我们就可以简要介绍广义相对论； 李导数描述了流形上向量场的“流动”，它是非常有用的一个概念，可以用来漂亮地定义散度、挠率、曲率等等概念。 e. 在第五章中，我们引入单形、链等概念，并在流形上研究积分。另外，我们简单介绍同调和上同调，它们用来研究流形上的“孔洞”。 f. 在第六章中，我们引入作为微分流形的群——李群，并研究李群的切空间——李代数，并介绍它们在物理学中的应用。 以下是一些关于本文的声明和注意事项： a. 免责声明 本文只是我的笔记。我假想了读者的存在，这不仅有可能帮助到其他人，而且可以加深我自己的理解。然而，正因为本文只是一个笔记，所以难免会出错。如果读者发现了任何事实错误，请及时指出，我会及时修改，避免误导他人。 b. 目标读者 本文需要的前置知识有：初等微积分、初等线性代数、（可选）向量微积分。 如果读者是物理系的，那么效果最佳。本文适合物理系大二及以上的学生阅读，竞赛生除外。 如果读者是数学系的，也完全欢迎阅读、提出意见、指出错误。 严谨性与易懂性永远是对立和互补的。本文为了易懂，难免在语言上牺牲一些严谨性。因此请数学系读者包容。我会尽可能将严谨性的损失降到最低。 c. 阅读建议 本文旨在梳理概念，因此不推荐作为教程来阅读。当然，如果你只是感兴趣，那么阅读本文绝对是没有坏处的。 在本文的正文中，穿插着很多对概念的解读和补充。为了不影响对正文的阅读，它们会被冠以“评论”的标题，并以不同的样式展示。 在本文的正文中，还穿插一些“选读”段落。“不求甚解”的读者可以跳过它们，“刨根问底”的读者可以阅读它们。 本文附带一个目录，高级的读者可以浏览目录，并直接跳到感兴趣的章节阅读。 ","date":"2023-06-09","objectID":"/differential_geometry/:1:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"第一章 流形和流形上的标量场 本章介绍微分流形及其涉及的前置知识。具体来说，本章首先介绍拓扑空间，其次介绍拓扑流形，最后介绍微分流形，以及微分流形上的标量场。每一个概念都建立在前一个概念的基础之上。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.1 拓扑（Topology） 非空集合 X 的 拓扑 定义为 X 的子集的集合 $\\mathcal{F}$ ，且 $\\mathcal{F}$ 满足如下三条性质： a. $\\emptyset，X \\in \\mathcal{F}$ ； b. $\\mathcal{F}$ 中有限个元素的交集仍在 $\\mathcal{F}$ 中； c. $\\mathcal{F}$ 中任意多元素的并集仍在 $\\mathcal{F}$ 中。 评论 我是本文的第一个“评论”。在本文中，“评论”指的是对概念的解读和补充。现在我们就来解读一下拓扑这个概念。 拓扑就是一个集合 $\\mathcal{F}$ ，这个集合 $\\mathcal{F}$ 里的元素是另一个集合 $X$ 的一些子集。当然，这些子集不是从 $X$ 里随意选取的，而是要满足一定的要求。具体来说，它们要满足对有限次的交运算，以及任意次的并运算是封闭的。另外，规定空集和 $X$ 本身也在拓扑中。 如果你还懂一点集合论，那你应该可以看出，拓扑就是一个集合的幂集的子集。 下面来看一些例子。 例 1.1 $\\{\\emptyset,\\{1,2,3\\}\\}$ 是集合 $\\{1,2,3\\}$ 的一个拓扑。 $\\{\\emptyset,\\{1,2,3\\},\\{1\\}\\}$ 是集合 $\\{1,2,3\\}$ 的一个拓扑。 $\\{\\emptyset,\\{1,2,3\\},\\{1\\},\\{2\\},\\{1,2\\}\\}$ 是集合 $\\{1,2,3\\}$ 的一个拓扑。 $\\{\\emptyset,\\{1,2,3\\},\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\}\\}$ 是集合 $\\{1,2,3\\}$ 的一个拓扑。 例 1.2 初等微积分中的 $\\mathbb{R}^n$ 中的所有开集是它的一个拓扑。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:1","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.2 拓扑空间（Topological Space） 定义了拓扑的集合叫做拓扑空间。更具体地，拓扑空间定义为 $(X,\\mathcal{F})$，其中 $\\mathcal{F}$ 是 $X$ 的一个拓扑。 拓扑里的元素叫做拓扑空间中的开集。 评论 拓扑使得我们不需要依赖度量也可以定义开集。在拓扑学中，我们将分析学里的开集的“有限交”和“无限并”的性质抽象出来，用来定义开集本身。 如果上下文允许，我们可以直接将 $X$ 叫做拓扑空间，而不用将 $(X,\\mathcal{F})$ 写出来。 选读 1.2 你可能想问，为什么我们不用“可数交”和“有限并”来定义闭集，然后以此来定义拓扑呢？为什么选择开集，而不是闭集？我想这可能涉及各种历史因素，详见这个问题。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:2","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.3 连续（Continuity） 设 $(X,\\mathcal{F})$ 和 $(Y,\\mathcal{S})$ 是拓扑空间， $f:X\\rightarrow Y$ 是一个映射。如果 $\\forall O \\in \\mathcal{S} \\,(f^{-1}[O] \\in \\mathcal{F})$ ，则称 $f$ 是连续的。其中 $f^{-1}[O]$ 代表 O 在 $f$ 下的原像（Inverse Image）。 评论 连续的意思就是“开集的原像仍是开集”。这和分析学中连续的定义非常不同。 集合 $O\\in Y$ 在映射 $f:X\\rightarrow Y$ 下的原像 $f^{-1}[O]$ 定义为： $f^{-1}[O]=\\{x\\in X\\mid f(x)\\in O \\}$ 在数学中，原像一般使用圆括号 $f^{-1}(O)$ ，但本文为了将其与逆映射作区分，使用了中括号的写法：$f^{-1}[O]$。 例 1.3 在例 1.2 中的拓扑上，映射 $$ f:\\mathbb{R}\\rightarrow\\mathbb{R}, \\,f(x)=\\begin{cases}1, \u0026 x\u003e0 \\\\ 0, \u0026 x=0 \\\\ -1, \u0026 x\u003c0\\end{cases}$$ 不是一个连续映射，因为开集 $\\{x\\in \\mathbb{R}\\mid -1\u003cx\u003c1\\}$ 在映射 f 下的原像为 $\\{0\\}$ ，不是一个开集。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:3","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.4 同胚（Homeomorphism） 若 $f:X\\rightarrow Y$ 是一个双射，且 $f$ 和 $f^{-1}$ 都是连续的，则称 $f$ 是从 $X$ 到 $Y$ 的一个同胚。 如果存在从 $X$ 到 $Y$ 的同胚，那么我们也可以说， $X$ 与 $Y$ 同胚。 评论 同胚就是双连续的双射。当我们说一个（带把的）咖啡杯与一个甜甜圈同胚的时候，我们实际在说二者的点可以建立一一对应关系，也就是双射，并且这个双射是双向连续的。 没有什么东西可以阻止你在一个（球形）糖果和一个甜甜圈之间建立双射。但是有一点是肯定的，这样的双射一定不是双连续的。也就是说，甜甜圈不同胚于一个糖果。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:4","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.5 邻域（Neighborhood） 如果 $X$ 是一个拓扑空间， $p \\in X$ 且 $p \\in O \\subseteq N \\subseteq X$ ，其中 $O$ 是一个开集，则称 $N$ 是 $p$ 的一个邻域。 评论 注意，邻域本身不一定必须是开集。如果一个邻域是开集，那么可以称它为开邻域。 当然，有些作者把邻域定义成开邻域，这取决于你在看哪本书。在数学中，对同一个概念有着许多不同的定义，这没关系，关键是要保持上下文的一致性。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:5","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.6 豪斯多夫空间（Hausdorff Space） 如果对于拓扑空间 $X$ 的任意两个元素 $x,y$ ，都可以找到 $x$ 的邻域 $U$ 和 $y$ 的邻域 $V$ ，使得 $U\\cap V=\\emptyset$ ，则称 $X$ 是一个豪斯多夫空间。 评论 说实在的，当我第一次看到豪斯多夫空间的定义时，我根本想象出来有什么空间不是豪斯多夫空间。 它的性质非常好，以至于我们后面介绍的流形，在定义上都属于豪斯多夫空间。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:6","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.7 拓扑流形（Topological Manifold） 若豪斯多夫拓扑空间 $M$ 有可数开覆盖 $M=\\bigcup_\\alpha O_\\alpha$（ $O_\\alpha$ 为开集），且每一个 $O_\\alpha$ 都同胚于 $\\mathbb{R}^n$ 的一个开子集（这个 $\\mathbb{R}^n$ 的拓扑是传统意义上的欧几里得拓扑），则称 $M$ 为一个 $n$ 维的拓扑流形。 评论 简单来说，如果 $M$ 在每一个局部都同胚于（欧几里得意义上的） $\\mathbb{R}^n$ 的一个开子集，则将 $M$ 称为拓扑流形。 这里所说的“欧几里得意义上的拓扑”指的是我们在初等多元微积分中都学过的那种用欧式度量所定义的点集拓扑。由于本文假定读者学过初等微积分，因此不再赘言。 拓扑流形在局部看起来像是 $\\mathbb{R}^n$，但是从全局来看，可能和 $\\mathbb{R}^{n}$ 很不一样。例如一个“甜甜圈”的表面，它的局部看起来像是 $\\mathbb{R}^2$ ，但是整体来看和 $\\mathbb{R}^2$ 是完全不同的。 之所以引入拓扑流形，是因为我们想为上面的每个点都分配一个坐标。 对于拓扑流形上的每一点 $p \\in O_\\alpha$ ，都有一个同胚 $\\varphi_\\alpha: O_\\alpha \\rightarrow \\varphi_\\alpha[O_\\alpha] \\subseteq \\mathbb{R}^n$ 为其分配了一个坐标。 然而，用一组坐标系往往是不够的，我们需要多组坐标系 ($O_\\alpha,\\varphi_\\alpha$) 来覆盖整个拓扑空间。 开覆盖的重合部分 $O_\\alpha \\cap O_\\beta$ 中的点有两套坐标。利用映射 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}:\\varphi_\\alpha[O_\\alpha \\cap O_\\beta]\\rightarrow \\varphi_\\beta[O_\\alpha \\cap O_\\beta]$ 可以在两套坐标系之间进行坐标变换。 这一系列开集 $O_\\alpha$ 以及对应的同胚 $\\varphi_\\alpha$ 叫做图册（Atlas）。更具体地，图册定义为所有坐标系 ($O_\\alpha,\\varphi_\\alpha$) 的集合。 评论 在很多书籍中， $\\varphi_\\alpha$ 的方向是从 $\\mathbb{R}^n$ 的开子集到流形 $M$ 的开子集的，即 $\\varphi_\\alpha:V_\\alpha\\subseteq \\mathbb{R}\\rightarrow M $。它的方向与我们上文定义的方向相反。这样一来，坐标变换就会写成 $\\varphi_\\beta^{-1}\\circ\\varphi_\\alpha$ ，而不是 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 。不过，由于 $\\varphi$ 是一个双射，所以它的方向并不重要。读者从上下文中自行判断方向即可。 评论 从现在开始，我们用的符号会逐渐变得抽象。你可能需要时不时地停下来，好好思考每一个符号分别代表了什么意思。也就是说，你不能再将本文当做是科普文或者小说来阅读。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:7","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.8 微分流形（Differentiable Manifold） 记拓扑流形 $M$ 的开覆盖到 $\\mathbb{R}^n$ 的开子集的同胚为 $\\varphi_\\alpha:O_\\alpha\\rightarrow \\varphi_\\alpha[O_\\alpha]\\subseteq \\mathbb{R}^n$。 若对每一对 $O_\\alpha \\cap O_\\beta \\neq \\emptyset$ ， $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 都是光滑（无穷次可微）函数，则称拓扑空间 $M$ 为微分流形。 评论 由于 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 这个坐标变换映射是光滑（无穷阶可微）的，它保证了在坐标变换时，微分结构不会被破坏。详见第 1.9 节。 评论 微分流形可以简称流形。当我们说流形的时候，我们通常指的都是微分流形，而非拓扑流形。 你可能在想 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 的光滑性是如何定义的。注意到 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 只不过是 $\\mathbb{R}^n$ 的一个开子集 $V_\\alpha$ 和另一个开子集 $V_\\beta$ 之间的双射。它的可微性在我们学习初等微积分时已经有过完善的讨论，此处无需赘言。 在第 1.3 节，我们定义了拓扑空间到拓扑空间的映射（ $f:X\\rightarrow Y$ ）的连续性，这个定义对于拓扑流形也适用。但是，我们还没有定义微分流形到微分流形的映射的光滑性，即 $f:M\\rightarrow N$ 的光滑性。 现在，我们可以定义 $f:M\\rightarrow N$ 的光滑性。这个定义需要 $\\mathbb{R}^n$ 作为媒介，即： 如果 $\\varphi_\\beta\\circ f \\circ \\varphi_\\alpha^{-1}$ 光滑，则称 $f$ 光滑。 同样，注意到 $\\varphi_\\beta\\circ f \\circ \\varphi_\\alpha^{-1}$ 是 $\\mathbb{R}^n$ 的一个开子集 $V_\\alpha$ 到另一个开子集 $V_\\beta$ 之间的映射。它的可微性在我们学习初等微积分时也已经有过完善的讨论，此处无需赘言。 如果 $f:M\\rightarrow N$ 是光滑的双射，那么我们称 $f$ 是一个微分同胚（diffeomorphism）。也可以说， $M$ 与 $N$ 微分同胚。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:8","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"1.9 标量场（Scalar Field） 定义微分流形上的（实）标量场 $f:M\\rightarrow \\mathbb{R}$ 为两个映射的复合： $f=F\\circ \\varphi$ 。 其中 $\\varphi$ 是从 $O$ 到 $\\varphi[O]\\subseteq \\mathbb{R}^n$ 的同胚， $F$ 是从 $\\varphi[O]$ 到 $\\mathbb{R}$ 的函数。 若 $F$ 还是从 $\\varphi[O]$ 到 $\\mathbb{R}$ 的光滑函数，则称 $f$ 是一个光滑标量场。 $M$ 上所有光滑标量场的集合记为 $\\mathcal{F}(M)$ 。 评论 为了确保我们的光滑标量场是良定义的，需要确保 $O_\\alpha$ 和 $O_\\beta$ 相交的部分不出问题。幸运地是， $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 的光滑性保证了这一点。 更具体地说，对于 $O_\\alpha$ 和 $O_\\beta$ 相交的部分，有 $f=F_\\alpha \\circ \\varphi_\\alpha=F_\\beta \\circ \\varphi_\\beta \\implies F_\\alpha=F_\\beta\\circ \\varphi_\\beta \\circ \\varphi_\\alpha^{-1}$。 如果 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 不是光滑函数的话，那么 $F_\\beta$ 光滑就不能保证 $F_\\alpha$ 光滑。这将导致定义不良。 将定义中的 $\\mathbb{R}$ 换成 $\\mathbb{C}$ ，我们就能从实标量场的定义得到复标量场的定义。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:9","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"小结 在本章中，我们定义了微分流形以及流形上的标量场。步骤如下： 首先，我们定义一个集合的拓扑是它的所有开子集构成的集合。定义了一个拓扑之后，一个集合就不再是一个简单的集合，而是一个拓扑空间。拓扑空间的同胚指的是连续的双射，它保证咖啡杯可以连续地变换为甜甜圈，此时我们也可以说咖啡杯和甜甜圈同胚。 其次，我们希望为拓扑空间上的每一点分配一个坐标。这就是拓扑流形，它局部看起来像 $\\mathbb{R}^n$，但是整体上不同于 $\\mathbb{R}^n$。具体的做法如下：让拓扑空间的每一个“局部”的开集同胚于 $\\mathbb{R}^n$ 的一个开子集，然后将这些开集并起来，覆盖整个拓扑空间。这样就刻画了一个拓扑流形。 最后，我们希望在拓扑流形上研究微分，于是就引出了微分流形。微分流形是具有微分结构的拓扑流形，这个微分结构确保了微分流形上的光滑（无穷次可微）标量场是良定义的。具体来说，它规定坐标变换 $\\varphi_\\beta\\circ\\varphi_\\alpha^{-1}$ 这个映射是光滑的，从而保证了坐标变换不会破坏光滑标量场的光滑性。 ","date":"2023-06-09","objectID":"/differential_geometry/:2:10","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"第二章 流形上的矢量场和张量场 在本章中，我们首先引入切空间和对偶空间等概念。 其次，基于这些概念，我们定义微分流形上的矢量场和张量场。 最后，我们介绍内积和度规张量，它们是微分流形上的额外结构。在配备了度规张量之后，一个微分流形就成为了一个（伪）黎曼流形。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.1 切向量、切空间（Tangent Vector, Tangent Space） 记 $\\mathcal{F}(M)$ 为微分流形 $M$ 上所有光滑标量场 $f:M\\rightarrow \\mathbb{R}$ 构成的集合。 微分流形 $M$ 上某一点 $p$ 处的切向量 $v_p$ 定义为 $v_p:\\mathcal{F}(M)\\rightarrow\\mathbb{R}$ ，且 $v_p$ 满足如下两条性质： a)（线性） $v_p(\\alpha f+\\beta g)=\\alpha v_p(f) + \\beta v_p(g)$ b)（导子） $v_p(fg)=f(p)v_p(g)+g(p)v_p(f)$ 由于线性性，点 $p$ 处的所有切向量构成一个向量空间。将这个空间称为点 $p$ 处的切空间，记作 $T_pM$ 。 实际上，满足以上两个条件的数学对象就是求方向偏导的算子 $\\left.\\left(v^i\\frac{\\partial}{\\partial x^i}\\right)\\right|_p: f\\mapsto \\left.\\left(v^i\\frac{\\partial f}{\\partial x^i}\\right)\\right|_p$ ，它将一个光滑标量场映射为一个标量。 在上式中我们用到了爱因斯坦求和约定（Einstein Convention），也就是对相同的指标进行求和。后面如无特别说明，对上下标一律使用爱因斯坦求和约定。 可以看出，切空间的基可以写成 $\\{\\frac{\\partial}{\\partial x^i}\\}$，简记为 $\\{ \\partial_i \\}$。 评论 你可以把点 $p$ 处的切空间想象成与点 $p$ 相切的那个超平面。 一个单位切向量作用到一个流形上的标量场，会得到标量场沿该切向量方向的方向导数。 注意， $\\frac{\\partial f}{\\partial x^i}$ 实际上指的是 $\\frac{\\partial F}{\\partial x^i}$（见第 1.9 节），但是在不引起歧义的情况下，我们都写成 $\\frac{\\partial f}{\\partial x^i}$。 选读 1.3 我们也可以定义一个切向量是参数曲线的一个等价类。具体来说，记 $\\mathcal{L}$ 为所有经过点 $p$ 的参数曲线的集合： $\\mathcal{L}:=\\{\\gamma:(-\\epsilon,\\epsilon)\\rightarrow M\\mid \\gamma(0)=p\\in M\\}$ 注意到参数曲线 $\\gamma$ 是两个映射的复合： $\\gamma:(-\\epsilon,\\epsilon)\\xrightarrow{\\beta} \\mathbb{R}^n \\xrightarrow{\\varphi^{-1}} M$ ，即 $\\gamma = \\varphi^{-1}\\circ\\beta$ 。 我们可以想到，在某个坐标系 $\\varphi$ 下，对于在点 $p$ 处相切的一族曲线，它们在点 $p$ 处的导数 $\\beta^\\prime(0)$ 是平行的。因此，这一族曲线可以将方向确定下来。除了确定方向以外，我们还要确定向量（速度）的大小。因此我们不仅要求这族曲线相切（即 $\\beta^\\prime(0)$ 平行），我们还要求它们拥有完全相同的导数（即 $\\beta^\\prime(0)$ 相等）。我们定义这样的一族曲线为一个切向量。 可以证明，这与我们之前的定义是等价的。 稍微想一想，你就可以发现，这两种定义方式都使得切空间不需要镶嵌在另一个更大的空间中，而是可以视作微分流形的内蕴性质。我们只需要审视流形自身，就可以意识到切空间的存在。 换句话说，虽然将切空间看做切平面非常形象，但在数学上，我们完全可以抛弃这个图像。 有时候，丢掉一些无用的负担，可以让你行走得更远。抽象给人类的思维插上了翅膀。 评论 “矢量”和“向量”是同一个东西，都是“vector”的中译词。只不过数学人习惯使用“向量”，而物理人更习惯使用“矢量”而已。本文虽然面向物理人，但是也使用了“向量”，当然，偶尔也会使用“矢量”，读者只需要知道它们是同义词即可。 类似的例子还有“本征”和“特征”，它们都是“eigen-”的中译词。如果一个人把 eigenvectors 翻译成“本征矢量”，那么你可以立即知道 ta 是一个物理人；如果一个人把 eigenvectors 翻译成“特征向量”，那么你可以立即知道 ta 是一个数学人。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:1","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.2 切丛、向量场（Tangent Bundle, Vector Field） 评论 切空间只是相对于流形 $M$ 某一点 $p$ 处来说的。如果我们想要同时研究流形上的所有点的切空间，我们就要定义切丛。 切丛 $TM$ 定义为这样一个集合： $\\{(p,v)\\mid \\,p\\in M,v \\in T_pM\\}$，它是流形上所有点与该点处的所有切向量的有序对的集合。 切丛的截影（Section）定义为这样一个映射： $M\\rightarrow TM$ ，它将点 $p$ 映射为 $(p,v)$ 。 评论 当我们在说截影的时候，我们一般指的都是光滑截影。 （切）向量场定义为切丛的一个截影。如果这个截影是光滑的，那么我们则称向量场是光滑的。 切丛上所有向量场的集合可以记为 $\\Gamma(TM)$ 。 评论 读者可以好好体会一下这个定义的微妙之处。如果我们直接定义向量场是切丛本身，那么对于某一点 $p\\in M$ ，由于切丛 $TM$ 中不仅有 $(p,v_1)$ 这个元素，还有 $(p,v_2)$ 这个元素，且 $v_2\\neq v_1$ ，因此我们没办法将某一点 $p$ 与该点的切空间 $T_pM$ 中唯一的一个向量对应起来。而如果将向量场定义为一个映射 $p\\mapsto (p,v)$ ，我们就可以做到这一点。 对于向量场的光滑性，你可能想问映射 $M\\rightarrow TM$ 的光滑性是如何定义的。实际上，如果 $M$ 是一个 $n$ 维流形，则 $TM$ 是一个 $2n$ 维流形，而从流形到流形的映射的光滑性，我们在第 1.8 节已经定义过了。 至于为什么 $TM$ 是一个 $2n$ 维流形，此处暂不作详细解释（再说下去，本文就要变成微分拓扑学讲义了）。物理人嘛，不需要追究那么多细节。如果你觉得对这个定义不是很满意，可以看下面将要介绍的另一种定义。 评论 在数学书中，切丛的截影的定义还要更严谨一些，要先做一个投射 $(p,v)\\mapsto p$ ，再让截影与投射的复合成为 $M$ 上的恒等映射。不过这些细节对于物理人理解物理图像并没有什么特别的帮助，因此就不细说了。我们物理人只要把向量场想象成“为流形上的每一点（以一种光滑的方式）指派一个该点处的向量”即可。 （光滑）向量场还有另外一种定义，即从 $\\mathcal{F}(M)$ 到 $\\mathcal{F}(M)$ 的映射，它把一个（光滑）标量场映射成另外一个（光滑）标量场。 换句话说，它在流形上的每一点都对（光滑）标量场都求了一个方向导数，然后把这些方向导数的值作为一个新的标量场。如果新的标量场也是光滑的，则称该向量场是光滑的。 这个定义和上文的定义是等价（同构）的，证略。在这种定义下，我们可以把 $M$ 上的（光滑）向量场构成的集合记为 $\\mathcal{T}_0^1(M)$ 。这个符号的上标和下标的意思，读者以后会明白。 这个定义可能更加适合初学者，因为它不需要研究作为流形的切丛 $TM$ 。 评论 实际上，$TM$ 可以作为拉格朗日力学的舞台。回想一下，拉格朗日力学的变量是广义坐标和广义速度 $x^1,\\cdots,x^n,v^1,\\cdots,v^n$。广义速度正好就是切空间中的元素，于是有 $(x,v)\\in TM$。 评论 在第 1.9 节中，我们定义了流形上的标量场，现在，我们定义了流形上的向量场。在第 2.8 节，我们还会定义流形上的张量场。不过在那之前，我们还要做许多铺垫（从第 2.3 节到第 2.7 节）。在这些铺垫中，最重要的的概念是下一节要介绍的对偶空间。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:2","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.3 对偶空间、自然同构（Dual Space, Natural Isomorphism） 评论 如果你线性代数学的不错，可以跳过本节！ 一个向量空间 $V$ 的对偶空间 $V^*$ 定义为该向量空间上的所有线性泛函的集合。 更具体地说，线性泛函是一个映射 $v^*:V\\rightarrow \\mathbb{R}$ ，且满足线性性： $v^*(\\lambda a + \\mu b) = \\lambda v^*(a) + \\mu v^*(b)$。它将向量空间 $V$ 中的元素映射成一个实数。 因为线性泛函满足线性性，所以我们马上就能证明对偶空间是一个向量空间（证略）。 定理 2.1 对于线性空间 $V$ 中的一组基 $\\{e_i\\}$ ，总是可以找到 $V^*$ 中唯一的一组基 $\\{e^j\\}$ ，使得 $e^j(e_i)=\\delta^j_i$ ，证略。 $\\{e^j\\}$ 叫做 $\\{e_i\\}$ 的对偶基。 评论 注意到原空间的基使用了下标，对偶空间的基使用了上标。这是一种惯例，用来区分原空间和对偶空间。 评论 $\\delta^j_i$ 的定义为 $\\delta^j_i=\\begin{cases} 1, \u0026 i=j \\\\ 0, \u0026 i\\neq j \\end{cases}$ 有限维向量空间 $V$ 与其对偶空间的对偶空间 $V^{**}$ 之间有自然同构关系。自然同构的意思是这个同构的建立不依赖于基的选取。这个自然同构定义如下： $f:v^{**}\\mapsto v \\quad\\text{s.t.}\\quad v^{**}(v^*)=v^*(v)$ 评论 $\\text{s.t.}$ 的意思是“such that”，或者“subject to”，翻译成中文就是“使得”，或者“满足”。 评论 我们在线性代数中学过，对于任何两个有限维的向量空间，只要它们维数相等，那么它们就是同构的。这是因为只要将在两个向量空间中分别选取一组基，并将这些基一一对应起来，就能得到一个同构。我们可以做到这一点，因为两个向量空间的基的数量是相等的。 但是，这样的同构有无穷多个，且依赖于基的选取，没有哪一个同构是特别的。但是，我们上面定义的自然同构是唯一且“自然”的：它不依赖于基的选取。 当两个向量空间自然同构时，我们在某种程度上可以把这两个空间看作是同一个空间。换句话说，一个有限维向量空间的对偶空间的对偶空间就是该向量空间自身。 当然，以上只考虑了有限维的线性空间。对于无限维的线性空间来说， $V^* 和 V^{**}$ 比 $V $大。不过现在我们暂时不关心这件事。 另外，自然同构有时候也叫典范同构（Canonical Isomorphism）。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:3","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.4 余切空间、余切丛（Cotangent Space, Cotangent Bundle） 余切空间定义为切空间的对偶空间，记作 $T_p^*M$ 。 余切空间中的元素叫做余切向量。 余切空间仅仅是相对于流形上的某一点来说的。为了研究流形上每一点的余切空间，我们可以参照第 2.2 节中定义切丛的方式，定义一个余切丛： $T^*M:=\\{(p,v)\\mid \\,p\\in M,v \\in T^*_pM\\}$，它是流形上所有点与该点处的余切向量的有序对的集合。 余切丛的截影定义为这样一个映射： $M\\rightarrow T^*M$ ，它将点 $p$ 映射为 $(p,v)$ ，其中 $v\\in T_p^*M$ 。物理人把余切丛的（光滑）截影叫做（光滑的）余切向量场。 我们可以把余切丛上所有（光滑）向量场的集合记作 $\\Gamma(T^*M)$ 。 评论 实际上，$T^*M$ 可以作为哈密顿力学的舞台。回想一下，哈密顿力学的变量是广义坐标和广义动量 $x^1,\\cdots, x^n, p_1, \\cdots, p_n$。广义动量正好就是余切空间中的元素，于是有 $(x,p) \\in T^*M$ 与第 2.2 节同理，我们也可以把（光滑）余切向量场定义为：从向量场 $\\mathcal{T}^1_0(M)$ 到标量场 $\\mathcal{F}(M)$ 的映射。并且将其记作 $\\mathcal{T}^0_1(M)$ 。这两种定义是等价的。从初学者的角度来说，我们通常先采用后一种定义。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:4","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.5 微分（Differential） 点 $p$ 处关于标量场 $f$ 的微分 $(\\mathrm{d}f)|_p$ 是一个余切向量，满足： $(\\mathrm{d}f)|_p(v|_p)=v|_p(f)$ 。 流形上光滑标量场 $f$ 的微分，定义为上述余切向量构成的余切向量场。即 $\\mathrm{d}f: \\mathrm{d}f(V):=V(f)$ 例 2.1 现有 3 维微分流形上点 $p$ 处的一个向量 $v|_p=\\left.\\left(\\frac{\\partial}{\\partial x}+2\\frac{\\partial}{\\partial y}-\\frac{\\partial}{\\partial z}\\right)\\right|_p$ 。 标量场 $f$ 的微分 $\\mathbb{d}f$ 作用到 $v$ 身上后得到 $(\\mathbb{d}f)|_p(v|_p)=v|_p(f)=\\left.\\left(\\frac{\\partial f}{\\partial x}+2\\frac{\\partial f}{\\partial y}-\\frac{\\partial f}{\\partial z}\\right)\\right|_p$ 点 $p$ 处的微分所在的余切空间有什么样的基呢？以 3 维流形上的一点 $p$ 为例，该点的切空间有三个基 $\\{\\frac{\\partial}{\\partial x^1},\\frac{\\partial}{\\partial x^2},\\frac{\\partial}{\\partial x^3}\\}$ ，简记为 $\\{ \\partial_1, \\partial_2, \\partial_3 \\}$。根据定理 2.1，我们可以找到这三个基在余切空间中的对偶基 $\\{\\mathrm{d}x^1,\\mathrm{d}x^2,\\mathrm{d}x^3\\}$ ，使得 $\\mathrm{d}x^j\\partial_i=\\delta_i^j$ 。某点处的微分可以表示成这些基的线性组合： $\\mathrm{d}f=a_i\\mathrm{d}x^i$ 。 评论 全微分 以上说的只是某一点处的情况。如果希望推广到流形上，就需要将 $\\mathrm{d}x^i$ 定义为作为标量场的 $x^i$ 的微分，即 $g: (x^1,\\cdots,x^n)\\mapsto x^i$ 的微分。从这个定义出发，可以推导出全微分等式： $$\\mathrm{d}f=\\frac{\\partial f}{\\partial x^i}\\mathrm{d}x^i$$ 推导如下： 设 $\\mathrm{d}f=a_i\\mathrm{d}x^i$，则有 $$ \\frac{\\partial f}{\\partial x_j} =: \\mathrm{d}f(\\partial_{j}) = a_i\\mathrm{d}x^i(\\partial_{j}) = a_i \\partial_j x^i = a_i\\delta^{i}_{j} = a_j $$ 评论 雅可比矩阵 如果我们换了一个坐标系，那么同一个标量场在新旧坐标系中的微分之间会有什么关系呢？答案就是雅可比矩阵（Jacobian Matrix）。 发生坐标变换时，我们记新坐标在旧坐标系下的坐标为 $x^{\\prime i}(x)$，则雅可比矩阵定义为： $$ J^i_j := \\frac{\\partial x^{\\prime i}}{\\partial x^j} $$ 在坐标变换 $x^i \\mapsto x^{\\prime i}(x)$ 下，微分的变换 $\\mathrm{d}x^i \\mapsto \\mathrm{d}x^{\\prime i}$ 的公式如下： $$ \\mathrm{d}x^{\\prime i} = J^{i}_{j} \\mathrm{d}x^j $$ 其实上式就是全微分公式 $\\mathrm{d}x^{\\prime i} = \\frac{\\partial x^{\\prime i}}{\\partial x^j} \\mathrm{d}x^j$。只不过为了后文的方便，我们将 $\\frac{\\partial x^{\\prime i}}{\\partial x^j}$ 简写为 $J^i_j$，并将其叫做雅可比矩阵。 我们可以发现，雅可比矩阵给出了流形局部的余切空间的基的坐标变换公式。请记住这一点，在后面的第2.8-9节中会用到。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:5","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.6 多重线性映射（Multilinear Map） 评论 从本节开始，我们将会逐步引入张量的概念。请坐稳了！ 多重线性映射是指有多个向量变量且对每个变量都是线性的映射。 具体来说， $n$ 重线性映射定义为 $f:V_1\\times V_2\\times \\cdots\\times V_n \\rightarrow W$ ，且满足如下性质： $$ \\begin{aligned} \u0026f(v_1,\\cdots,\\lambda a+ \\mu b,\\cdots,v_n) \\\\ \u0026=\\lambda f(v_1,\\cdots,a,\\cdots,v_n)+\\mu f(v_1,\\cdots,b,\\cdots,v_n) \\end{aligned}$$ 评论 在物理中，我们难免要研究多个粒子的系统，而多重线性映射就是我们需要的数学工具。 然而，多重线性映射是多个向量空间到一个向量空间的映射，有时用起来并不方便。如果能将其转化为一个向量空间到另一个向量空间的线性映射，则会清晰很多（对于后者，我们在初等线性代数中已经有过较多的研究）。因此我们下文会定义张量积，它能将一个多重线性映射转化为一个普通线性映射。 另外，作为物理人，我们早就听说过很多张量，例如惯性张量，应变张量，电磁张量，爱因斯坦张量（虽然我们还不清楚张量究竟是什么）等等。我们需要为这些张量提供一个舞台，这也要求我们给张量积下一个完整的定义。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:6","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.7 张量积（Tensor Product） 对于每一个多重线性映射 $f:V\\times W \\rightarrow \\mathbb{R}$ ，都可以找到（在相差一个同构的意义上）唯一的一个向量空间 $V\\otimes W$ ，以及映射 $g:V\\times W \\rightarrow V \\otimes W$ 和线性映射 $h: V \\otimes W \\rightarrow \\mathbb{R}$ ，使得 $f = h \\circ g$ （证略）。这个向量空间 $V\\otimes W$ 定义为 $V$ 和 $W$ 的张量积。 这种定义方式用到了范畴论中 universal property。具体来说，对于同一个数学对象，我们通常有很多种不同的构造（定义）方式，但是这些不同的构造都满足一些共有性质。 因此，我们不妨把这些性质抽象出来，作为数学对象本身的定义。这些共有的性质就叫做 universal property。 用性质来定义数学对象，就免去了构造的痛苦。不同的构造在相差一个同构的意义上（up to an isomorphism）是完全等价的。 评论 你可能现在一头雾水。别着急，在本章末尾的“评论”中，我们将会详解这个定义的缘由。现在，你可以暂时接受它。 评论 我们先提供一个感性的认识，从基底的角度来考察张量积。毕竟物理人离开了基是活不下去的。 假设 3 维向量空间 V 有三个基： $\\{v_1,v_2,v_3\\}$ ，2 维向量空间 W 有两个基： $\\{w_1,w_2\\}$ ，那么它们的笛卡尔积（直积） $V\\times W$ 有五个基： $\\{(v_1,0),(v_2,0),(v_3,0),(0,w_1),(0,w_2)\\}$。 而 $V$ 和 $W$ 的张量积 $V \\otimes W$ 有六个基： $\\{v_1\\otimes w_1, v_1 \\otimes w_2, v_2 \\otimes w_1, v_2 \\otimes w_2, v_3 \\otimes w_1, v_3 \\otimes w_2\\}$ 。 从这组基来看，你应该能对张量积有一个感性的认识：笛卡尔积的维数是 $3+2$，而张量积的维数是 $3\\times 2$。 评论 注意，张量积和直积（或直和、笛卡尔积）是不同的！ 评论 你可能想问：“ok，我知道张量积与直积不同，毕竟它们的基的个数都不一样。但是直积、直和、笛卡尔积之间有什么不同？” 由于本篇文章的重点不是这三者，现在仅作简要的说明： a. 直积可以理解为群/向量空间的、笛卡尔积。更技术化一点说，直积是笛卡尔积配备一个同态。 b. 笛卡尔积和直积的符号是一样的，都是 $\\times$ ，以至于它们经常被混用。 c. 直和与直积的定义方式是完全不同的。不过即使如此，直积与直和的区别仅在于：直积可以做可数无穷次，而直和只能做有限次。在有限次直积/直和的情况下，几乎可以把直积与直和看成是同一个东西。 张量积与这三者都不同。$m$ 维向量空间和 $n$ 维向量空间的张量积是 $m\\times n$ 维的，而它们的直积/直和/笛卡尔积是 $(m+n)$ 维的。 评论 本文对张量采取了 universal property 的定义，而不是像物理书里那样，用一个莫名其妙的坐标变换来定义。这是因为多重线性映射才是张量积的本质。即，每一个多重线性映射都要“经过”张量积。 采取这种定义还有一个目的，是为了为后文的交替线性映射与外积作铺垫。即在后文中，我们也会使用 universal property 来定义外积。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:7","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.8 张量（Tensor） 现在我们考虑一种特别的张量积，它是一个向量空间 $V$ 与自己的对偶空间 $V^*$ 进行了若干次张量积： $\\underbrace{V \\otimes \\cdots \\otimes V}_m\\otimes \\underbrace{V^*\\otimes \\cdots \\otimes V^*}_n$， 其中 $V$ 有 $m$ 个， $V^*$ 有 $n$ 个。我们把这个空间里的元素 $t\\in \\underbrace{V \\otimes \\cdots \\otimes V}_m\\otimes \\underbrace{V^*\\otimes \\cdots \\otimes V^*}_n$ 叫做 $(m, n)$ 型张量。 我们还可以将 $\\underbrace{V \\otimes \\cdots \\otimes V}_m\\otimes \\underbrace{V^*\\otimes \\cdots \\otimes V^*}_n$ 写成更紧凑的形式 $V^{\\otimes m}\\otimes V^{*\\otimes n}$ 。其中上标 $^{\\otimes n}$ 的意思是自己和自己做张量积。例如 $(V)^{\\otimes 2}$ 指的是 $V \\otimes V$ 。 $V^{\\otimes n}$ 也可以写成 $\\bigotimes^n(V)$ 。 特别地，我们把标量叫做零阶张量，或者 $(0,0)$ 型张量；切向量叫做 $(1,0)$ 型张量；余切向量叫做 $(0,1)$ 型张量。 在很多物理书中， $(m,n)$ 型张量被定义为一个多重线性映射 $f:\\underbrace{V^*\\times\\cdots\\times V^*}_m\\times \\underbrace{V \\times \\cdots \\times V}_n\\rightarrow \\mathbb{R}$ ，其中 $V^*$ 有 $m$ 个， $V$ 有 $n$ 个。并且把 $M$ 上所有 $(m,n)$ 型张量的集合记作 $\\mathcal{T}_n^m(M)$ 。 这两种定义之间是等价的。因为对于每一个这样的多重线性映射，都能在张量积 $\\underbrace{V \\otimes \\cdots \\otimes V}_m\\otimes \\underbrace{V^*\\otimes \\cdots \\otimes V^*}_n$ 中找到唯一的一个元素与其对应（根据 universal property）。注意，在后者中， $V$ 有 $m$ 个， $V^*$ 有 $n$ 个，与前者相反。 例 2.2 二次型 以双线性映射 $V\\times V\\rightarrow \\mathbb{R}$ 为例，其中 $V$ 是二维线性空间。取 $V$ 的基为 $\\{e_1,e_2\\}$ ，向量 $v$ 在这组基下的坐标为 $(v^1,v^2)$ ，向量 $w$ 在这组基下的坐标为 $(w^1,w^2)$ 。 我们在线性代数中学过，这个双线性映射（即二次型）可以用一个矩阵来表示： $$\\begin{pmatrix} v^1 \u0026 v^2 \\end{pmatrix} \\begin{pmatrix} a_{11} \u0026 a_{12} \\\\ a_{21} \u0026 a_{22} \\end{pmatrix} \\begin{pmatrix} w^1 \\\\ w^2 \\end{pmatrix} \\in \\mathbb{R},$$ 它将两个向量映射为一个实数。 根据第二种定义（多重线性映射），我们可以直接定义张量 $a$ 就是这个双线性映射。而根据第一种定义（universal property），它对应 $V\\otimes V$ 上唯一的一个线性泛函 $a:V\\otimes V\\rightarrow\\mathbb{R}$ ，即 $a\\in(V\\otimes V)^*$ 。 进一步地，我们可以把 $(V\\otimes V)^*$ 的括号“去掉”，变成 $V^*\\otimes V^*$。看起来，张量 $a$ 可以直接写成 $V^*\\otimes V^*$ 这个线性空间里的一个元素： $a=a_{11}e^{1}\\otimes e^{1}+a_{12}e^{1}\\otimes e^{2}+a_{21}e^{2}\\otimes e^{1}+a_{22}e^{2}\\otimes e^{2}$ 。 实际上，这些定义彼此之间都是等价的，即有 $$\\mathcal{L}(V\\times V,\\mathbb{R})=: L(V\\otimes V,\\mathbb{R})=:(V\\otimes V)^*\\cong V^*\\otimes V^*$$ 其中 $\\mathcal{L}(V\\times V,\\mathbb{R})$ 表示 $V\\times V$ 到 $\\mathbb{R}$ 的多重线性映射， $L(V\\otimes V,R)$ 表示 $V\\otimes V$ 到 $\\mathbb{R}$ 的线性映射，根据 universal property，它们是一一对应的。 而 $L(V\\otimes V,R)$ ，按照定义，就是 $V\\otimes V$ 的对偶空间 $(V\\otimes V)^*$ ，它显然与 $V^*\\otimes V^*$ 同构，因为它们的维数相同。具体来说，我们可以指定这样一个同构： $(e_i\\otimes e_j)^*\\mapsto e_i^*\\otimes e_j^*=e^i\\otimes e^j$ ，其中 $(e_i\\otimes e_j)^*$ 是 $e_i\\otimes e_j$ 的对偶基。 可见，$a\\in V^*\\otimes V^*$ 是一个 $(0,2)$ 型张量。根据 universal property，它将两个 $(1,0)$ 型张量（也就是切向量）映射为一个实数。用我们物理人熟悉的指标写法，就是 $a_{ij}v^iv^j\\in \\mathbb{R}$ 。 如果把基也写出来，就是下面这个式子： $$\\begin{aligned} a(v,w)\u0026=(a_{11}e^{1}\\otimes e^{1}+a_{12}e^{1}\\otimes e^{2}+a_{21}e^{2}\\otimes e^{1}+a_{22}e^{2}\\otimes e^{2}) (v^{1}e_1+v^2e_2,w^{2}e_1+w^2e_2) \\\\ \u0026=(a_{11}e^{1}\\otimes e^{1}+a_{12}e^{1}\\otimes e^{2}+a_{21}e^{2}\\otimes e^{1}+a_{22}e^{2}\\otimes e^{2}) \\\\ \u0026\\phantom{=} (v^1w^1e_1\\otimes e_1+v^1w^2e_1\\otimes e_2+v^2w^1e_2\\otimes e_1+v^2w^2e_2\\otimes e_2) \\\\ \u0026=a_{ij}v^{i}w^{j} \\end{aligned} $$ 或者写成更紧凑的形式： $$ (a_{ij}e^{i}\\otimes e^{j})(v^ie_i,w^je_j)=a(v,w)=a(v\\otimes w)=(a_{ij}e^{i}\\otimes e^{j})(v^iw^je_i\\otimes e_j)=a_{ij}v^{i}w^{j} $$ 在相差一个同构的意义上， $e^{i}\\otimes e^{j}=e_i^*\\otimes e_j^*\\cong (e_i\\otimes e_j)^* $ 是 $ e_{i}\\otimes e_{j}$ 的对偶基，也就是说 $(e^{i}\\otimes e^{j})(e_{k}\\otimes e_{l})=\\delta_k^i \\delta^j_l$ 。 正如 universal property 所说，对于每一个双线性映射 $f:V\\times V\\rightarrow \\mathbb{R}$ ，我们都能找到唯一的一个线性空间 $V\\otimes V$ 以及映射 $g:V\\times V\\rightarrow V \\otimes V$ 和映射 $h:V\\otimes V\\rightarrow \\mathbb{R}$ ，使得 $f = h \\circ g$ 。我们现在来看一看 $g$ 和 $h$ 的坐标表示。 $g$ 的坐标表示是 $g:(v^i,v^j)\\mapsto v^{ij}$ 。 而 $h$ 的坐标表示是 $h:v^{ij}\\mapsto a_{ij}v^{ij}$ 。 把 $h$ 和 $g$ 复合起来，也就得到了 $f:(v^i,v^j)\\mapsto a_{ij}v^iv^j$ 。 我们将 $g:(v^i,v^j)\\mapsto v^{ij}$ 称为“并矢”。并矢也可以叫做两个向量的张量积。如果一个张量可以被写成向量的并矢，那么我们称该张量是可分解的（separable）。 我们现在来看看作为线性变换的张量，它是一个 $(1,1)$ 型张量。 例 2.3 线性变换与 (1,1) 型张量 我们说线性变换是一个 $(1,1)$ 型张量，这实际上是在说 $L(V,V)$ 和 $\\mathcal{T}^1_1(V)$ 之间有一个自然同构。这个自然同构定义如下： $$ \\begin{aligned} f: \\mathcal{T}^1_1(V) \u0026\\rightarrow L(V,V) \\\\ T \u0026\\mapsto A \\\\ T(\\omega, X)\u0026=\\omega(AX) \\end{aligned","date":"2023-06-09","objectID":"/differential_geometry/:3:8","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.9 张量场（Tensor Field） 评论 定义好张量之后，我们就可以来定义张量场了。 （光滑）张量场定义为一个（光滑）映射 $f:M\\rightarrow T_n^mM$。其中 $T_n^m M :=\\{(p,v)\\mid \\,p\\in M,v \\in (T_pM)^{\\otimes m}\\otimes (T_p^*M)^{\\otimes n}\\}$ 叫做张量丛。换言之，张量场是张量丛的一个截影。 简单来说，一个张量场将流形上的每点 $p$ 映射为 $(p,v)$ ，其中 $v$ 是点 $p$ 处的一个 $(m,n)$ 型张量。如果这个映射还是光滑的，那么我们则称该张量场是光滑的。 评论 你可能好奇 $f:M\\rightarrow T_n^mM$ 这个映射的光滑性是什么意思。与第 2.2 节类似， $T_n^mM$ 也是一个流形，而流形到流形的映射的光滑性，我们在第 1.8 节已经定义过。 其实我们物理人不用这么关心张量场在数学上的形式化定义。我们只要知道张量场的意思就是“为流形上的每一点（以光滑的方式）指派了一个该点处的张量”即可。 与第 2.2 节类似， $(m,n)$ 型张量场也有另外一种定义，即 $$ t:\\underbrace{\\mathcal{T}_1^0(M) \\times \\cdots \\times \\mathcal{T}_1^0(M)}_{m} \\times \\underbrace{\\mathcal{T}_0^1(M) \\times \\cdots \\times \\mathcal{T}_0^1(M)}_n \\rightarrow \\mathcal{F}(M) $$ $M$ 上全体 $(m,n)$ 型张量场的集合记作 $\\mathcal{T}^m_n(M)$ 。 这种定义方式更加适合物理人的胃口，因为它不需要讨论作为流形的张量丛 $T_n^mM$ 究竟是什么。 例 2.6 张量场的坐标变换 在例 2.4中我们考察了张量的坐标变换公式。现在我们把张量推广成张量场—张量场的坐标变换公式是什么样的？ 实际上，我们只需要把例 2.4的公式中的矩阵 $A$ 换成雅可比矩阵的逆 $J^{-1}$ 即可： $$ (T^\\prime)^{i…j}_{k…l} = \\left[J^{i}_{p}\\cdots J^{j}_{q}(J^{-1})^{s}_{k}\\cdots (J^{-1})^{t}_{l}\\right] \\, T^{p…q}_{s…t} $$ 其中 $ J^i_j := \\frac{\\partial x^{\\prime i}}{\\partial x^j} $ (见第 2.1 节)。 这是因为雅可比矩阵是余切空间的基的变换矩阵（见第 2.1 节末），而根据例 2.4我们知道，坐标的变换矩阵与基的变换矩阵互为逆矩阵。 另外，根据例 2.4，我们知道切空间的基/坐标的变换矩阵与余切空间的基/坐标的变换矩阵也互为逆矩阵。 如果你能理解上面这几句话，那么你就算是完全掌握了张量（场）的坐标变换公式了。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:9","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"2.10 内积、度规张量、黎曼流形（Inner Product, Metric Tensor, Riemann Manifold） 评论 回顾第 2.3 节，我们说过 $V$ 与 $V^{**}$ 是自然同构的，因为这个同构不依赖于基的选取。 那么我们可能还想问： $V$ 与 $V^{*}$ 是自然同构的吗？毕竟对偶向量作用在一个向量上，和内积实在是太像了（虽然我们还没有定义内积，不过你一定早就听说过它了）。 如果没有定义内积的话，答案是否定的。因为这个同构总是依赖于基的选取。 你可能会想，将 $V$ 的基 $\\{e_i\\}$ 与 $V^*$ 中的对偶基 $\\{e^i\\}$ 一一对应，不是能得到一个自然同构吗？非也。因为如果你改变了 $V$ 的基，那么 $V^{*}$ 中对应的对偶基也会发生变化。 但是，如果定义了一个内积的话，那么在该内积的意义下， $V$ 与 $V^{*}$ 之间可以建立一个自然同构。或者说典范同构。 换言之，内积“诱导”了一个从 $V$ 到 $V^*$ 的典范同构。 评论 在定义内积之前，我们先定义厄米形式。 厄米形式是一个映射 $V\\times V\\rightarrow\\mathbb{C}$ ，写成 $\\langle\\cdot,\\cdot\\rangle$ 或者 $\\langle\\cdot|\\cdot\\rangle$ 。满足： a)（对第二个变量的线性） $\\langle x|\\lambda a+\\mu b\\rangle=\\lambda\\langle x|a\\rangle+\\mu\\langle x| b\\rangle$ b)（厄米性） $\\langle x|y\\rangle=\\langle y|x\\rangle^\\dagger$ 由 a) 和 b) 我们可以得到对第一个变量的反线性（Antilinearity）： $\\langle \\lambda a+\\mu b|x\\rangle=\\lambda^{\\dagger}\\langle a|x\\rangle+\\mu^{\\dagger}\\langle b|x\\rangle$ 非退化厄米形式就是在厄米形式的基础上增加一个“非退化”的条件。 评论 非退化的意思是，对于每一个 $x\\neq 0 \\in V$ ，都存在 $y \\in V$ ，使得 $\\langle x|y\\rangle\\neq 0$ 。 从矩阵的观点来看，就是说矩阵的行列式不为零，或者说每一个特征值都不为零。 内积就是在厄米形式的基础上增加一个“正定”的条件。 评论 正定是指对于任何的 $v,w\\in V 且 v,w\\neq 0$ ，都有 $\\langle u|v\\rangle \u003e 0$ 。 从矩阵的观点来看，就是说矩阵的每一个特征值都大于零。 评论 $\\langle\\cdot,\\cdot\\rangle$ 是数学家的写法，$\\langle\\cdot\\mid\\cdot\\rangle$ 是物理学家的写法。注意，物理学家的 $\\langle x\\mid y\\rangle$ 对应于数学家的 $\\langle y,x\\rangle$ ，顺序是相反的。 现在，定义同构 $V \\rightarrow V^*$ 如下： $v \\rightarrow \\langle v\\mid \\cdot \\rangle$ $\\langle v\\mid\\cdot \\rangle \\in V^*$ 是这样一个线性泛函：它将 $u \\in V$ 映射为 $\\langle v\\mid u\\rangle\\in \\mathbb{R}$ 。 可见，在定义一个内积（或非退化的厄米形式）之后， $v \\rightarrow \\langle v\\mid\\cdot \\rangle$ 这个同构的定义是不依赖于基的。或者说，这个同构不会随着基的改变而改变。 因此，$v \\rightarrow \\langle v\\mid\\cdot \\rangle$（在某个内积或非退化厄米形式的意义下）是一个典范同构！ 也可以说，一个内积/非退化厄米形式诱导了一个从 $V$ 到 $V^*$ 的典范同构。 在这种情况下，我个人喜欢说“典范同构”而不是“自然同构”。因为自然同构有时特指 $V$ 与 $V^{**}$ 之间的典范同构。而内积终究还是人类选取的，不够“自然”。“典范”的内涵则要更广一些，且在范畴论中有更加明确的意思。 无论如何，选用“自然”还是“典范”取决于作者的偏好。 评论 在数学中，用内积来诱导典范同构，就是里斯表示定理的核心思想。在物理中，这就是量子力学中 “bra-ket”符号背后的原理。 评论 在物理中，我们在很多情况下使用的是非退化厄米形式，而非内积。这是因为狭义相对论的闵可夫斯基度规不是正定的，而仅仅是非退化的。 正因为如此，在很多情况下，物理人都会把内积和非退化厄米形式统称为内积，也就是将内积的定义扩大了。下文我们也会用内积来同时代指这两者。 注意到内积是一个双线性映射，因此它可以用一个 $(0,2)$ 型张量来刻画。根据上文所说的典范同构，我们可以利用内积，将一个 $(1,0)$ 型张量变为一个 $(0,1)$ 型张量： $g_{ij}v^i=v_j$ 。 $v_i\\mapsto v^j$ 就是该典范同构的坐标表示。在量子力学中，这写成 $|v\\rangle \\mapsto \\langle v|$ 。 评论 物理人可能已经对 $g_{ij}v^i=v_j$ 很眼熟了：这不就是张量的指标升降吗！ 如果你是物理人，以后你可以跟你的同学炫耀：张量的指标升降本质上是度规张量诱导的一个切丛与余切丛的音乐同构 (Musical Isomorphism）。 音乐同构指的是（配备了度规的）流形上每一点的切空间与余切空间之间都有典范同构。典范同构是相对于流形上的某一点来说的，而音乐同构是相对于整个流形来说的。 我们知道，在五线谱中，有着升降号 $\\sharp$ 和 $\\flat$ 。在音乐同构的语言中，我们借用这两个符号来表示指标的升降。 例如，我们可以将一个切向量场“降”为余切向量场： $$ \\begin{aligned} \\flat:TM\u0026\\rightarrow T^*M \\\\ X^i\u0026\\mapsto g_{ij} X^i=X_j \\end{aligned} $$ 当我们在做张量的指标升降时，我们其实是在绘制一张张动听的乐谱！ 音乐同构也是一个典范（Canonical）同构。 由于内积是一个张量，所以我们自然地就可以定义一个由内积构成的张量场，叫做度规张量场。 换句话说，流形上每一点都可以定义一个内积（度规张量）。 评论 “度规”的意思就是我们可以定义长度（从而，也可以定义夹角、面积、体积等等）。 长度（模）可以定义为一个向量与它自己的内积的正平方根： $ \\langle v\\mid v\\rangle^{1/2} $ 。 配备了度规的微分流形叫做黎曼流形。配备了非退化厄米形式的微分流形叫做伪黎曼流形。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:10","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"小结 在本章中，我们定义了流形上的矢量场和张量场，步骤如下： 首先，我们定义了切空间，它是向量所生活的地方。我们还定义了切丛，它以某种方式将流形上每一点的切空间并在一起。向量场定义为切丛的一个截影。 其次，我们介绍了对偶空间。余切空间定义为切空间的对偶空间，它是微分所生活的地方。 再次，我们介绍了多重线性映射和张量积。张量生活在 $p$ 个切空间与 $q$ 个余切空间的张量积中。这种张量叫做 $(p,q)$ 型张量。我们所说的 $p$ 阶逆变和 $q$ 阶协变，$p$ 个上标和 $q$ 个下标，其实就对应着 $p$ 个切空间和 $q$ 个余切空间。 最后，我们介绍了内积和度规张量，它们诱导了切空间（切丛）与余切空间（余切丛）之间的典范同构，从而允许我们对张量进行指标升降运算。 ","date":"2023-06-09","objectID":"/differential_geometry/:3:11","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"第三章 流形上的微分 在第二章中，我们介绍了多重线性映射和张量。这为本章首先介绍的交替多重线性映射和外代数提供了一些基础。 接着，基于外代数，我们就可以引入微分形式和外导数，然后回顾梯度、散度、旋度和赝矢量等概念，为引入 Hodge 对偶的概念做准备。 最后，我们介绍 Hodge 对偶，它将上一章介绍的内积与本章中介绍的外积以一种美妙的方式联系起来。我们每一次使用右手螺旋定则，其实背后都是在使用 Hodge 对偶。 ","date":"2023-06-09","objectID":"/differential_geometry/:4:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.1 交替多重线性映射（Alternating Multilinear Map） 在物理学中，交换两个全同费米子，波函数会多一个负号。这可以用交替多重线性映射来刻画。 交替多重线性映射是这样一个多重线性映射，当交换两个输入时，结果会多一个负号。 具体来说，交替 $n$ 重线性映射定义为 $f:V^n\\rightarrow W$ ，且满足如下性质： a) $$ \\begin{aligned} \u0026f(v_1,\\cdots,\\lambda a+ \\mu b,\\cdots,v_n) \\\\ \u0026=\\lambda f(v_1,\\cdots,a,\\cdots,v_n)+\\mu f(v_1,\\cdots,b,\\cdots,v_n) \\end{aligned} $$ b) $$ \\begin{aligned} \u0026f(v_1,\\cdots,v_i,\\cdots,v_j,\\cdots,v_n) \\\\ \u0026=-f(v_1,\\cdots,v_j,\\cdots,v_i,\\cdots,v_n) \\end{aligned} $$ ","date":"2023-06-09","objectID":"/differential_geometry/:4:1","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.2 外积、外代数（Exterior Product, Exterior Algebra） 评论 外积也叫楔积（Wedge Product）。将第 2.7 节中张量积的定义中的多重线性映射改成交替多重线性映射，即可得到外积的定义。 对于每一个交替多重线性映射 $f:V^n \\rightarrow \\mathbb{R}$ ，都可以找到一个（在相差一个同构的意义上）唯一的向量空间 $\\bigwedge^n (V)$ ，以及映射 $g:V^n \\rightarrow\\bigwedge^n (V)$ 和线性映射 $h: \\bigwedge^n (V) \\rightarrow \\mathbb{R}$ ，使得 $f = h \\circ g$ （证略）。 符号 $\\bigwedge^n(V)$ 代表 $V$ 和自己的外积。例如， $\\bigwedge^2(V)$ 就是 $V\\wedge V$ 。 这种定义方式用到了外积的 universal property。 评论 下面来看一下外积空间中有什么样的基底：假设 3 维向量空间 $V$ 有三个基： $\\{v_1,v_2,v_3\\}$ ，那么 $V$ 和自己的笛卡尔积（直和） $V\\times V$ 有六个基： $\\{(v_1,0),(v_2,0),(v_3,0),(0,v_1),(0,v_2),(0,v_3)\\}$ ，$V$ 张量积 $V\\otimes V$ 有九个基（请读者写出这九个基）。 而 $V$ 和自己的外积 $V \\wedge V$ 只有三个基： $\\{v_1\\wedge v_2,v_2 \\wedge v_3, v_3 \\wedge v_1\\}$ 。 这是因为 $v_i\\wedge v_i = -v_i\\wedge v_i \\implies v_i \\wedge v_i =0$。 一般地，$m$ 维线性空间的 $n$ 重交替线性映射所对应的外积空间有 $C_m^n$ 个基。换句话说，它是 $C_m^n$ 维的。 把 $n=0,\\cdots,m$ 的所有 n-form 直和起来，我们就得到了一个外代数： $\\bigwedge(T_p^*M)=\\bigoplus_n \\bigwedge^n(T_p^*M)$ 外代数的维数是 $\\sum_{n=1}^mC_m^n=2^m$ 。 评论 同理，对于前文的张量积，我们也可以定义一个张量代数： $T(V)=\\bigoplus_n \\bigotimes^n(V)$ 。 评论 在物理学中，全同费米子气体可以用一个外代数来表示： $\\bigwedge(H)=\\bigoplus_n \\bigwedge^n(H)$ ，其中 $H$ 是一个希尔伯特空间。这其实就是 $n$ 个费米子的 Fock Space。 当然，Fock Space 更多是用来处理全同玻色子的。此时我们需要引入对称代数 $S(H)=\\bigoplus_n S^n(H)$ 。它对应一个对称多重线性映射（Symmetric Multilinear Map）。顾名思义，它指的是交换两个输入向量，输出不变。读者可以尝试写出 $n$ 维对称代数的基。 前些年非常火的一个概念——量子玻色采样，涉及的数学就是对称代数。具体地，对于外代数中的行列式，可以在对称代数中找到一个对应物——积和式（Permanent）。然而，与行列式不同，计算积和式的时间复杂度不是多项式的。而量子玻色采样可以解决这个问题。这个概念当年在量子计算领域还挺火的，被人们视作“量子霸权”（Quantum Supremacy）的一个 killer app，现在似乎过气了（？） 评论 作为物理人，你可能想问：代数是什么意思？简单来说，代数就是配备了向量乘法的向量空间（或者模，Module）。在外代数中，向量乘法是外积 $\\wedge$ ，在张量代数中，向量乘法是张量积 $\\otimes$ 。 我们在中学学过叉乘。定义了叉乘的线性空间也是一个代数。它很像是一个 3 维的外代数，只不过给外积附加了一个 Hodge 对偶： $\\star: V\\wedge V \\rightarrow V$。当我们做叉积时，我们实际上先做了一次外积，然后做了一次 Hodge 对偶。我们在第 3.7 节会介绍什么是 Hodge 对偶。 评论 本文对外积采用了类似于上文张量积的定义，即用范畴论中的 universal property。这样做为了强调交替多重线性映射与外积之间的关系。 选读 3.1 实际上，外代数在数学中的“正统”定义是：张量代数商掉一个由全体形如 $v\\otimes v,v\\in V$ 的张量所生成的理想（Ideal）。 理想可以理解为“子代数”。具体来说，所有全体形如 $v\\otimes v,v\\in V$ 的元素也可以生成一个代数，这个代数比原来的代数要小。 “子代数”和向量空间的“子空间”是类似的，只不过子空间只要求对向量加法和数乘封闭，而子代数还要求对向量乘法也封闭。 读者可以验证全体形如 $v\\otimes v,v\\in V$ 的向量所生成的理想对向量加法、数乘、以及向量乘法是封闭的。 下面我们给出关于这个“正统”定义的一些线索： 取 $v=e^i$ ，那么商掉 $e^i\\otimes e^i$ 可以理解为令所有 $e^i\\otimes e^i =0$ 。 再取 $v=e^i + e^j$ ，则有 $(e^i + e^j)\\otimes(e^i + e^j)=e^i\\otimes e^j + e^j\\otimes e^i=0$ ，即有 $e^i\\otimes e^j = - e^j\\otimes e^i$ 。 我们可以证明两种定义方式的等价性。具体看下一节的选读 3.2。 ","date":"2023-06-09","objectID":"/differential_geometry/:4:2","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.3 形式、微分形式（Form、Differential Form） 评论 有了前面关于张量、交替多重线性映射、外积等等概念的铺垫，现在我们就可以定义形式和微分形式了。 流形 $M$ 上的点 $p$ 处的 $n$ 阶形式（n-form）是 $\\bigwedge^n(T_p^*M)$ 中的一个元素。 $\\bigwedge^n(T_p^*M)$ 里的元素（n-form），根据 universal property，对应一个多重线性映射 $(T_pM)^{n}\\rightarrow \\mathbb{R}$ ，它把多个切向量变成一个实数，并且交换两个输入的切向量时，结果会多一个负号。 评论 第 2.5 节介绍的某点处的微分（余切向量）其实就是一个 1-form。 如果强调研究流形上的所有点，则我们会定义流形上的 $n$ 阶微分形式，它为 $\\bigwedge^n(T^*M)$ 的光滑截影：$M\\rightarrow \\bigwedge^n(T^*M)$ 。其中 $\\bigwedge^n(T^*M)$ 定义为 $\\bigwedge^n(T^*M):= \\{(p,v)\\mid \\,p\\in M,v\\in \\bigwedge^n(T_p^*M)\\}$ 。 用换句话， $n$ 阶微分形式将点 $p$ 映射为 $(p,v)$ ，其中 $v$ 是一个 $n$ 阶形式。 我们也可以把 $n$ 阶微分形式看作是一个 $(0,n)$ 型反对称张量场。这一点我们会在 选读 3.2 中介绍。 评论 微分形式可以看作“形式的场”，即流形上每一点都对应了一个该点处的形式。 形式和微分形式之间的关系，就如同切空间和切丛截影之间的关系，一个强调在某一点处，一个强调流形上的所有点。 选读 3.2 外代数的不同构造方式 对于 $\\bigwedge^n(T_p^*M)$ ，我们可以采取很多种不同构造。正文中的交替多重线性映射就是第一种构造。 第二种构造是： $\\omega\\in\\bigwedge^n(T_p^*M)$ 是一个线性映射 $\\bigotimes^n(T_pM)\\rightarrow \\mathbb{R}$ 。它就是将第一种构造的多重线性映射变成了单个线性映射，同样也利用了 universal property。在这种构造下，一个 n-form 是一个 $(0,n)$ 型张量，它把点 $p$ 处的 $(n,0)$ 型张量映射成一个实数。当然，不是随便一个 $(0,n)$ 型张量都可以（要不然和张量代数就没区别了），而是要满足反对称性，即 $\\omega$ 是一个反对称 $(0,n)$ 型张量。反对称的意思是：交换两个下标/上标，结果多一个负号。 更严格地，我们可以定义反对称张量是反对称算子 $S_-$ 的像 $\\mathrm{Im}(S_-)$ 中的元素。具体来说，对于张量 $v=v_1\\otimes\\cdots\\otimes v_n$ ，我们定义反对称算子 $S_-$ 如下： $$ S_-(v_1\\otimes\\cdots\\otimes v_n)=\\frac{1}{n!}\\sum\\mathrm{sign}(\\sigma)v_{\\sigma_1}\\otimes\\cdots\\otimes v_{\\sigma_n} $$ 其中， $\\sigma=(\\sigma_1,\\cdots,\\sigma_n)$ 是 $(1,\\cdots,n)$ 的一个置换， $$ \\mathrm{sign}(\\sigma)=\\begin{cases} 1,\u0026 \\sigma \\text{ is even} \\\\ -1, \u0026 \\sigma \\text{ is odd} \\end{cases} $$。 反对称算子的像 $\\mathrm{Im}(S_-)$ 也可以构成一个代数，叫做交替张量代数，记作 $S_-(V)$ 。 容易看出，$\\mathrm{ker}(S_-)$ 正是 $v\\otimes v,v\\in V$ 所生成的理想，因此根据第一同态定理，外代数与交替张量代数是同构的： $\\bigwedge(V):=T(V)/I=T(V)/\\mathrm{ker}(S_-)\\cong \\mathrm{Im}(S_-)=:S_-(V)$ 。 由于交替张量代数与外代数同构，因此我们还有“一步到位”的第三种构造： $\\omega\\in\\bigwedge^n(T_p^*M)$ 是一个线性映射 $\\bigwedge^n(T_pM)\\rightarrow \\mathbb{R}$ 。当然，这种做法从计算的角度来说不是特别方便，因为我们每次用它做计算之前都要对张量做一次反对称化，这不如直接把 n-form 看成一个交替多重线性映射来得方便。 不论采用以上哪种构造来定义微分形式，都是可行的，因为这些构造彼此之间是同构的。最推荐的方式是把 n-form 当成一个交替多重线性映射，这不仅切中了外积的 universal property，而且还便于计算。 为了方便计算（这才是物理人关心的），我们需要显式地给出 n-form 的计算方法。 如果你对交替多重线性映射非常眼熟，那么在你的脑海中，计算方法可能已经呼之欲出了——答案就是行列式！ 在行列式中，交换两列，结果会多一个负号。而且，行列式对它的每一列都满足线性性。所以行列式对列向量来说正是一个交替多重线性映射！ 因此我们可以显式地定义 n-form 如下： $$ \\omega^1\\wedge \\omega^2\\wedge\\cdots\\wedge \\omega^n(v_1,v_2,\\cdots,v_n)= \\begin{vmatrix} \\omega^1(v_1) \u0026 \\cdots \u0026 \\omega^{1}(v_n) \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\omega^n(v_1) \u0026 \\cdots \u0026 \\omega^n(v_n) \\end{vmatrix} $$ 下面用一个例子，来看看一个 n-form 具体是如何作用到 n 个切向量上的。 例 3.1 在 3 维流形上的点 p 处有一个 2-form 如下： $\\omega = 5\\mathrm{d}x^1 \\wedge \\mathrm{d}x^3 -2\\mathrm{d}x^2\\wedge \\mathrm{d}x^3 $ 它作用到两个切向量 $u=\\partial_1+2\\partial_2+3\\partial_3$ 和 $v=3\\partial_1-2\\partial_2+\\partial_3$ 上得到： $$ \\begin{aligned} \\omega(u,v)\u0026= 5\\begin{vmatrix} \\mathrm{d}x^1(\\partial_1+2\\partial_2+3\\partial_3) \u0026 \\mathrm{d}x^1(3\\partial_1-2\\partial_2+\\partial_3) \\\\ \\mathrm{d}x^2(\\partial_1+2\\partial_2+3\\partial_3) \u0026 \\mathrm{d}x^2(3\\partial_1-2\\partial_2+\\partial_3) \\end{vmatrix}\\\\ \u0026-2\\begin{vmatrix} \\mathrm{d}x^2(\\partial_1+2\\partial_2+3\\partial_3) \u0026 \\mathrm{d}x^2(3\\partial_1-2\\partial_2+\\partial_3) \\\\ \\mathrm{d}x^3(\\partial_1+2\\partial_2+3\\partial_3) \u0026 \\mathrm{d}x^3(3\\partial_1-2\\partial_2+\\partial_3) \\end{vmatrix} \\\\ \u0026=5\\cdot\\begin{vmatrix}1\u00263\\\\ 2 \u0026-2\\end{vmatrix}-2\\cdot\\begin{vmatrix}2\u0026-2\\\\ 3 \u0026 1\\end{vmatrix} \\\\ \u0026=-48 \\end{aligned} $$ 具体地，一个一般的 $m$ 阶微分形式可以写成下式： $ \\omega = \\sum_If_I \\,\\mathrm{d}x^I=\\sum_{i_1\u003c\\cdots\u003ci_m}f_{(i_1,\\cdots,i_m)}\\mathrm{d}x^{i_1}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_m} $ 其中 $I$ 代表一系列指标 $(i_1,i_2,\\cdots,i_m), \\, i_1\u003ci_2\u003c\\cdots\u003ci_m$ ， $\\mathrm{d}x^I$ 代表 $\\mathrm{d}x^{i_1}\\wedge\\mathrm{d}x^{i_2}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_m}$ 。 例如对于 $\\omega=2 \\,\\mathrm{d}x^1\\wedge\\mathrm{d}x^2\\wedge\\mathrm{d}x^4+4 \\,\\mathrm{d}x^2\\wedge\\mathrm{d}x^3\\wedge\\mathrm{d}x^5$ ，有 $I=(1,2,4),(2,3,5)$ ， $f_{(1,2,4)}=2$, $f_{(2,3,5)}=4$ 。 评论 可定向性 注意到微分形式的定义里要求了光滑性。这使得我们需要注意一些可能存在的问题。 考虑一个莫比乌斯带（Mobius Strip），想象一个左舵的小车在上面行驶。如果让它行驶一圈回到原来的地方，你会发现它从左舵变成了右舵。这个诡异的现象使得我们需要考虑“手性”或","date":"2023-06-09","objectID":"/differential_geometry/:4:3","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.4 外微分算子（Exterior Derivative） 外微分的定义如下： 外微分是一个映射 $\\mathrm{d}: \\bigwedge^n(T_p^*M)\\rightarrow \\bigwedge^{n+1}(T_p^*M)$ ，它作用到一个 $n$ 阶微分形式： $\\varphi=\\sum_{I}f_I\\mathrm{d}x^{I}=\\sum_{(i_1,\\cdots,i_n)}f_{(i_1,\\cdots,i_n)}\\mathrm{d}x^{i_1}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_n}$ 上，得到一个 $(n+1)$ 阶微分形式： $\\mathrm{d}\\varphi=\\sum_{I}\\sum_{i}\\frac{\\partial f_I}{\\partial x_i}\\mathrm{d}x_i\\wedge x_I$。 评论 这一堆指标太丑陋了，不如看下面的例子。 例 3.2 对于一个 3 维流形上的二阶微分形式： $\\varphi=z^2\\mathrm{d}x\\wedge\\mathrm{d}y+x\\sin y \\,\\mathrm{d}y\\wedge \\mathrm{d}z$ ，其外微分为： $$ \\begin{aligned} \\mathrm{d}\\varphi \u0026=\\left(\\frac{\\partial z^2}{\\partial x}\\mathrm{d}x+\\frac{\\partial z^2}{\\partial y}\\mathrm{d}y+\\frac{\\partial z^2}{\\partial z}\\mathrm{d}z\\right)\\wedge\\mathrm{d}x\\wedge\\mathrm{d}y \\\\ \u0026 +\\left(\\frac{\\partial (x\\sin y)}{\\partial x}\\mathrm{d}x+\\frac{\\partial (x\\sin y)}{\\partial y}\\mathrm{d}y+\\frac{\\partial (x\\sin y)}{\\partial z}\\mathrm{d}z\\right)\\wedge\\mathrm{d}y\\wedge\\mathrm{d}z \\\\ \u0026=(2z+\\sin y) \\,\\mathrm{d}x\\wedge\\mathrm{d}y\\wedge\\mathrm{d}z \\end{aligned} $$ 上文是一种显式的定义。我们也可以用外微分算子的性质来定义它自身。具体来说，外微分满足如下三个性质： a) 一个零阶微分形式（标量场） $f$ 的外微分定义为它的微分 $\\mathrm{d}f$ 。 b) 一个零阶微分形式（标量场）的二阶外微分 $\\mathrm{d}(\\mathrm{d}f)$ 等于零。 c) 对于任意两个 $n$ 阶微分形式 $\\alpha$ 和 $\\beta$ ，都有 $\\mathrm{d}(\\alpha \\wedge \\beta)=\\mathrm{d}\\alpha \\wedge \\beta + (-1)^n \\alpha \\wedge \\mathrm{d}\\beta$ 这三个性质也可以用来定义外微分。 评论 读者可以尝试从第一种定义出发，证明第二种定义中的性质 c)。这是一个很好的练习。 ","date":"2023-06-09","objectID":"/differential_geometry/:4:4","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.5 梯度、旋度、散度（Gradient, Curl, Divergence） 现在，我们可以回顾一下矢量微积分中的梯度、散度和旋度。它们都是外微分的表现形式。 在下面的例子（例 3.3）中，我们将会给出梯度与外微分的关系： 例 3.3 外微分算子 $\\mathrm{d}$ 作用到一个零阶微分形式（标量场）后，会得到一个一阶微分形式： $\\mathrm{d}f=\\frac{\\partial f}{\\partial x^i}\\mathrm{d}x^i$ 。 它可以写成梯度和切向量的内积： $\\mathrm{d}f:\\mathrm{d}f(v)=\\langle \\nabla f\\mid v \\rangle$ 换句话说，我们有一个由内积诱导的自然同构（见第 2.9 节）： $\\mathrm{d}f \\mapsto \\nabla f$ 。其中 $f$ 是一个零阶微分形式（标量场）。 用音乐同构（见第 2.9 节）的语言，我们还可以写成这样： $ \\nabla f= \\sharp \\mathrm{d}f$ 或 $ \\mathrm{d}f=\\flat\\nabla f $ 上述例子为梯度的定义提供了一些启发。现在，我们就可以来定义梯度了： 梯度定义为： $$ \\begin{aligned} \\nabla: \\,\\mathcal{F}_M\u0026\\rightarrow \\Gamma(TM) \\\\ f \u0026\\mapsto \\sharp \\mathrm{d} f \\end{aligned} $$ 其中 $f$ 是一个标量场（即零阶微分形式）。 评论 可以看出，如果没有定义内积，那么我们是定义不了梯度的（如果没有内积，我们就没有音乐同构 $\\sharp :\\mathrm{d}f \\mapsto \\nabla f $）。对于后面的散度和旋度也是如此。 换句话说，只有黎曼流形才有梯度，散度和旋度的概念。如果一个微分流形没有配备内积（度规张量）而成为黎曼流形的话，我们就不能在这个微分流形上讨论梯度，散度和旋度。 度规张量允许我们可以在切丛与余切丛之间来去自如（对于物理人来说，也就是指标的升降）。请记住这一点，我们后面定义旋度和散度时都要用到！ 在下面的例子（例 3.4）中，我们将会给出旋度与外微分的关系： 例 3.4 外微分算子 $\\mathrm{d}$ 作用到一个一阶微分形式（余切向量场）后，会得到一个二阶微分形式： $$ \\begin{aligned} \\mathrm{d}(f_i\\mathrm{d}x^i)\u0026=\\frac{\\partial f_1}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^1+\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^1+\\frac{\\partial f_1}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^1 \\\\ \u0026+\\frac{\\partial f_2}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^2+\\frac{\\partial f_2}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^2+\\frac{\\partial f_2}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^2 \\\\ \u0026+\\frac{\\partial f_3}{\\partial x^1}\\mathrm{d}x^1\\wedge\\mathrm{d}x^3+\\frac{\\partial f_3}{\\partial x^2}\\mathrm{d}x^2\\wedge\\mathrm{d}x^3+\\frac{\\partial f_3}{\\partial x^3}\\mathrm{d}x^3\\wedge\\mathrm{d}x^3 \\end{aligned} $$ 对它使用一次 Hodge 星算子，会得到一个一阶微分形式： $$ \\begin{aligned} \\star \\mathrm{d}(f_i\\mathrm{d}x^i)\u0026=\\phantom{+\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3}-\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3+\\frac{\\partial f_1}{\\partial x^3}\\mathrm{d}x^2 \\\\ \u0026\\phantom{=}+\\frac{\\partial f_2}{\\partial x^1}\\mathrm{d}x^3 \\phantom{ \\, \\, \\, \\,-\\frac{\\partial f_1}{\\partial x^2}\\mathrm{d}x^3} -\\frac{\\partial f_2}{\\partial x^3}\\mathrm{d}x^1 \\\\ \u0026\\phantom{=}-\\frac{\\partial f_3}{\\partial x^1}\\mathrm{d}x^2+\\frac{\\partial f_3}{\\partial x^2}\\mathrm{d}x^1 \\\\ \u0026=\\left(\\frac{\\partial f_3}{\\partial x^2}-\\frac{\\partial f_2}{\\partial x^3}\\right)\\mathrm{d}x^1 + \\left(\\frac{\\partial f_1}{\\partial x^3}-\\frac{\\partial f_3}{\\partial x^1}\\right)\\mathrm{d}x^2 + \\left(\\frac{\\partial f_2}{\\partial x^1}-\\frac{\\partial f_1}{\\partial x^2}\\right)\\mathrm{d}x^3 \\end{aligned} $$ 它可以写成旋度和切向量的内积： $\\star\\mathrm{d}f:\\star\\mathrm{d}f(v)=\\langle \\nabla \\times \\sharp f\\mid v \\rangle$ 注意到我们用了一个升号： $\\sharp$ 。这是因为旋度是作用在切向量场，而非余切向量场上的。具体来说，旋度 $\\nabla\\times$ 把切向量场映射成切向量场： $\\Gamma(TM)\\rightarrow \\Gamma(TM)$ 。但是 $f\\in \\Gamma(T^*M)$ 是一个余切向量场（一阶微分形式），因此我们先要给将它“升”为切向量场： $\\sharp f \\in \\Gamma(TM)$ 。 我们在第 3.7 节将会介绍什么是 Hodge 星算子，现在，你只需要知道，在 3 维流形上，Hodge 算子作用到一个的 n 阶微分形式上会得到一个 $(3-n)$ 阶微分形式。具体地，如果配备了度规 $\\langle\\mathrm{d}x^i,\\mathrm{d}x^j\\rangle=\\delta^{j}_i$ ，则有： $\\star(\\mathrm{d}x^i \\wedge \\mathrm{d}x^j)=\\mathrm{d}x^k$ ， $\\star\\mathrm{d}x^i = \\mathrm{d}x^j\\wedge \\mathrm{d}x^k$ ， $\\star(f \\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k)=f$ ， $\\star f=f \\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k$ 其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个偶置换。 回到上面的例子，我们有一个由内积诱导的自然同构（见第 2.9 节）： $\\sharp:\\star \\mathrm{d}f\\mapsto \\nabla\\times \\sharp f$ 或写成： $\\sharp \\star \\mathrm{d}f = \\nabla\\times \\sharp f$ 或写成： $\\star \\mathrm{d}f(v) = \\langle\\nabla\\times \\sharp f \\mid v\\rangle$ 其中 $f\\in \\Gamma(T^*M)$ 是一个一阶微分形式。 我们还可以写成： $\\nabla\\times F=\\sharp \\star \\mathrm{d} \\flat F$ 其中 $F\\in \\Gamma(TM)$ ， $\\flat F \\in \\Gamma(T^*M)$ 。 上述例子为旋度的定义提供了一些启发。现在，我们就可以来定义旋度了： 旋度定义为 $$ \\begin{aligned} (\\nabla\\times): \\, \\Gamma(TM)\u0026\\rightarrow \\Gamma\\left(\\bigwedge^{n-2} (TM)\\right)\\\\ F\u0026\\mapsto \\sharp \\star \\mathrm{d} \\flat F \\end{aligned} $$ 其中 $F\\in \\Gamma(TM)$ 是一个切向量场。 在下面的例子（例 3.5）中，我们将会给出散度与外微分之间的关系。 例 3.5 外微分算子 $\\mathrm{d}$ 作用到一个二阶微分形式后，得到一个三阶微分形式： $\\mathrm{d}(f_1\\mathrm{d}x^2\\wedge\\mathr","date":"2023-06-09","objectID":"/differential_geometry/:4:5","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.6 k-向量、赝矢量（k-vector, Pseudovector） 评论 你现在可能在想：形式（form）是余切向量的外积，但是切向量的外积是什么呢？ 实际上，它们也有名字，只不过它们的名字很朴素，就叫 n-向量（n-vector）。特别地，2-vector 也可以叫 bivector；3-vector 也可以叫 trivector。 我们在物理书中经常听到所谓“赝矢量”（pseudo-vector）和“赝标量”（pseudo-scalar）的说法。 实际上，在 3 维流形中，“赝矢量”就是两个切矢量的外积 $v\\in T_pM\\wedge T_pM=\\bigwedge^2(T_pM)$ ，“赝标量”就是三个切矢量的外积 $s\\in T_pM\\wedge T_pM\\wedge T_pM=\\bigwedge^3(T_pM)$ 。因为 $\\bigwedge^2(T_pM)$ 和 $\\bigwedge^1(T_pM)$ 之间有 Hodge 对偶关系，所以我们“误把”赝矢量当作矢量了。同理，因为 $\\bigwedge^3(T_pM)$ 和 $\\bigwedge^0(T_pM)$ （标量场）之间有 Hodge 对偶关系，所以我们“误把”赝标量当作标量了。 评论 实际上，3 维流形上的赝矢量，在数学上就是 2-矢量（bivector，2-vector）。它和 2-form 的定义是类似的，只不过 2-vector 在切空间的外积中，而 2-form 在余切空间的外积中。 现在来更正式地定义一下 n-向量（n-vector）：一个 n-向量 是 $\\bigwedge^n(T_pM)$ 中的一个元素。 同理，我们还可以定义 n-向量场为 $\\bigwedge^n(TM)=\\{(p,v)\\mid p\\in M,v\\in\\bigwedge^n(T_pM)\\}$ 。 评论 回想一下，我们之所以把“赝矢量”叫做“赝矢量”，是因为它们在空间反演变换下会有奇怪的行为。但是如果你把它当作两个矢量的外积，那么一切奇怪的行为都有了解释。 具体地，看下图，在空间反演变换下，磁场竟然调转了方向！这就类似于你往一个方向走，但是镜子里的你往另一个方向走。这实在是一个灵异现象。 磁场是一个 bivector。如果你把磁场看成 vector，就会出现图中这种灵异的现象。 实际上，某一点处的磁场并非一个 vector，而是一个 bivector。即 $B\\in (T_pM)\\wedge (T_pM)$ 。它的基为 $\\frac{\\partial}{\\partial x}\\wedge \\frac{\\partial}{\\partial y}, \\,\\frac{\\partial}{\\partial y}\\wedge \\frac{\\partial}{\\partial z}, \\,\\frac{\\partial}{\\partial z}\\wedge \\frac{\\partial}{\\partial x}$ 。 所以说，并没有什么灵异事件（欢迎收看《走近科学》！）。在空间反演变换下，磁场对应的两个 vector 分别都朝向了正确的方向，只不过人类非要用右手螺旋定则，将一个 bivector 通过 Hodge 对偶看成是一个 vector。这才导致了诡异现象的出现。 实际上，这样做只在三维流形中可行，因为只有在三维流形中，三减二才恰好等于一。在四维流形中，由于四减二等于二，我们不能把 bivector 看成是 vector，而只能看成是另一个 bivector，于是自然也就没有什么右手螺旋定则可言了。 当然，在四维流形中，我们照样是有旋度的，只不过四维流形的旋度是一个 bivector，而不是一个 vector。而 n 维流形上的旋度是一个 (n-2)-vector（见第 3.5 节）。 顺便一提，电场也是一个 bivector，它的基为 $\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial x}, \\,\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial y}, \\,\\frac{\\partial}{\\partial t}\\wedge \\frac{\\partial}{\\partial z}$ ，有一个时间维度。之所以它看起来不是“赝矢量”，是因为我们只考虑了空间反演变换，没有考虑时间反演变换。 ","date":"2023-06-09","objectID":"/differential_geometry/:4:6","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"3.7 霍奇对偶（Hodge Duality） 评论 你可能早就注意到了，在 $n$ 维流形上，一个 $k$ 阶微分形式与一个 $(n-k)$ 阶微分形式的基的数量是相同的！换句话说， $\\bigwedge^k(T^*M)$ 的维数等于 $\\bigwedge^{n-k}(T^*M)$ 的维数。这是因为我们有恒等式 $C_n^k = C_n^{n-k}$ 。 如果两个有限维线性空间的维数相同，那么它们就是同构的。也就是说， $\\bigwedge^k(T^*M)$ 与 $\\bigwedge^{n-k}(T^*M)$ 是同构的，但是这样的同构有无数多个。能否定义一个自然（典范）的同构才是我们关心的。 经过第 2.9 节的讨论，我们可以发现：单靠微分流形自身的结构，我们是无法导出典范同构的。我们需要配备了内积（或非退化双线性形式）的微分流形，即（伪）黎曼流形。 也就是说，我们需要请回我们的老朋友——内积（或非退化双线性形式）。在第 2.9 节中，我们通过内积诱导了从切丛 $TM$ 到余切丛 $T^*M$ 的典范同构。现在，我们通过内积来诱导从 $\\bigwedge^n(T^*M)$ 到 $\\bigwedge^{m-n}(T^*M)$ 的典范同构，它就是 Hodge 对偶。 评论 以下所有推导，不仅适用于 $k$ 阶形式 $\\alpha \\in \\bigwedge^k(T_p^*M)$ ，而且也适用于 k-vectors： $v\\in\\bigwedge^k(T_pM)$ 。 给定一个黎曼流形，我们已知 $T_p^*M$ 上的一个内积 $T_p^*M\\times T_p^*M\\rightarrow \\mathbb{R}$ ， 现在，我们需要通过这个 $T_p^*M$ 上的内积来诱导出一个 $\\bigwedge^k(T_p^*M)$ 上的内积 $\\bigwedge^k(T_p^*M)\\times \\bigwedge^k(T_p^*M)\\rightarrow \\mathbb{R}$ 。 有一个很自然的定义方式，记 $\\alpha = \\alpha_1\\wedge\\alpha_2\\wedge \\cdots\\wedge \\alpha_k \\in \\bigwedge^k(T_p^*M)$ ， $\\beta = \\beta_1\\wedge\\beta_2\\wedge \\cdots\\wedge \\beta_k \\in \\bigwedge^k(T_p^*M)$ ，我们可以定义 $\\bigwedge^k(T_p^*M)$ 上的内积 $\\langle\\alpha\\mid\\beta\\rangle$ 如下 $$ \\langle\\alpha\\mid\\beta\\rangle= \\begin{vmatrix} \\langle\\alpha_1\\mid\\beta_1\\rangle \u0026 \\cdots \u0026 \\langle\\alpha_1\\mid\\beta_k\\rangle \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\langle\\alpha_k\\mid\\beta_1\\rangle \u0026 \\cdots \u0026 \\langle\\alpha_k\\mid\\beta_k\\rangle \\end{vmatrix} $$ 定义了 $\\bigwedge^k(T_p^*M)$ 上的内积之后，我们就可以导出从 $\\bigwedge^k(T_p^*M)$ 到 $\\bigwedge^{n-k}(T_p^*M)$ 的典范同构。接下来，我们给出这个同构，也就是霍奇对偶的定义： 现有 $m$ 维流形上的一个 $n$ 阶微分形式 $\\beta$ ， 定义 $\\beta$ 的霍奇对偶为一个 $(m-n)$ 阶形式，记作 $\\star \\beta$ ，使得对于所有 $n$ 阶形式 $\\alpha\\in\\bigwedge^{n}(T_p^*M)$ ，都有下式成立： $\\alpha \\wedge (\\star\\beta)=\\langle\\alpha\\mid\\beta\\rangle \\,\\omega$ 。 其中 $\\langle\\cdot\\mid\\cdot\\rangle 是 \\bigwedge^n(T_p^*M)$ 上的内积； $\\omega$ 是单位正交基 $\\mathrm{d}x^1\\wedge \\mathrm{d}x^2\\wedge\\cdots\\wedge\\mathrm{d}x^m$ 构成的 $m$ 阶微分形式。 也可以将上式改写为： $\\mathrm{det}(\\alpha \\wedge \\star\\beta)=\\langle\\alpha\\mid\\beta\\rangle$ 这里 $\\mathrm{det}$ 的意思就是 $\\alpha \\wedge \\star\\beta \\in \\bigwedge^n(T^*_pM)$ 作为线性映射 $\\bigwedge^n(T_pM) \\rightarrow \\mathbb{R}$ 在单位正交基下的矩阵的行列式。这个矩阵其实是一个 $1\\times 1$ 的矩阵，因为 $\\bigwedge^n(T_pM)$ 的维数是 $C_n^n=1$ 。 我更喜欢第二种定义，它看起来更优雅。 我们再来用自然语言转述一遍： 在 $n$ 维流形上， $k$ 阶形式 $\\beta$ 的霍奇对偶 $\\star \\beta$ 是这样一个 $(n-k)$ 阶形式，使得对于任意一个 $k$ 阶形式 $\\alpha$ ， $\\alpha$ 与 $\\beta$ 的内积都等于 $\\alpha$ 与 $\\star \\beta$ 的外积（在单位正交基下的行列式）。 霍奇对偶将内积与外积这两个概念以一种很美妙的方式联系在了一起。 例 3.6 在三维流形上，给定 $T_p^*M$ 上的内积 $$ \\langle \\mathrm{d}x^i\\mid \\mathrm{d}x^j\\rangle=\\begin{cases} 1, \u0026i= j \\\\ 0, \u0026 i\\neq j \\end{cases} $$ 及其诱导的 $\\bigwedge^k(T_p^*M)$ 上的内积，那么 0-form，1-form，2-form，3-form 的霍奇对偶分别如下： $\\star f=f \\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k$ ， $\\star \\mathrm{d}x^i =\\mathrm{d}x^j\\wedge \\mathrm{d}x^k$ ， $\\star(\\mathrm{d}x^i \\wedge \\mathrm{d}x^j)=\\mathrm{d}x^k$ ， $\\star(f \\,\\mathrm{d}x^i \\wedge\\mathrm{d}x^j\\wedge \\mathrm{d}x^k)=f$ 其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个偶置换。 请读者自行验证。 评论 回忆我们上一节所讲到的“赝矢量”，在定义了 Hodge 对偶之后，它和 bivector 之间的关系就很自然了。这其实就是我们常说的“右手螺旋定则”。 评论 在讨论 Hodge 对偶的时候，我们总是已经给定了一个内积。或者说，内积是我们的先验知识。从这个的意义上来说，Hodge 对偶是一个自然（Natural）或者典范（Canonical）的同构。 对于物理人来说，Hodge 对偶当然是非常自然的。我们每次使用右手螺旋定则的时候，我们实际上都在不知不觉中使用了 Hodge 对偶。 接下来，我们给出 Hodge 对偶在欧几里得空间 $\\mathbb{R}^3$ 中的示意图： Hodge Duality 定义了 Hodge 对偶之后，我们就可以用外代数的语言来重写麦克斯韦方程了，见下例（例 3.7） 例 3.7 麦克斯韦方程（外代数版本） 定义电磁二阶微分形式为（采取自然单位制）: $$ \\begin{aligned} F \u0026=E_x\\mathrm{d}t\\wedge\\mathrm{d}x+E_y\\mathrm{d}t\\wedge\\mathrm{d}y+E_z\\mathrm{d}t\\wedge\\mathrm{d}z \\\\ \u0026+B_x \\mathrm{d}y\\wedge\\mathrm{d}z + B_y \\mathrm{d}z\\wedge\\mathrm{d}x + B_z\\mathrm{d}x\\wedge\\mathrm{d}y \\end{aligned} $$ 由于我们可以通过度规张量来任意升降一个张量的指标，所以对上式升指标，我们也可以写出一个 $(2,0)$ 型电磁张量，它以 $\\frac{\\partial}{\\partial t},\\frac{\\partial}{\\partial x},\\frac{\\partial}{\\partial y},\\frac{\\partial}{\\partial z}$ 的外积为基。不过我们暂时先采用 $(0,2)$ 型反对称张量（微分形式）的写法。反正在配备了度规的情况下， $(2,0)$ 型张量场与 $(0,2)$ 型张量场之间有典范同构，可以看作是等价的。 定义电流微分形式为： $J=-\\rho\\mathrm{d}t+J_x\\mathrm{d}x+J_y\\mathrm{d}y+J_z\\mathrm{d}z$ 至于内积，就是我们喜闻乐见的闵可夫斯基度规： $\\langle \\mathrm{d}t\\mid\\mathrm{d}t\\rangle=-1$ $\\langle \\mathrm{d}x\\mid\\mathrm{d}x\\rangle=\\langle \\mathrm","date":"2023-06-09","objectID":"/differential_geometry/:4:7","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"小结 在本章中，我们利用外代数研究了流形上的微分。具体来说： 首先，我们引入交替多重线性映射，并基于它定义了外积。把 0 阶、1 阶、…、n 阶的外积直和起来，我们就得到了外代数。在选读部分，我们还证明了这个定义与外代数的“正统”定义之间的等价性。 其次，我们引入形式，它生活在余切空间的外积中。微分形式则是“形式的场”，即为流形上的每一点都指派了一个形式。另外，我们介绍了外微分算子，它是微分在外代数上的推广。 最后，我们将上述理论应用到梯度、旋度、散度、赝矢量、赝标量这些耳熟能详的概念中，并且基于它们，进一步引入 Hodge 对偶的概念。Hodge 对偶以一种自然的方式将内积和外积联系在了一起。特别地，在三维流形上，它还可以诱导出叉积。我们每一次使用叉积和右手螺旋定则，我们都是在使用 Hodge 对偶。 ","date":"2023-06-09","objectID":"/differential_geometry/:4:8","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"第四章 流形上的导数 评论 在第三章中，我们研究了外微分（或称外导数，因为其英文名是 exterior derivative）。在本章中，我们介绍另外两种导数，即协变导数和李导数。 协变导数与李导数都是一个张量场在某一点关于某一个切向量的导数，即，它们都表示张量沿着某一个切向量的方向的变化。它们的区别在于，李导数要求知道该切向量的邻域的情况，而协变导数只需要知道该点的切向量即可。但是，协变导数需要配备一个度规才能被唯一确定下来。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.1 协变导数、联络（Covariant Derivative, Connection） 评论 虽然在 第 2.1 节 中我们定义了切空间，让流形上的矢量有了容身之所，但是我们还是无法直接比较两点的切矢量，因为点 $p$ 处的切空间与点 $q$ 处的切空间是两个不同的空间。 如果我们做不到这一点，后果是很严重的。想想经典力学中的加速度，为了定义它，我们需要比较 $t$ 时刻和 $t+\\epsilon$ 时刻的速度，而这两个速度矢量存在于不同的切空间中。如果我们没办法比较这两个速度矢量，那么我们甚至无法定义加速度！ 为了比较点 $p$ 处的矢量和点 $q$ 处的矢量，我们必须设法将点 $p$ 处的矢量平移（parallel transport）到点 $q$ 处。为了使该操作成为可能，我们需要一个联络（connection）。一个联络可以由一个 协变导数（covariant derivative） 来刻画。 之所以在欧几里德空间中我们没有注意到上述的问题，是因为欧几里德空间中有一个很自然的平移变换，自然到我们无法意识到每天都在使用它。 流形 $M$ 上某一点 $p$ 处的向量 $u$ 沿着另一个向量 $v$ 的协变导数记为 $\\nabla_v u$，它也是一个点 $p$ 处的向量。它表示向量 $u$ 沿着向量 $v$ 的变化量。 但协变导数实际上是作用在两个向量场上的：$\\nabla_W A$。对应到上文， $u$ 属于向量场 $A$，$v$ 属于向量场 $W$。 协变导数不仅可以作用在向量场 $A$ 上，还可以推广到作用在一般的张量场上（包括标量场，因为标量场也是一种特殊的张量场）。现在我们给出协变导数的定义： 协变导数是这样一个映射 $\\mathcal{T}^m_n(M)\\rightarrow \\mathcal{T}^m_n(M)$，满足下列性质： 线性： $$ \\nabla_W(\\lambda A+\\mu B) = \\lambda \\nabla_W A + \\mu \\nabla_W B $$ 对 $W$ 的 $\\mathcal{F}$-线性： $$ \\nabla_{V+fW} = \\nabla_V + f\\nabla_W \\quad f\\in\\mathcal{F}(M) $$ 莱布尼茨律 $$ \\nabla_W(A\\otimes B) = (\\nabla_W A)\\otimes B + A \\otimes (\\nabla_W B) $$ 与缩并运算对易 $$ \\nabla_W \\circ C = C \\circ \\nabla_W $$ 对于标量场 $f$，$\\nabla_W$ 作用到 $f$ 上等同于 $W$ 作用到 $f$ 上（见 第 2.2 节）： $$ \\nabla_W f = Wf $$ 现在，在表达式 $\\nabla_W A$ 中，令 $W=e_k$，其中 $e_k$ 是一个坐标系的其中一个基所构成的向量场，然后令 $A=e_j$，其中 $e_j$ 是坐标系的另外一个基所构成的向量场；那么，$\\nabla_{W}$ 作用到 $A$ 上就可以写成 $\\nabla_{e_k}e_j$，不妨将其简记为 $\\nabla_{k} e_j$。由于 $\\nabla_{k} e_j$ 也是一个向量场，我们可以将它写成向量场的线性组合：$$\\nabla_{k} e_j = \\Gamma^i_{jk}e_i.$$ $\\Gamma^i_{jk}$ 就是大名鼎鼎的 克氏符号（Christoffel symbol） 。我们有时候也称它为一个 线性联络（linear connection） 。 可以证明，$\\Gamma^i_{jk}$ 可以唯一确定一个协变导数。利用协变导数定义中的五个性质可以证明这一点，证略。 评论 现在停下来想一想 $\\Gamma^i_{jk}$ 三个下标分别的意思：$k$ 代表沿第 $k$ 个方向移动，$j$ 表示我们在考虑第 $j$ 个基的变化，$i$ 代表变化量在第 $i$ 个基上的分量。 注 可以证明，$\\Gamma^i_{jk}$ 并非一个张量。在数学上，一个张量的分量表示只是它的表象，在坐标变换下，张量本身是不变的，只是坐标变了。但是 $\\Gamma^i_{jk}$ 本身也会随着坐标系的变化而变化——它不满足张量的坐标变换规则。 但是有些作者认为，在给定了坐标系的意义下，可以说克氏符号是一个张量，或者说是“坐标系依赖的张量”。 现在，我们讨论协变导数的计算方法。 对于切向量场 $A^j\\partial_j$，由于我们已经知道 $\\nabla_k\\partial_j = \\Gamma^i_{jk} \\partial_i$，所以它的协变导数很容易计算： 例 4.1 计算切向量场 $A = A^j\\partial_j$ 的协变导数 $\\nabla_W A$。 解： $$ \\begin{aligned} \\nabla_W A \u0026= \\nabla_{W^k\\partial_k}(A^j\\partial_j) \\\\ \u0026\\stackrel{2}{=} W^k \\nabla_k (A^j\\partial_j) \\\\ \u0026\\stackrel{3,4}{=} W^k (\\nabla_k A^j \\partial_j + A^j \\nabla_k \\partial_j ) \\\\ \u0026\\stackrel{5}{=} W^k (\\partial_k A^j \\partial_j + A^j \\nabla_k \\partial_j ) \\\\ \u0026:= W^k (\\partial_k A^j \\partial_j + A^j \\Gamma^l_{jk}\\partial_l) \\\\ \u0026= W^k (\\partial_k A^l + A^j \\Gamma^l_{jk}) \\partial_l \\end{aligned} $$ 等号上的数字表示用到了哪一条性质。 可见，$\\nabla_W A$ 在 $\\partial_l$ 上的分量为： $$ (\\nabla_W A)^l = W^k (\\partial_k A^l + \\Gamma_{jk}^l A^j) $$ 从上式可以看出，协变导数 $\\nabla_W A$ 和对分量的导数 $W^k\\partial_k A$ 相差了一个克氏符号项。因此有些作者将克氏符号定义成 $\\nabla_k$ 和 $\\partial_k$ 在某种程度上的差。 计算了切向量场的协变导数之后，我们再来计算余切向量场 $\\alpha = \\alpha_j\\mathrm{d}x^j$ 的协变导数 $\\nabla_W \\alpha$。 我们下面先来计算 $\\nabla_k$ 作用到余切向量的一个基 $\\mathrm{d}x^j$ 上的表达式，即 $\\nabla_k \\mathrm{d}x^j$ 的表达式。 例 4.2 计算余切基向量的协变导数： $\\nabla_k \\mathrm{d}x^j$。 解： 由于协变导数与张量缩并运算对易，且满足莱布尼茨律，所以 $$ \\nabla_k(\\alpha(A)) = (\\nabla_k\\alpha)A + \\alpha(\\nabla_k A) $$ 选取 $\\alpha = \\mathrm{d}x^i$，$A=\\partial_j$，则有 $$ \\nabla_k(\\mathrm{d}x^i(\\partial_j)) = (\\nabla_k \\mathrm{d}x^i)\\partial_j + \\mathrm{d}x^i(\\nabla_k \\partial_j) $$ 注意，在上式中，我们对 $(1,1)$ 型张量进行了缩并运算。因此等式左边的 $\\mathrm{d}x^i(\\partial_j)$ 是一个常标量场（要么恒为1，要么恒为0），从而等式左边等于零。 移项（并进行缩并运算）得 $$ \\nabla_k \\mathrm{d}x^i = -\\Gamma^i_{jk}\\mathrm{d}x^j $$ 进一步地，$$ \\nabla_W \\mathrm{d}x^i = -(\\Gamma^i_{jk}W^k)\\mathrm{d}x^j $$ 对于一般的余切向量场 $\\alpha = \\alpha_j\\mathrm{d}x^j$，其协变导数的推导留给读者练习。提示：仿照 例 4.1 的方法。 现在我们有了切向量场和余切向量场的协变导数。那么，对于一般的 $(p,q)$ 型张量，它的协变导数 $(\\nabla_W A)^{i…j}_{k…l}$ 应该如何计算呢？这里我们直接给出公式。感兴趣的读者，可以利用 例 4.1 的方法和 例 4.2 的结果来自行推导（我保证，虽然这看起来很吓人，但实际上并不难）： 例 4.3 计算张量 $A$ 的协变导数 $(\\nabla_W A)^{i…j}_{k…l}$。 解（过程略）： $$ \\begin{aligned} (\\nabla_W A)^{i…j}_{k…l} \u0026 = W^{m} \\partial_{m} A^{i…j}_{k…l} \\\\ \u0026 - \\Gamma^{n}_{km} W^{m} A^{i…j}_{n…l} - \\cdots - \\Gamma^{n}_{lm} W^m A^{i…j}_{k…n} \\\\ \u0026 + \\Gamma^{i}_{nm} W^{m} A^{n…j}_{k…l} + \\cdots + \\Gamma^{j}_{nm} W^m A^{i…n}_{k…l} \\end{aligned} $$ ","date":"2023-06-09","objectID":"/differential_geometry/:5:1","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.2 黎曼-列维-奇维塔联络（Riemann-Levi-Civita Connection） 评论 到目前为止，给定一个流形，其上满足上述五个性质的协变导数有很多种。如何找到一个唯一的协变导数呢？ 你可能马上就想到了度规。的确，如果没有度规，那么协变导数的选取是相当任意的。我们没有理由选取一个特殊的协变导数。或者说，我们没有理由选取一个特殊的联络 $\\Gamma^i_{jk}$。 不过，实际上，为了诱导一个唯一的协变导数，我们不仅需要度规，还需要无挠性（torsion-free）。因此，我们下面先来介绍无挠性。 协变导数 $\\nabla$ 的无挠性定义如下： $$ \\nabla_V W - \\nabla_W V = [V, W] $$ 如果 $\\nabla$ 满足上式，那么我们称 $\\nabla$ 是无挠的。 评论 $[V, W]$ 定义为 $[V, W]: [V, W]f = V(W(f))-W(V(f))$ 值得注意的是，$VW: VW(f)=V(W(f))$ 一般不是一个向量场，但是 $VW-WV$ 的确是一个向量场，见第 4.8 节。 评论 虽然 $\\Gamma^i_{jk}: \\nabla_k e_j = \\Gamma^i_{jk} e_i $ 不是一个张量，但 $T(V,W) := \\nabla_V W - \\nabla_W V - [V, W]$ 确实是一个张量，它叫做挠率张量（torsion tensor），证略。 对于每一个协变导数，我们都可以定义一个挠率张量。当挠率张量为零时，我们说该协变导数是无挠的。 可以证明，$T(V,W)$ 在 $e^i$ 下的分量为 $ T^{i}_{jk}=\\Gamma^{i}_{kj}-\\Gamma^{i}_{jk} $ 。令 $T(V,W)$ 为零，我们就得到 $$ \\Gamma^i_{jk} = \\Gamma^i_{kj} $$ 协变导数的无挠性表现为 $ \\Gamma^i_{jk} = \\Gamma^i_{kj} $。 评论 容易看出，$T(V,W)$ 是一个反对称张量。令它为零，我们可以得到 $n\\cdot n(n-1)/2$ 个约束（对于三个指标 $i,j,k$ 而言），其中 $n$ 为流形的维数。 评论 无挠性还可以用如下方式定义：$\\nabla_a\\nabla_b f=\\nabla_b\\nabla_a f$，其中 $f\\in \\mathcal{F}(M)$ 是一个标量场。两种定义方式是等价的。 加上了无挠性之后，我们限制了可能的协变导数的数量，但是我们还不能将其限制到唯一一个。接下来我们考虑度规，从而将可能的协变导数限制到一个。 评论 为了将协变导数唯一确定下来，我们需要 $n^3$ 个约束。上面我们已经得到了 $n\\cdot n(n-1)/2$ 个约束，接下来，我们还需要 $n\\cdot n(n+1)/2$ 个约束，它们是由度规不变性得到的。 我们现在要求，协变导数应该保度规（preserves metric），或者说满足度规不变性。这是因为我们希望一个矢量在沿着一条曲线平移时，它的长度应当不变。换言之，我们要求度规张量的协变导数为零： $$ \\nabla_k g_{ij}=0 $$ 例 4.4 推导无挠且满足度规不变性的协变导数所对应的克氏符号的公式。换言之，写出 $\\Gamma^i_{ij}$ 关于 $g_{ij}$ 的表达式。 解： 根据 例 4.3，我们可以求得度规张量的协变导数： $$ \\nabla_k g_{ij} = \\partial_k g_{ij} - \\Gamma^l_{ik}g_{lj} - \\Gamma^l_{jk}g_{il} $$ 我们现在定义 第一类克氏符号（Christoffel Symbol of the first kind） 为 $\\Gamma_{ijk} = g_{il}\\Gamma^l_{jk}$。之前介绍的克氏符号 $\\Gamma^{i}_{jk}$ 其实属于 第二类克氏符号（Christoffel Symbol of the second kind）。 定义了第二类克氏符号 $\\Gamma_{ijk}$ 之后，上式就可以写为： $$ \\nabla_k g_{ij} = \\partial_k g_{ij} - \\Gamma_{jik} - \\Gamma_{ijk} $$ 令 $\\nabla_k g_{ij} = 0$，则有 $$ \\partial_k g_{ij} = \\Gamma_{ijk} + \\Gamma_{jik} $$ 又因为无挠性，我们有 $$ \\Gamma_{ijk} - \\Gamma_{ikj} = 0 $$ 综合以上两式，我们可以解出第一类克氏符号： $$ \\Gamma_{ijk} = \\frac{1}{2}(g_{ij,k} + g_{ik,j} - g_{jk,i}) $$ 其中 $g_{ij,k}:=\\partial_k g_{ij}$。由此，我们又可以得到第二类克氏符号： $$ \\Gamma^i_{jk} = \\frac{g^{il}}{2}(g_{lj,k}+g_{lk,j}-g_{jk,l}) $$ 因此，在给定无挠性和保度规性之后，协变导数可以被唯一确定下来。与该协变导数对应的联络 $\\Gamma^i_{ij}$ 叫做 黎曼联络（Riemann Connection） 或者 列维-奇维塔联络（Levi-Civita Connection） 。 由于涉及了三个人名，我们不妨干脆就叫它黎曼-列维-奇维塔联络，或者 RLC 联络，将三个人姓名的首字母都包含进去。注意，RLC 不是电阻、电感、电容的意思！ RLC 联络的表达式为 $$ \\Gamma^i_{jk} = \\frac{g^{il}}{2}(g_{lj,k}+g_{lk,j}-g_{jk,l}). $$ ","date":"2023-06-09","objectID":"/differential_geometry/:5:2","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.3 平移（Parallel Transport） 评论 在给定一个联络（协变导数）之后，我们就可以定义平移了。这也是我们定义联络的初衷：为了比较两处不同的点的矢量。 平移（Parallel Transport）定义如下： 给定 $M$ 上的一条曲线 $\\gamma: [0,T] \\rightarrow M$，以及点 $\\gamma(0)$ 处的一个向量 $V_0 \\in T_{\\gamma(0)}M$，定义 $V_0$ 沿着曲线 $\\gamma(t)$ 的平移 $V(t)$ 为如下方程的解： $$ \\nabla_{\\gamma^\\prime(t)}V(t) = 0 $$ 其中 $t\\in[0,T]$，$V(0)=V_0$。 评论 协变导数表示向量的变化，而平移是希望向量在移动的过程中不发生变化，因此我们可以用“沿曲线的协变导数为零”来定义平移。 下面我们推导平移的坐标表达式。为此，我们需要将 $\\nabla_{\\gamma^\\prime(t)}V(t)$ 展开（参照 例 4.1 ）： $$ \\begin{aligned} \\nabla_{\\gamma^\\prime(t)}V(t) \u0026= \\nabla_{\\frac{\\mathrm{d}\\gamma^k}{\\mathrm{d}t}\\partial_k}(V^j(t)\\partial_j) \\\\ \u0026 = \\frac{\\mathrm{d}\\gamma^k}{\\mathrm{d}t} (\\partial_k V^j \\partial_j + V^j \\Gamma^i_{jk} \\partial_i) \\\\ \u0026 = \\frac{\\mathrm{d}V^j}{\\mathrm{d}t} \\partial_j + \\frac{\\mathrm{d}\\gamma^k}{\\mathrm{d}t} V^j \\Gamma^i_{jk} \\partial_i \\\\ \u0026 = \\left(\\frac{\\mathrm{d}V^i}{\\mathrm{d}t} + \\frac{\\mathrm{d}\\gamma^k}{\\mathrm{d}t} V^j \\Gamma^i_{jk} \\right)\\partial_i \\end{aligned} $$ 令 $\\nabla_{\\gamma^\\prime(t)}V(t) = 0$，则有： $$ \\frac{\\mathrm{d}V^i}{\\mathrm{d}t} + \\Gamma^i_{jk} \\frac{\\mathrm{d}\\gamma^k}{\\mathrm{d}t} V^j = 0 $$ 这就是平移的公式。它是一组关于 $V^i$ 的一阶常微分方程。对其进行求解，既可得到向量 $V$ 沿着曲线 $\\gamma$ 平移后的坐标分量。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:3","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.4 测地线（Geodesics） 评论 回想一下牛顿第一定律。它说的是一个质点在不受到任何外部作用时，会保持它的速度不变。换句话说，它的加速度为零。 当这个质点处于我们所熟悉的欧式空间中时，由于欧式空间上有一个很自然的联络，我们可以很容易地对速度矢量进行平移。由这样的平移可以得出结论，该质点的运动轨迹是一条直线（或静止不动）。 但是，当我们处在一个一般的流形上时，情况变得不同：速度矢量的平移不再像欧式空间中那样的自然和平凡。因此，该质点的运动轨迹不再是欧式空间里的一条简单的直线。实际上，我们甚至没有定义流形上的“直线”是什么。 幸运的是，我们可以利用牛顿第一定律的思想来定义流形上的“直线”，并将其叫做测地线。具体来说，我们定义测地线是加速度为零的质点的运动轨迹。 不过在那之前，我们需要先定义加速度。 给定 $M$ 上的一条曲线 $\\gamma: [0, T] \\rightarrow M$，它在点 $\\gamma(t)$ 处的加速度定义为： $$ a(t) = \\nabla_{\\gamma^\\prime(t)}\\gamma^\\prime(t) = \\nabla_{v(t)}v(t) $$ 其中 $v(t):=\\gamma^\\prime(t)$ 为曲线在点 $\\gamma(t)$ 处的速度。 如果曲线的加速度处处为零，则称该曲线是一条测地线（geodesics），即有： $$ \\nabla_{\\gamma^\\prime(t)}\\gamma^\\prime(t) = 0 $$ 接下来，我们考察加速度的坐标表示： $$ \\begin{aligned} \\nabla_{v(t)}v(t) \u0026 = v^k \\nabla_k (v^j\\partial_j) \\\\ \u0026 = v^k (\\nabla_k v^j \\partial_j + v^j \\nabla_k \\partial_j ) \\\\ \u0026 = v^k (\\partial_k v^j \\partial_j + v^j \\Gamma^i_{jk} \\partial_i) \\\\ \u0026 = v^k (\\partial_k v^i + v^j \\Gamma^i_{jk}) \\partial_i \\\\ \u0026 = \\left(\\frac{\\mathrm{d} v^i}{\\mathrm{d}t} + \\Gamma^i_{jk} v^j v^k \\right) \\partial_i \\end{aligned} $$ 令加速度等于零，我们得到： $$ \\frac{\\mathrm{d} v^i}{\\mathrm{d}t} = -\\Gamma^i_{jk}v^jv^k $$ 这就是测地线方程（Geodesics Equation）。将 $v^i$ 写成 $\\frac{\\mathrm{d} \\gamma^i}{\\mathrm{d}t}$，我们有 $$ \\frac{\\mathrm{d}^2 \\gamma^i}{\\mathrm{d}t^2} = -\\Gamma^i_{jk}\\frac{\\mathrm{d} \\gamma^j}{\\mathrm{d}t}\\frac{\\mathrm{d} \\gamma^k}{\\mathrm{d}t} $$ 可见这是一组关于 $\\gamma(t)$ 的二阶常微分方程。对其进行求解，我们即可得到流形上的测地线的方程。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:4","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.5 曲率（Curvature） 评论 一般来说，点 $p$ 处的矢量通过不同的路径平移到点 $q$ 处，结果是不同的，这个现象叫做 Holonomy，它引出了曲率的概念。见下图： 北极处的一个矢量先沿经线平移至赤道，接着沿赤道平移，最后沿经线平移回到北极，和初始状态不重合。 现在，让我们考虑一个沿坐标系的环路，如下所示： 点 $p$ 处的矢量通过两条不同的路径平移到点 $q$ 处，结果不同 如图所示，点 $p$ 处的矢量通过两条不同的路径平移到点 $q$ 处。这两条路径分别是： 先改变 $x_\\nu$，再改变 $x_\\mu$； 先改变 $x_\\mu$，再改变 $x_\\nu$。 将这条环路不断缩小，那么切矢量的一个基 $e_\\beta$ 通过这两条路径平移的结果的差值可以表示为： $$ \\begin{aligned} \u0026 \\phantom{=} \\nabla_\\mu\\nabla_\\nu e_\\beta - \\nabla_\\nu\\nabla_\\mu e_\\beta \\\\ \u0026 = \\nabla_\\mu(\\Gamma^{\\alpha}_{\\beta\\nu}e_\\alpha) - \\nabla_\\nu(\\Gamma^{\\alpha}_{\\beta\\mu}e_\\alpha) \\\\ \u0026 = (\\partial_\\mu\\Gamma^{\\alpha}_{\\beta\\nu}) + \\Gamma^{\\alpha}_{\\beta\\nu}(\\nabla_\\mu e_\\alpha) - (\\nabla_\\nu\\Gamma^{\\alpha}_{\\beta\\mu})e_\\alpha - \\Gamma^{\\alpha}_{\\beta\\mu}(\\nabla_\\nu e_\\alpha)\\\\ \u0026 = (\\Gamma^{\\alpha}_{\\beta\\nu,\\mu} + \\Gamma^\\lambda_{\\beta\\nu}\\Gamma^{\\alpha}_{\\lambda\\mu} - \\Gamma^{\\alpha}_{\\beta\\mu,\\nu} - \\Gamma^\\lambda_{\\beta\\mu}\\Gamma^{\\alpha}_{\\lambda\\nu}) e_\\alpha \\end{aligned} $$ $\\Gamma^{\\alpha}_{\\beta\\nu,\\mu}$ 表示 $\\partial_\\mu \\Gamma^{\\alpha}_{\\beta\\nu}$。这是一个惯例，即用逗号 $A_{,\\alpha}$ 来表示关于分量的偏导 $\\partial_\\alpha A$。 有时候，我们还会用分号 $A_{;\\alpha}$ 来表示协变导数 $\\nabla_\\alpha A$。 令 $R^{\\alpha}_{\\beta\\mu\\nu} = \\Gamma^{\\alpha}_{\\beta\\nu,\\mu} - \\Gamma^{\\alpha}_{\\beta\\mu,\\nu} + \\Gamma^\\lambda_{\\beta\\nu}\\Gamma^{\\alpha}_{\\lambda\\mu} - \\Gamma^\\lambda_{\\beta\\mu}\\Gamma^{\\alpha}_{\\lambda\\nu}$，可以证明，$R^{\\alpha}_{\\beta\\mu\\nu}$ 是一个张量。我们称之为 黎曼曲率张量（Riemann Curvature Tensor）。 换言之，黎曼张量定义为： $$ \\begin{aligned} R^{\\alpha}_{\\beta\\mu\\nu} \u0026 := (\\nabla_\\mu\\nabla_\\nu e_\\beta - \\nabla_\\nu\\nabla_\\mu e_\\beta)^\\alpha \\\\ \u0026 = \\Gamma^{\\alpha}_{\\beta\\nu,\\mu} - \\Gamma^{\\alpha}_{\\beta\\mu,\\nu} + \\Gamma^\\lambda_{\\beta\\nu}\\Gamma^{\\alpha}_{\\lambda\\mu} - \\Gamma^\\lambda_{\\beta\\mu}\\Gamma^{\\alpha}_{\\lambda\\nu} \\end{aligned} $$ 评论 我们现在停下来想想黎曼曲率张量 $R^{\\alpha}_{\\beta\\mu\\nu}$ 的几何意义是什么。它表示第 $\\beta$ 个基通过两条不同的路径（先沿着 $x_\\mu$ 和先沿着 $x_\\nu$）平移的结果的差值的第 $\\alpha$ 个分量。 根据黎曼曲率张量的定义，我们立即就能得到它的一个性质：$R^\\alpha_{\\beta\\mu\\nu}$ = $R^\\alpha_{\\beta\\nu\\mu}$，利用这个性质，我们可以将 $n^4$ 个独立分量约束到 $n^3(n+1)/2$ 个。但是实际上，黎曼曲率张量还满足更多性质，这些性质可以将独立分量的个数约束到 $n^2(n^2-1)/12$ 个。我们这里暂时就不介绍这些性质了，感兴趣的读者可以阅读相关教材。 接下来，我们可以定义 里奇张量（Ricci Tensor）： $$ R_{\\beta\\nu} := R^\\lambda_{\\beta \\lambda \\nu} $$ 里奇张量是黎曼曲率张量经过缩并得到的。至于 $\\alpha$ 为什么和 $\\mu$ 缩并，而不是和 $\\nu$ 缩并：其实这两者只相差了一个负号。而如果让 $\\alpha$ 和 $\\beta$ 缩并，则会得到零，证略。 里奇张量是一个对称张量：$R_{\\mu\\nu}=R_{\\mu\\nu}$，证略。 最后，我们可以通过度规来得到里奇标量（Ricci curvature），或称标量曲率（scalar curvature）： $$ R = g^{\\mu\\nu}R_{\\mu\\nu} $$ ","date":"2023-06-09","objectID":"/differential_geometry/:5:5","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.6 广义相对论简介（Introduction to General Relativity） 广义相对论的核心——爱因斯坦场方程（Einstein Field Equations），给出了时空的曲率和物质运动之间的关系。前者描述时空如何弯曲，后者描述时空中能量和动量的演化。它们互为因果。 定义爱因斯坦张量 $G_{\\mu\\nu} := R_{\\mu\\nu}-\\frac{1}{2}Rg_{\\mu\\nu}$。则爱因斯坦场方程可以写成： $$ G_{\\mu\\nu} = \\frac{8\\pi G}{c^4} T_{\\mu\\nu} $$ 其中 $T_{\\mu\\nu}$ 叫做能动张量（Energy-Momentum Tensor）。 我们来解释一下能动张量，它有 16 个分量： $$ T = \\begin{pmatrix} T_{tt} \u0026 T_{tx} \u0026 T_{ty} \u0026 T_{tz} \\\\ T_{xt} \u0026 T_{xx} \u0026 T_{xy} \u0026 T_{xz} \\\\ T_{yt} \u0026 T_{yx} \u0026 T_{yy} \u0026 T_{yz} \\\\ T_{zt} \u0026 T_{zx} \u0026 T_{zy} \u0026 T_{zz} \\end{pmatrix} $$ 其中 $T_{tt}$ 代表能量密度，$(T_{tx}, T_{ty}, T_{tz})$ 代表动量密度，而 $$ \\begin{pmatrix} T_{xx} \u0026 T_{xy} \u0026 T_{xz} \\\\ T_{yx} \u0026 T_{yy} \u0026 T_{yz} \\\\ T_{zx} \u0026 T_{zy} \u0026 T_{zz} \\end{pmatrix} $$ 代表应力张量。特别地，对角元 $T_{xx},T_{yy},T_{zz}$ 分别代表三个方向上的压力。 评论 在爱因斯坦场方程 $G_{ab} = 8\\pi T_{ab}$（自然单位制）中，等式左边描述了时空如何弯曲，等式右边描述了物质如何演化。 就像麦克斯韦方程是电动力学的基本假设一样，爱因斯坦场方程也是广义相对论的基本假设，它不能从其他的式子中推导出来。 如果我们认为电动力学=麦克斯韦方程+求解+应用，那么我们在某种程度上也可以说广义相对论=爱因斯坦场方程+求解+应用。 例 4.5 施瓦西度规和施瓦西黑洞 施瓦西度规描述了一个无电荷、无角动量、且质量为 $M$ 的球体的周围的时空： $$ \\left\\{\\begin{aligned} g_{tt} \u0026= - (c^2 - \\frac{2GM}{r}) \\\\ g_{rr} \u0026= \\frac{1}{1-\\frac{2GM}{rc^2}} \\\\ g_{\\theta\\theta} \u0026= r^2 \\\\ g_{\\varphi\\varphi} \u0026= r^2 \\sin^2 \\theta \\\\ g_{\\text{otherwise}} \u0026= 0 \\end{aligned}\\right. $$ 它是爱因斯坦场方程的第一个非平凡的精确解。注意到 $r=\\frac{2GM}{c^2}$ 是度规的一个奇点。当然，由于施瓦西度规只适用于球体外的时空，当球体的半径 $R\u003e\\frac{2GM}{c^2}$ 时，这不是一个问题。 然而，如果球体的半径 $R\u003c\\frac{2GM}{c^2}$，那么该球体外的一个物体就有可能经过 $r=\\frac{2GM}{c^2}$。 而且，当 $r\u003c\\frac{2GM}{c^2}$ 时，$g_{rr}$ 由正变为负，$g_{tt}$ 由负变为正，换言之，$r$ 变成了一个类时坐标，这意味着在某种程度上，径向的空间维度变成了一个时间维度：落入中心将成为不可避免的未来。因此当 $R\u003c\\frac{2GM}{c^2}$ 时，球体会坍缩为一个很小的点（在广义相对论的模型中）。这就是常说的施瓦西黑洞。$r=\\frac{2GM}{c^2}$ 处的球面叫做事件视界。 施瓦西解的求解过程过于冗长，本文就不介绍了。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:6","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.7 拉回映射、推前映射（Pull-back, Push-Forward） 评论 拉回映射和推前映射是非常有用的概念。它们在以后要介绍的许多概念中都要被用到（包括下一节介绍的李导数）。因此单独用一节来介绍它们是很值得的。 让我们现在考虑一个从流形 $M$ 到流形 $N$ 的一个光滑映射 $\\phi: M\\rightarrow N$。如果 $N$ 上有一个标量场 $f$，那么借助 $\\phi$，我们可以诱导出一个 $M$ 上的标量场： $$ \\phi^* f := f \\circ \\phi $$ 其中 $\\phi^*$ 叫做拉回（pull-back），顾名思义，它将 $f$ 的定义域从 $M$ 上“拉回”到 $N$ 上。 评论 有一点需要注意，我们现在并没有假定 $\\phi$ 是一个双射。实际上，$\\phi$ 既不一定是单射，也不一定是满射。到目前为止，我们对 $\\phi$ 的唯一要求就是它是光滑的。如果 $\\phi$ 既是单射又是满射，那么它就是一个双射，从而是一个微分同胚（见第 1.8 节）。 现在，我们可以停下来思考一下，给定 $M$ 上的一个标量场，能否借助 $\\phi$ 将其“推前”到 $N$ 上？答案是否定的，因为 $\\phi$ 不一定是单射，也就是说 $M$ 上的多个点可能被映射到 $N$ 上的同一个点。因此，如果没有单射性的保证，那么我们就无法定义标量场的“推前”。 当然，我们现在可以直接假定 $\\phi$ 是一个微分同胚，然后我们就可以很开心的定义推前了。但在那之前，我们先来看看怎么定义切向量、余切向量乃至张量的推前和拉回。请耐心一点，因为我们想知道当 $\\phi$ 不是双射的时候会有什么样的结果。 现在，我们考虑切向量的 “推前”（push-forward）。借助标量场的拉回，我们可以定义某一点处的切向量的推前： $$ \\begin{aligned} \\phi_{*}: T_{p} M \u0026\\rightarrow T_{\\phi(p)} N \\\\ (\\phi_{*} v)|_{\\phi(p)} f \u0026:= v|_p(\\phi^{*} f) \\quad \\forall f \\end{aligned} $$ 选读 4.1 用切向量的另一种定义方式——曲线的等价类——也可以定义推前。考虑 $M$ 上一条经过点 $p$ 的曲线 $\\gamma$，这条曲线被 $\\phi$ 映射成 $N$ 上一条经过点 $\\phi(p)$ 的曲线 $\\phi \\circ \\gamma$。现在，我们希望 $M$ 上与曲线 $\\gamma$ 于点 $p$ 处相切的那个向量，被 $\\phi$ 推前到 $N$ 之后，同样在点 $\\phi(p)$ 处与 $\\phi \\circ \\gamma$ 相切。回想一下点 $p$ 处的切向量也可以被定义为曲线的等价类 $[\\gamma]$，即在点 $p$ 处的导数相同的所有曲线。于是我们可以定义推前映射如下： $$ \\phi_*[\\gamma] := [\\phi \\circ \\gamma] $$ 用人话来讲，就是曲线的切向量被推前为曲线的切向量。 评论 由于 $\\phi$ 不一定是单射，也不一定是满射，所以我们目前也还没有办法定义向量场的推前，而是只能定义某一点的向量的推前。这是因为： a. 如果 $\\phi$ 不是满射，那么 $M$ 上的向量只能被推前到 $N$ 上的 $\\phi$ 的像的部分，即 $N$ 上的向量场只在 $\\mathrm{Im}(\\phi)$ 部分有定义。 b. 如果 $\\phi$ 不是单射，那么 $M$ 上两个不同的点处的向量会被推前到 $N$ 上的同一点，这两个向量并不一定是相等的。 评论 刚才，我们借助标量的拉回，定义了切向量的推前。接下来，我们借助切向量的推前，来定义余切向量的拉回。 现在，我们考虑余切向量的拉回。借助切向量的推前，我们可以定义余切向量场的拉回： $$ \\begin{aligned} \\phi^*: \\mathcal{T}^0_1(N) \u0026\\rightarrow \\mathcal{T}^0_1(M) \\\\ \\phi^*\\omega(v|_p) \u0026:= \\omega((\\phi_* v)|_{\\phi(p)}) \\end{aligned} $$ 评论 注意到在这个定义中，我们不仅可以定义某一点处的余切向量的拉回，还可以对流形 $N$ 上的所有余切向量定义。 换言之，即使在 $\\phi$ 不是微分同胚的情况下，我们也可以定义余切向量场的拉回。 这看起来很奇妙，但仔细一想是非常合理的：如果我们能拉回一个标量场，那么我们应当也能拉回该标量场的微分，而微分就是一个余切向量场。 以同样的道理，我们可以定义 $(0,n)$ 型张量场的拉回： $$ \\begin{aligned} \\phi^*: \\mathcal{T}^0_l(N) \u0026\\rightarrow \\mathcal{T}^0_l(M) \\\\ \\phi^*T(v^1|_p, \\cdots, v^n|_p) \u0026:= T((\\phi_* v^1)|_{\\phi(p)}, \\cdots, (\\phi_* v^n)|_{\\phi(p)}) \\end{aligned} $$ 评论 到目前为止，我们定义了标量场的拉回、切向量（注意，不是切向量场）的推前、余切向量场的拉回、和 $(0,n)$ 型张量场的拉回。接下来，我们定义 $(l,0)$ 型张量（注意，不是张量场）的推前。 现在，我们定义某一点处的 $(m,0)$ 型张量的推前： $$ \\begin{aligned} \\phi_*: T^m_0|_pM \u0026\\rightarrow T^m_0|_p N \\\\ (\\phi_* T)|_{\\phi(p)}(\\omega_1, \\cdots, \\omega_m) \u0026:= T|_{p}(\\phi^* \\omega_1, \\cdots, \\phi^* \\omega_m) \\end{aligned} $$ 评论 之所以对于切向量和 $(m,0)$ 型张量，我们无法定义“场”的推前，还是因为之前提到过的原因，即 $\\phi$ 不一定是双射。 如果 $\\phi$ 不是双射（微分同胚），这就是我们能做到的最好了。因此接下来我们来附加一个额外条件，即 $\\phi$ 是一个微分同胚。此时，我们可以定义任何类型的张量场的拉回与推前。 现在，我们将 $\\phi$ 从一个从 $M$ 到 $N$ 光滑映射升级为一个从 $M$ 到 $N$ 的微分同胚。这样，我们就可以定义切向量场和 $(m,0)$ 型张量场的推前了： $$ \\begin{aligned} \\phi_*: \\mathcal{T}^m_0(M) \u0026\\rightarrow \\mathcal{T}^m_0(N) \\\\ (\\phi_* T)(\\omega_1, \\cdots, \\omega_m) \u0026:= T(\\phi^* \\omega_1, \\cdots, \\phi^* \\omega_m) \\end{aligned} $$ 不仅如此，我们还可以定义 $(m,0)$ 型张量场的拉回，这是因为我们可以将 $M$ 和 $N$ 的角色互换：借助 $\\phi$ 的拉回可以看作借助 $\\phi^{-1}$ 的推前，即 $\\phi^*=(\\phi^{-1})_*$： $$ \\begin{aligned} \\phi_*: \\mathcal{T}^m_0(N) \u0026\\rightarrow \\mathcal{T}^m_0(M) \\\\ (\\phi^* T)(\\omega_1, \\cdots, \\omega_m) \u0026= ((\\phi^{-1})_* T)(\\omega_1, \\cdots, \\omega_m) \\\\ \u0026:= T((\\phi^{-1})^* \\omega_1, \\cdots, (\\phi^{-1})^* \\omega_m) \\end{aligned} $$ 基于此，我们可以定义 $(m,n)$ 型张量场的拉回： $$ \\begin{aligned} \\phi^*: \\mathcal{T}^m_n(N) \u0026\\rightarrow \\mathcal{T}^m_n(M) \\\\ (\\phi^* T)(\\omega_1, \\cdots, \\omega_m, v^1, \\cdots, v^n) \u0026= T(\\phi_* \\omega_1, \\cdots, \\phi_* \\omega_m, (\\phi^{-1})^* v^1, \\cdots, (\\phi^{-1})^* v^n) \\end{aligned} $$ $(m,n)$ 型张量场的推前，只需要将 $\\phi^*=(\\phi^{-1})_{*}$ 代入上式即可得到： $$ \\begin{aligned} \\phi_*: \\mathcal{T}^m_n(M) \u0026\\rightarrow \\mathcal{T}^m_n(N) \\\\ (\\phi_* T)(\\omega_1, \\cdots, \\omega_m, v^1, \\cdots, v^n) \u0026= T((\\phi^{-1})_* \\omega_1, \\cdots, (\\phi^{-1})_* \\omega_m, \\phi^* v^1, \\cdots, \\phi^* v^n) \\end{aligned} $$ 最后，请读者自行推导拉回映射和推前映射的显式计算公式。与例 2.6类似，结果中包含雅可比矩阵。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:7","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.8 李导数（Lie Derivative） 评论 现在，对于协变导数的介绍已经告一段落。接下来，我们介绍另一种导数，叫做李导数。不过在那之前，我们还要介绍其他一些概念。 我们先来定义 积分曲线（integral curve）。给定一个切向量场，它的积分曲线是这样一条曲线，它在每一点的导数都等于该点处的切向量。 我们常说的电场线，就是电场的积分曲线。 无数条积分曲线很像一条河流。如果我们“随波逐流”，我们就会从流形上的一点漂移到另一点： $$ \\Phi_t: M\\rightarrow M \\quad \\gamma(0)\\mapsto \\gamma(t) $$ $\\phi_t$ 是一个微分同胚，证略。我们可以把 $\\Phi_t$ 叫做一个“流”。 既然每一点都会随着积分曲线流动到另一点，那么每一点处的张量也会随着点的流动而流动。这个想法应该怎么表达呢？上一节介绍的拉回映射此时就派上用场了： $$ \\Phi^*_t: \\mathcal{T}^p_q(M) \\rightarrow \\mathcal{T}^p_q(M) $$ $\\Phi^*_t$ 可以叫做李平移（Lie Transport）。注意到由于它是拉回映射，所以它的方向是逆着流的方向的。如果我们想要表达顺着流的方向，我们可以使用 $\\Phi^*_{-t}$。 现在你可能已经猜到我们要怎么定义李导数了：即让 $t\\rightarrow 0$： $$ \\begin{aligned} \\mathcal{L}_V A \u0026:= \\left.\\frac{\\mathrm{d}}{\\mathrm{d}t}\\right|_{t=0} (\\Phi^*_t A) \\\\ \u0026= \\lim_{\\epsilon\\rightarrow 0}\\frac{\\Phi^*_\\epsilon A - A}{\\epsilon} \\end{aligned} $$ 其中 $T \\in \\mathcal{T}^p_q(M)$ 是一个张量场。 可以证明，$\\mathcal{L}_V$ 满足如下性质： a. 导子 $$ \\begin{aligned} \\mathcal{L}_V(\\mu A + \\lambda B) \u0026= \\mu \\mathcal{L}_V A + \\lambda \\mathcal{L}_V B, \\\\ \\mathcal{L}_V (A \\otimes B) \u0026= (\\mathcal{L}_V A)\\otimes B + A \\otimes (\\mathcal{L}_V B) \\end{aligned} $$ 提示：证明 $\\phi^*(A \\otimes B) = (\\phi^* A) \\otimes (\\phi^* B)$，然后利用李导数的定义。 注意，这里的 $\\mu$ 和 $\\lambda$ 指的是常数而非标量场。 b. 与缩并可交换 $$ \\mathcal{L}_V \\circ C = C \\circ \\mathcal{L}_V $$ 提示：先证明拉回映射与缩并可交换，然后利用李导数的定义 c. $$ \\begin{aligned} \\mathcal{L}_V (A(W,\\cdots;\\alpha,\\cdots)) \u0026= (\\mathcal{L}_V A)(W,\\cdots;\\alpha,\\cdots) \\\\ \u0026+ A(\\mathcal{L}_V W,\\cdots;\\alpha,\\cdots) + \\cdots \\\\ \u0026+ A(W,\\cdots;\\mathcal{L}_V\\alpha,\\cdots) + \\cdots \\end{aligned} $$ 特别地， $$ \\mathcal{L}_V (\\alpha(W)) = (\\mathcal{L}_V \\alpha)(W) + \\alpha(\\mathcal{L}_V W) $$ 提示：先证明 $\\phi^*(A(W,\\cdots;\\alpha,\\cdots))=(\\phi^*A)(\\phi^*W,\\cdots;\\phi^*\\alpha,\\cdots)$，然后利用李导数的定义 上面是一些比较通用的性质。下面我们来看看一个李导数作用到具体的标量场、切向量场、余切向量场和一般的张量场之后会发生什么。 例 4.6 证明李导数作用到标量场上，有： $$ \\mathcal{L}_V f = V f = V^i f_{,i} $$ 其中逗号下标表示求偏导。即 $f_{,i}=\\frac{\\partial f}{\\partial x^i}$ 提示：利用拉回映射的定义和李导数的定义。 例 4.7 证明李导数作用到标量场的微分（余切向量场）上，有： $$ \\mathcal{L}_V(\\mathrm{d} f) = \\mathrm{d}(\\mathcal{L}_V f) = \\mathrm{d}(V f) $$ 提示：利用拉回映射在切向量场上的定义，证明拉回映射和微分算子可交换，即 $\\mathrm{d} \\phi^* = \\phi^* \\mathrm{d}$。 例 4.8 证明李导数作用到余切基向量上，有： $$ \\mathcal{L}_V (\\mathrm{d} x^i) = \\mathrm{d}(V^i) = V^i_{,j} \\mathrm{d}x^j $$ 提示：将 $f=x^i$ 代入 例 4.7 例 4.9 证明李导数作用到一般的余切向量场上，有： $$ \\mathcal{L}_V \\alpha = \\left[V^j(\\partial_j\\alpha_i) + (\\partial_i V^j) \\alpha_j \\right]\\mathrm{d} x^i $$ 提示：将 $\\alpha = \\alpha_i\\mathrm{d}x^i$ 看成是标量场和微分 $\\mathrm{d}x$ 的张量积，即 $\\alpha = \\alpha_i \\otimes \\mathrm{d}x^i$，然后利用李导数的导子性。 例 4.10 证明李导数作用到切向量基上，有： $$ \\mathcal{L}_V \\partial_i = -V^j_{,i}\\partial_{j} $$ 提示：参照例 4.2的方法。 例 4.11 对于一般的张量场，求李导数的公式如下： $$ \\begin{aligned} (\\mathcal{L}_V A)^{i…j}_{k…l} \u0026= V^m A^{i…j}_{k…l,m} + \\\\ \u0026+ V^m_{,k} A^{i…j}_{m…l} + \\cdots + V^m_{,l} A^{i…j}_{k…m} \\\\ \u0026- V^i_{,m}A^{m…j}_{k…l} + \\cdots - V^j_{,m} A^{i…m}_{k…l} \\end{aligned} $$ 利用 例 4.8,10 的结果和 例 4.9 介绍的方法，读者可以自行完成推导。 你可能感觉 例 4.11 的公式很眼熟。没错，推导李导数的显式公式的步骤，和推导协变导数的显式公式的步骤（例 4.3）几乎是一样的。两个公式长得也很像。下面我们把它们放在一起比较一下： 李导数： $$ \\begin{aligned} (\\mathcal{L}_V A)^{i…j}_{k…l} \u0026= V^m A^{i…j}_{k…l,m} + \\\\ \u0026+ V^m_{,k} A^{i…j}_{m…l} + \\cdots + V^m_{,l} A^{i…j}_{k…m} \\\\ \u0026+ V^i_{,m}A^{m…j}_{k…l} + \\cdots + V^j_{,m} A^{i…m}_{k…l} \\end{aligned} $$ 协变导数： $$ \\begin{aligned} (\\nabla_W A)^{i…j}_{k…l} \u0026 = W^{m} \\partial_{m} A^{i…j}_{k…l} \\\\ \u0026 - \\Gamma^{n}_{km} W^{m} A^{i…j}_{n…l} - \\cdots - \\Gamma^{n}_{lm} W^m A^{i…j}_{k…n} \\\\ \u0026 + \\Gamma^{i}_{nm} W^{m} A^{n…j}_{k…l} + \\cdots + \\Gamma^{j}_{nm} W^m A^{i…n}_{k…l} \\end{aligned} $$ 我们现在来说明李导数与李代数的关系。 例 4.12 证明 $$\\mathcal{L}_V W = [V, W] := VW - WV$$ 提示：利用例 4.11 一般来说，$V$ 和 $W$ 的“积”（即 $VW:f\\mapsto V(Wf)$） 不是一个向量场，但是通过 例 4.12 我们发现，$VW-WV$ 的确是一个向量场。换句话说，一阶求导算子的“积”不是一阶求导算子，但它们的对易子竟然是！ 可以证明，全体向量场的集合，配备上一个二元运算 $[\\cdot, \\cdot]$ ，可以构成一个李代数，即满足如下关系： a. $[V,W]=-[W,V]$ b. $[\\mu V_1+\\lambda V_2, W] = \\mu [V_1, W] + \\lambda [V_2, W]$ c. $0 = [[V,W],U] + [[U,V],W] + [[W,U],V]$ 评论 最后，利用李导数，我们可以更漂亮地定义散度。 在第 3.5 节我们定义散度为： $$ (\\nabla\\cdot) : F \\mapsto \\star \\mathrm{d} \\star \\flat F $$ 在学习了李导数之后，我们可以给散度一个更漂亮的定义： $$ \\mathcal{L}_V \\omega","date":"2023-06-09","objectID":"/differential_geometry/:5:8","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.9 Holonomy Holonomy 我实在不知道怎么翻译了，干脆就不翻译吧。 在 第 4.5 节 中，我们通过考察一个张量先沿着坐标线 $\\mu$ 平移再沿着坐标线 $\\nu$ 平移很短一段距离，和先沿着 $\\nu$ 再沿着 $\\mu$ 平移很短一段距离，有什么区别。通过这种方法，我们导出了黎曼张量。这是针对协变导数而言的。 我们现在想要知道，对于李导数而言，一个点先沿着向量场 $V$ 流动，再沿着向量场 $W$ 流动很短一段距离，和先沿着 $V$ 再沿着 $W$ 流动很短一段距离有什么区别。这就引出了 Holonomy 的概念。 为了研究交换流动顺序的区别，我们先来想办法对短距离的流动做一个近似。首先，很容易证明 $\\Phi^*_t = 1 + t \\mathcal{L}_V + o(t)$。那么，我们能不能把这个近似逼近到更高的阶数？答案是可以的。 例 4.13 李导数的指数 证明 $\\Phi^*_t = e^{t\\mathcal{L}_V} = 1 + t\\mathcal{L}_V + \\frac{t^2}{2}\\mathcal{L}_V\\mathcal{L}_V + \\cdots$。 提示：利用 $\\frac{\\mathrm{d}}{\\mathrm{d} t} \\Phi^*_t=\\left.\\frac{\\mathrm{d}}{\\mathrm{d} s}\\right|_{s=0}\\Phi^*_{t+s} $ 证明 $\\frac{\\mathrm{d}}{\\mathrm{d} t}\\Phi^*_t=\\Phi^*_t\\mathcal{L}_V$ 下面，我们再考察算子的指数有什么样的性质： 例 4.14 算子的矩阵 证明 $e^{A+B}\\neq e^A e^B$，且 $$ e^{tA}e^{tB}-e^{t(A+B)} = \\frac{t^2}{2}[A,B] + o(t^2) $$ 于是 $$ e^{-tA}e^{-tB}e^{tA}e^{tB} = 1 + t^2[A,B] + o(t^2) $$ 提示：直接展开算就完了。 根据 例 4.13,14，我们会发现，当精确到二阶的时候，一个点先沿着向量场 $V$ 流动，再沿着向量场 $W$ 流动很短一段距离，和先沿着 $V$ 再沿着 $W$ 流动很短一段距离的差，可以用 $[V,W]$ 来刻画，即有 $$ \\Phi^W_{-\\epsilon} \\Phi^V_{-\\epsilon} \\Phi^W_{\\epsilon} \\Phi^V_{\\epsilon} = \\Phi^{[V,W]}_{\\epsilon^2} + o(\\epsilon^2) $$ 为了流动一圈后能回到原来的位置，我们需要补上最后一小段距离，见下图： Non-Holonomy 可见 $[V,W]$ 的几何意义。 如果坐标系的对易子 $[e^i, e^j] = 0$，则称这是一个 Holonomic 的坐标系，否则是 Non-holonomic 的坐标系。一个 Non-holonomic 的坐标系不能被表示为沿坐标线的求导。这是因为 $[\\partial^i, \\partial^j]=0$。 评论 借助这一套语言，我们给出在第 4.5 节中定义的曲率张量的另外一种更好的定义： 考虑上图的环路，让张量沿着这一条环路平移，回到原点。可以证明，该平移算子可以被表示为： $$ \\tau_{A\\rightarrow B\\rightarrow C \\rightarrow D \\rightarrow E \\rightarrow A} = 1 - \\epsilon^2 R(V,W) $$ 其中 $$ R(V,W) := \\nabla_V\\nabla_W - \\nabla_W\\nabla_V - \\nabla_{[U,V]} $$ 就是黎曼曲率张量。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:9","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"4.10 Killing 向量场（Killing Vector Field） 在 第 4.2 节 中，我们对协变导数提出了保度规的要求，从而对其进行了一定的约束。再加上无挠性的约束，就唯一确定了一个联络，称为 RLC 联络。 那么，对于李导数，我们可不可以也做出这样的约束呢？答案是，这样做会产生“过度约束”，即给定一个度规，我们不能保证存在一个李导数，使得该李导数保度规。满足这中性质的李导数对应的向量场叫做 Killing 向量场。记一个 Killing 向量场为 $\\ksi$，它满足 Killing 方程： $$ \\mathcal{L}_{\\xi} g = 0 $$ 根据例 4.11，其分量形式为： $$ \\xi^k g_{ij,k} + \\xi^k_{,i}g_{kj} + \\xi^k_{,j}g_{ik} = 0 $$ 由于 $g_{ij}=g_{ji}$，所以 Killing 方程组共有 $n(n+1)/2$ 个。然而，自由变量只有 $n$ 个（即 $\\xi^k, k=1,…,n$），所以这是一个“过度约束”的方程组，并不保证有解。 例 4.15 求欧式空间 $\\mathbb{R}^2$ 的 Killing 向量场。 解为 $e_1=\\partial_x, e_2=\\partial_y, e_3=-y\\partial_x + x\\partial_y$ 另外，如果只要求“共形”（conformal），即保角性，那么只需要满足下式即可： $$ \\mathcal{L}_{\\xi} g = \\chi g, \\quad \\chi \\in \\mathcal{F}(M) $$ 上式叫做共形 Killing 方程。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:10","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"小结 在本章中，我们引入两种导数，即协变导数和李导数。协变导数描述了流形上的联络，并可以用来定义平移、测地线和曲率。基于这些概念，我们就可以简要介绍广义相对论； 李导数描述了流形上向量场的“流动”，它引出了 Holonomy 和 Killing 向量场，前者刻画流动是否与路径相关，后者刻画流动是否具有度规不变性。用李导数我们可以更加优雅地定义曲率、挠率、散度等概念。 ","date":"2023-06-09","objectID":"/differential_geometry/:5:11","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"第五章 流形上的积分 在第三章中，我们研究了流形上的微分形式。在本章中，我们研究如何在流形上对微分形式进行积分。 首先，我们定义积分的“区域”是什么。例如，在初等微积分中，我们既可以在曲线上积分，也可以在曲面上积分。这些“区域”在流形上的推广就是胞腔、单形和链。基于它们，我们还可以定义边界算子。 其次，我们给出微分形式的积分的一个定义，然后介绍大名鼎鼎的斯托克斯定理。这个定理给出了边界算子 $\\delta$ 和外导数算子 $\\mathrm{d}$ 之间的关系。 最后，既然已经介绍了边界算子 $\\delta$ 、外导数算子 $\\mathrm{d}$ 、以及斯托克斯定理，那么我们就不得不提到同调和上同调。同调和上同调理论将以上所有概念都以一种不可思议的方式联系在了一起，并用它们来处理流形上的“孔洞”。 ","date":"2023-06-09","objectID":"/differential_geometry/:6:0","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"5.1 胞腔、单形、链（Cell, Simplex, Chain） 一个 $m$ 维胞腔（m-cell） $\\sigma$ ，指的是 $n$ 维流形上的一个参数化（parameterized）的 $m$ 维区域，是 $\\phi:[0,1]^m\\rightarrow M$ 这个映射的像 $\\sigma=\\mathrm{Im}(\\phi)$ 。 也可以这么理解：一个 m-cell 为流形 $M$ 上的一个 $m$ 维区域中的每个点分配一个参数： $\\mathbf{u}\\in[0,1]^m$ 。 我们说这个 $m$ 维区域是镶嵌（embedded）到 $n$ 维流形中的。或者说它是 $n$ 维流形上的一个 $m$ 维超曲面。 例 5.1 某流形上的一个点是一个 0-cell。0-cell 是一种特殊情况，它所代表的区域就仅仅是一个点。 2 维球面 $S^2$ 上的一条曲线是一个 1-cell（你可以想象地球仪上的北纬 30 度线）。我们为这条线上的每一个点分配一个参数 $[0,1]\\rightarrow S^2$ 。显然，并非每个点对应唯一的一个参数。如果这条曲线与自己相交，那么相交的点会对应两个不同的参数 $u_1\\neq u_2\\in [0,1]$ 。 流形 $M=\\mathbb{R}^3$ 中的一个曲面是一个 2-cell。我们为这个曲面上的每一个点分配一组参数 $[0,1]\\times[0,1]\\rightarrow \\mathbb{R}^3$ 。 更具体地，考虑一个第一象限中的 1/8 单位球面，我们可以这样分配参数： $\\phi:[0,1]^2 \\rightarrow\\mathbb{R}^3$ ，使得 $\\phi(u,v)\\rightarrow \\left(\\cos(\\frac{\\pi}{2} u)\\sin(\\frac{\\pi}{2} v), \\sin(\\frac{\\pi}{2} u)\\sin(\\frac{\\pi}{2} v), \\cos(\\frac{\\pi}{2} v)\\right)$ 。 评论 在第 1.8 节中，我们已经为流形 $M$ 指定好了一系列开覆盖和坐标系（Atlas）。现在我们所说的“参数”与当时说的“坐标”是两个不同的概念。“参数”指的是为嵌入在 $n$ 维流形中的一个 $m$ 维曲面上的点分配的，而“坐标”是为流形本身所有的点分配的。 在上例中，我们可以用 $u$ 和 $v$ 这两个参数来表示 1/8 单位球面上的点。但是对于例子中的 $\\mathbb{R}^3$ 这个流形，我们本身就有一个很自然的坐标 $\\mathrm{id}:\\mathbb{R}^3\\rightarrow\\mathbb{R}^3$ ，它是一个恒等映射。 还有一种参数化的方式，叫做 $m$ 维单形（m-simplex, pl. m-simplices）。与 $m$ 维胞腔使用的矩形区域 $[0,1]^m$ 不同，它使用的是三角形区域 $\\left\\{(\\theta_0,\\cdots,\\theta_m)\\mid\\sum_i\\theta_i=1, \\, \\theta_i\\ge 0\\right\\}$ 。这个三角形区域叫做 $\\mathbb{R^m}$ 中的标准单形。它关于 $\\varphi$ 在流形上的像，就是流形上的一个 m-simplex。 评论 从计算积分的角度来说，m-cells 更方便一些，但是在考虑拓扑与几何性质的时候，m-simplex 更方便一些。例如，我们可以对一个流形进行三角化（Triangulation），这往往比考虑矩形要方便得多，如下所示： Triangulation 一个 m-链（m-chain）指的是一系列 m-cells（或 m-simplices）的线性组合： $c=\\sum_i c_i\\sigma_i,\\quad m_i\\in \\mathbb{Z}$ m-chain 的集合记作 $C_m(M)$ 。 评论 你可能现在很好奇 $c=\\sum_i m_i\\sigma_i$ 究竟指的是什么，即，把两个 m-cells 加在一起到底是什么意思？别着急，我们会在第 5.3 节介绍这个线性组合的意义。现在你只需要把它当作一种“形式上”的线性组合（formal linear combination）。 另外，注意到线性组合的系数只能是整数，这使得 $C_m(M)$ 并不构成一个向量空间，而是构成一个模（Module）。模和向量空间的区别在于模的数乘运算是 $R\\times V \\rightarrow V$，而不是 $F \\times V \\rightarrow V$，其中 $R$ 代表一个环，$F$ 代表一个域。由于整数集不构成域，而是只能构成环，因此 $C_m(M)$ 是一个模。 ","date":"2023-06-09","objectID":"/differential_geometry/:6:1","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"5.2 边界算子（Boundary Operator） 评论 现在我们来考虑如何定义一块区域的边界。有了胞腔/单形和链的概念之后，我们就可以来形式化地定义边界了。 一个 (m+1)-cell，也就是 $\\phi: [0,1]^{m+1} \\rightarrow M$ 的像 $\\sigma = \\mathrm{Im}(\\phi)$。它的边界 $\\partial \\sigma$ 定义为下述的 m-chain ： $$ \\sum_{i=0}^{m}(-1)^i [\\phi(x_0,\\cdots,x_{i-1},1,x_{i+1},\\cdots,x_{m}) - \\phi(x_1,\\cdots,x_{i-1},0,x_{i+1},\\cdots,x_{m})] $$ 一个 m-chain（$c_i\\sigma_i$）的边界定义为 $$\\partial(c_i\\sigma_i):=c_i\\partial(\\sigma_i).$$ 我们将 $\\partial: C_{m+1}(M)\\rightarrow C_{m}(M)$ 称为边界算子。 例 5.2 一个 1-cell（一条曲线）$\\phi: [0,1]\\rightarrow M$ 的边界是一个 0-chain： $\\phi(1) - \\phi(0)$。 这里 $\\phi(1) - \\phi(0)$ 是抽象意义上的两个点（0-cell）的线性组合。 特别地，如果这条曲线（1-cell）首尾相接，即 $\\phi(1)=\\phi(0)$，则它的边界为零。 可见，当我们说一个首尾相接的曲线没有“边界”时，我们实际上是在说它的边界为零。 例 5.3 考虑流形 $\\mathbb{R}^2$ 上的一个 2-cell：$\\phi: [0,1]\\times [0,1] \\rightarrow \\mathbb{R}^2$，$\\phi(r,\\theta) = (r\\cos \\theta, r\\sin \\theta)$。它实际上是第一象限中的 1/4 圆。 该 2-cell 的边界是如下的 1-chain: $$ (\\phi(1,\\theta)-\\phi(0,\\theta)) - (\\phi(r,1) - \\phi(r,0)) $$ 可以看出，这四个 1-cell 分别对应 1/4 圆弧、原点、$y$ 方向上的半径和 $x$ 方向上的半径，它们的确构成了这个 1/4 圆盘的“边界”。如果我们把正负号解读为方向，我们还可以得到一个有方向的环路。 用单形（simplex）的语言也可以定义边界。如果将一个 m-simplex 记作 $$ \\langle p_0 ,\\cdots, p_m \\rangle $$ 其中 $p_0, \\cdots, p_m$ 代表单形的顶点（即标准单形的顶点的像）；那么该 m-simplex 的边界是下述的 (m-1)-simplex： $$ \\partial(\\langle p_0 ,\\cdots, p_m \\rangle) := \\sum_i^m (-1)^i \\langle p_0 ,\\cdots, p_{i-1}, p_{i+1}, \\cdots, p_m \\rangle $$ 可见，m-cell 和 m-simplex 是两套平行的语言。 与外微分算子类似，边界算子作用两次之后也会得到零： 定理 5.1 $\\partial\\partial=0$。证略。 ","date":"2023-06-09","objectID":"/differential_geometry/:6:2","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"5.3 微分形式的积分（Integration of Differential Forms） 评论 当我们对一个微分形式进行积分的时候，我们总是要指定一个积分的“区域”。这个“区域”就是我们在第 5.1 节中介绍的 m-cells / m-chains。 回想一下，一个 m-cell，记为 $\\sigma$ ，是 $\\phi:[0,1]^m\\rightarrow M$ 这个映射的像 $\\mathrm{Im}(\\phi)$ ，它其实就是 $n$ 维流形上的一个 $m$ 维超曲面。接下来我们定义微分形式在一个 m-cell 上的积分。 在微分几何中，积分的定义涉及到拉回映射（见第 4.7 节）的概念。具体来说，$\\omega$ 在 $\\sigma$ 上的积分定义为 $\\phi^*\\omega$ 在 $[0,1]^m$ 上的重积分。其中 $\\phi^*\\omega$ 表示 $\\phi$ 这个映射将 $\\omega$ 从流形上的区域 $\\sigma$ 拉回到 $\\mathbb{R}^m$ 中的区域 $[0,1]^m\\subseteq \\mathbb{R}^m$ 。也就是说 $\\phi^*\\omega$ 是 $\\mathbb{R}^m$ 上的一个微分形式。 现在，我们将以上的关系总结为数学语言： $$ \\int_{\\sigma} \\omega = \\int_{\\phi[D]} \\omega := \\int_{D} \\phi^{*} \\omega $$ 其中 $\\phi[D]$ 代表一个 m-cell 或者一个 m-simplex。这取决于你使用胞腔的语言还是单形的语言。例如，如果是胞腔，那么 $D$ 代表一个矩形区域 $[0,1]^m \\in \\mathbb{R}^m$。 评论 由于微分形式可以看成一个反对称的 $(0,q)$ 型张量场，因此我们在第 4.7 节中介绍的拉回映射完全可以作用到一个微分形式上。 现在，我们给出微分形式在一个 m-cell 上的积分的显式公式。 根据 第 3.3 节 末，我们可以记一个微分形式 $\\omega$ 为： $$ \\begin{aligned} \\omega = \\sum_{i_1\u003c\\cdots\u003ci_m} f_{(i_1,\\cdots,i_m)}\\mathrm{d}x^{i_1}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_m} \\end{aligned} $$ 为了方便起见，我们可以规定 $(i_1, \\cdots, i_m)$ 是 $(1, \\cdots, m)$ 的偶置换。 那么 $\\omega$ 在 $\\sigma$ 上的积分可以显式写成： $$ \\begin{aligned} \\int_\\sigma \\omega=\\int_{[0,1]^m}\\sum_{i_1\u003c\\cdots\u003ci_m} f_{(i_1,\\cdots,i_m)}|_{\\phi( \\mathbf{u})}\\frac{\\partial(x^{i_1},\\cdots,x^{i_m})}{\\partial(u^1,\\cdots,u^m)}\\mathrm{d}u^1\\cdots\\mathrm{d}u^m \\end{aligned} $$ 其中 $(u^1,\\cdots,u^m)\\in[0,1]^m$ ；$\\frac{\\partial(x^{i_1},\\cdots,x^{i_m})}{\\partial(u^1,\\cdots,u^m)}$ 是雅可比行列式： $$ \\frac{\\partial(x^{i_1},\\cdots,x^{i_m})}{\\partial(u^1,\\cdots,u^m)} := \\begin{vmatrix} \\frac{\\partial x^{i_1}}{\\partial u^1} \u0026 \\cdots \u0026 \\frac{\\partial x^{i_1}}{\\partial u^m} \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\frac{\\partial x^{i_m}}{\\partial u^1} \u0026 \\cdots \u0026 \\frac{\\partial x^{i_m}}{\\partial u^m} \\end{vmatrix} $$ 注意，等式右边就是一个普通的重积分，而重积分在我们学习初等微积分时已经有过完善的讨论，因此不再赘述。 评论 为了从定义出发得到积分的显式关系式，我们需要花一些精力。 具体来说，我们首先需要回想一下第 4.7 节介绍的 $(0,n)$ 型张量场的拉回： $$ \\begin{aligned} \\phi^*: \\mathcal{T}^0_l(N) \u0026\\rightarrow \\mathcal{T}^0_l(M) \\\\ \\phi^*T(v^1|_p, \\cdots, v^n|_p) \u0026:= T((\\phi_* v^1)|_{\\phi(p)}, \\cdots, (\\phi_* v^n)|_{\\phi(p)}) \\end{aligned} $$ 并且导出它的显式形式： $$ \\phi^*(\\mathrm{d}y^k \\otimes \\cdots \\otimes \\mathrm{d}y^l) = J^k_i \\cdots J^l_j \\mathrm{d}x^i \\otimes \\cdots \\otimes \\mathrm{d} x^j $$ 其次，我们需要证明，对于一个 $n \\times n$ 矩阵 $A$，它的行列式满足： $$ \\operatorname{det} A = \\epsilon_{k…l} A^k_1 \\cdots A^l_n $$ 其中 $\\epsilon$ 是广义 Levi-Citiva 符号，$\\epsilon_{12…n} = 1$ ，且交换两个下标，符号相反。其实这只不过是行列式的通常定义的另一种写法。 最后，我们就能导出微分形式的拉回的公式： $$ \\begin{aligned} \\phi^*(\\mathrm{d}x^{i_1}\\wedge\\cdots\\wedge\\mathrm{d}x^{i_m}) \u0026= \\phi^* \\left(\\frac{1}{p!} \\epsilon_{i_1…i_m} \\mathrm{d}x^{i_1}\\otimes\\cdots\\otimes\\mathrm{d}x^{i_m}\\right)\\\\ \u0026= \\frac{1}{p!} \\epsilon_{i_1…i_m}J^{i_1}_{1} \\cdots J^{i_m}_{m} \\mathrm{d}u^1 \\otimes \\cdots \\otimes \\mathrm{d}u^m \\\\ \u0026= \\epsilon_{i_1…i_m} J^{i_1}_{1} \\cdots J^{i_m}_{m} \\mathrm{d}u^1 \\wedge \\cdots \\wedge \\mathrm{d}u^m \\\\ \u0026= (\\operatorname{det} J) \\mathrm{d}u^1 \\wedge \\cdots \\wedge \\mathrm{d}u^m \\end{aligned} $$ 其中 $\\operatorname{det} J$ 就是雅可比矩阵的行列式，或简称雅可比行列式。 根据上式我们就能导出正文中的公式了。 评论 现在我们定义好了微分形式在 m-cells 上的积分。接下来我们定义微分形式在 m-chain 上的积分。 一个 $m$ 阶微分形式 $\\omega$ 在一个 m-chain（ $c=\\sum_i c_i\\sigma_i$ ）上的积分定义如下： $$ \\begin{aligned} \\int_c\\omega=\\sum_i c_i\\int_{\\sigma_i}\\omega \\end{aligned} $$ 其中 $\\sigma_i$ 是一个 m-cell。 ","date":"2023-06-09","objectID":"/differential_geometry/:6:3","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"5.4 斯托克斯定理（Stokes’ Theorem） 有了前几节的概念的铺垫之后，我们现在就可以来介绍大名鼎鼎的斯托克斯定理了。 定理 5.2 斯托克斯定理 给定一个 (m+1)-chain：$c\\in C_{m+1}$ 和一个 m 阶微分形式： $\\alpha \\in \\bigwedge^m(T^*M)$，有 $$ \\int_c \\mathrm{d} \\alpha = \\int_{\\partial c} \\alpha $$ 下面我们看看斯托克斯定理如何退化为我们熟悉的形式。 例 5.4 微积分基本定理 $$ \\int_a^b f^\\prime(x)\\mathrm{d}x = f(b) - f(a) $$ 在斯托克斯定理中，取 $M=\\mathbb{R}^1$，$c = [a,b]$ 即可得到。 例 5.5 格林定理 $$ \\iint_D \\left( \\frac{\\partial Q}{\\partial x} - \\frac{\\partial P}{\\partial y}\\right) \\mathrm{d}x\\mathrm{d}y = \\oint_{\\partial D} (P\\mathrm{d}x+Q\\mathrm{d}y) $$ 在斯托克斯定理中，取 $M=\\mathbb{R}^2$，$c = D$，$\\alpha = P\\mathrm{d}x+Q\\mathrm{d}y$ 即可得到。 接下来，我们来看看高斯定理。与斯托克斯定理不同，高斯定理必须要配备度规才有定义。 例 5.6 高斯定理 $$ \\int_{D}(\\operatorname{div} V)\\omega_g = \\int_{\\partial D} V^i \\mathrm{d} \\Sigma_i|_{\\partial D} $$ 其中 $\\omega_g$ 是在度规 $g$ 的衡量下，体积为 1 的体积形式，且 $$ \\mathrm{d}\\Sigma_i := \\frac{1}{(n-1)!} \\omega_{ij…k} \\mathrm{d}x^j\\wedge \\cdots \\wedge \\mathrm{d}x^k $$ 提示： 由于 $(\\operatorname{div} V)\\omega_g =: \\mathcal{L}_V \\omega_g$，根据斯托克斯定理，只要证明 $\\mathcal{L}_V \\omega_g = \\mathrm{d}(V^i\\mathrm{d}\\Sigma_i)$ 即可。 ","date":"2023-06-09","objectID":"/differential_geometry/:6:4","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":["数学物理方法"],"content":"5.5 *同调和上同调简介（Introduction to Homology \u0026 Cohomology） 评论 在某种程度上，我们可以用“洞”的个数和类型来给流形分类。在一般的拓扑学科普中，人们通常用这一点来说明问题。 同调（Homology）就是为了研究“洞”（Holes）而诞生的。如何定义一个“洞”呢？ 注意到，在没有洞的流形上，一个没有边界（用自然语言来说就是闭合/首尾相接）的超曲面/曲线一定是另一个区域的边界，换句话说：一个边界为零（见第 5.2 节）的 p-链 总是另外一个 (p+1)-链的边界。 但是在一个有洞的流形上，这一点是不成立的。你可以想象一个绕着甜甜圈一圈首尾相接的链：它的边界为零，但它不是任何链的边界。 评论 当然，如果一个链是另一个链的边界，那么它的边界一定为零，这是因为 $\\partial\\partial=0$（定理 5.1）。 在数学上，我们可以用代数的语言来定义这一类对象： $$ H_p(M) := \\frac{ \\{c_p \\mid \\partial c_p=0\\} }{ \\{c_p \\mid \\partial c_{p+1} = c_p \\} } $$ 其中 $c_p$ 代表一个 p-链。 评论 或者写得更严谨一些： $$ H_p(M) := \\frac{ \\{c \\in C_p \\mid \\partial c=0\\} }{ \\{c \\in C_p \\mid \\partial c^{\\prime} = c; c^{\\prime} \\in C_{p+1} \\} } $$ 如果你对这些符号有一些困惑，请回到第 5.2 节。 或写成 $$ H_p(M) := \\frac{\\operatorname{Ker} \\partial_{p}}{\\operatorname{Im} \\partial_{p+1}} $$ $H_p(M)$ 叫做 $p$ 阶同调群，它是两个群的商群。同调群中的一个元素叫做同调类。 评论 例如，$S_1$（一个首尾相接的曲线）的同调类为 $\\mathbb{Z}$。这是因为你可以绕一圈、也可以绕两圈、三圈…也可以反向绕整数圈。当然，也可以不绕圈。这对应整数群。 一个甜甜圈（数学上定义为 $T:=S^1\\times S^1$）的 1 阶同调群为 $\\mathbb{Z} \\times \\mathbb{Z}$。这从形式和图像上都是比较直观的，见下图： 甜甜圈的同调群是 $\\mathbb{Z}\\times\\mathbb{Z}$，从图中可以直观地看出，有两种不同的环绕方法 我们再来看看上同调所关心的事情。在物理中，我们通常默认一个闭形式是一个恰当形式的微分。例如，我们由电场的旋度（见第 3.4-5 节）为零推导出电势的存在，以及由磁场的散度（见第 3.4-5 节）为零推导出磁势的存在。 评论 恰当形式指的是这样一种形式，它是另外一个形式的（外）微分。 闭形式指的是这样一种形式，它的（外）微分为零。 然而，在一般的流形上，这未必是成立的。可能存在这样一种形式，它的微分为零，但它不是任何形式的微分。换句话说，存在不是恰当形式的闭形式。 评论 想象一个圆柱体的侧面（$\\mathbb{R}^1 \\times S^1$），上面有一个均匀环绕它一圈的电场。可以证明，这样的电场是无散的，但不是一个保守场：一个电子朝电场的方向绕一圈回到原来的位置，能量会增加。此时电势是不存在的。 那么为什么在普通物理中，我们认为电势/磁势总是存在的呢？这是因为我们相信，我们所处的空间中没有“洞”。换句话说，在单连通（回想一下高等数学）的空间中，一个形式的微分为零，意味着它是一个恰当形式。 上同调（Cohomology）所关心的问题就是：闭形式何时是恰当形式，以及有多少类不是恰当形式的闭形式。 评论 当然，恰当形式一定是闭形式，这是因为 $\\mathrm{dd} = 0$（定理 3.1）。 可以定义上同调群为“所有恰当形式”商掉“所有闭形式”，即： $$ H^p(M) = \\frac{ \\{ \\omega \\mid \\mathrm{d}\\omega = 0 \\} }{ \\{ \\omega \\mid \\mathrm{d} \\alpha = \\omega\\} } $$ 或写成 $$ H^p(M) = \\frac{\\operatorname{Ker}\\mathrm{d}_p}{\\operatorname{Im}\\mathrm{d}_{p-1}} $$ $H^p(M)$ 叫做 $p$ 阶上同调群，其中的元素叫做上同调类。 最后，有一个定理可以将同调和上同调联系在一起，它就是庞加莱对偶： 庞加莱对偶 对于 n 维可定向、紧致、无边界的流形，它的 k 阶同调群与 (n-k) 阶上同调群同构，即 $$ H_k(M) \\cong H^{n-k}(M) $$ 换言之，下列两者的等价类之间有自然的一一对应关系： 1.不是另一个形式的微分，但自己的微分为零的形式 2.不是另一个链的边界，但自己的边界为零的链 ","date":"2023-06-09","objectID":"/differential_geometry/:6:5","tags":["微分几何"],"title":"一文入门微分几何（物理人版）","uri":"/differential_geometry/"},{"categories":null,"content":"\r","date":"0001-01-01","objectID":"/about/:0:0","tags":null,"title":"About","uri":"/about/"}]