---
title: "Baker-Campbell-Hausdorff Formula"
date: 2024-03-10T02:12:14+08:00
draft: false
tags: ["Quantum Optics"]
categories: ["Mathematical Physics"]
---

Chinese version [here](../zh-cn/bch/)

**Baker-Campbell-Hausdorff Formula** can be used to compute operator evolution in the Heisenberg picture:

$e^X Y e^{-X}=Y+[X,Y]+\frac{1}{2!}[X,[X,Y]]+\frac{1}{3!}[X,[X,[X,Y]]]+\cdots$


> This formula is actually just a younger sibling of the BCH formula.

Because the evolution rule of operators in the Heisenberg picture is $A\rightarrow UAU^{\dag}$, where $U$ is a unitary evolution operator.

If $U$ is generated by $H$, then it becomes $A\rightarrow e^{\frac{t}{i\hbar}H}Ae^{-\frac{t}{i\hbar}H}$.


> **Example 1: Phase Shifter**
> The Hamiltonian is $H=\varphi n$, and the annihilation operator $a$ evolves as:
> $\begin{aligned} e^{-i\varphi n} a e^{i\varphi n}&= a + i\varphi [n, a] - \frac{\varphi}{2!} [n,[n,a]] - \cdots \\\\ &= a (1+i\varphi -\frac{\varphi^2}{2!} - \cdots)\\\\ &= e^{i\varphi} a \end{aligned}$


> **Example 2: Beam Splitter**
> The Hamiltonian is $H= \theta e^{i\varphi} a^{\dag}b + \theta e^{-i\varphi} a b^\dag$, the evolution is as follows:
> $\begin{aligned} e^{-iH} a e^{iH} &= \cos \theta \,a + i \sin\theta\, e^{i\varphi} b \\\\ e^{-iH} b e^{iH} &= i \sin\theta \,e^{-i\varphi} a  + \cos \theta \,b \end{aligned}$
> This is the familiar Bogoliubov Transformation.


> These two examples seem like using a cannon to kill a mosquito. Let's move on to something more useful:


> **Example 3: Two-mode Squeezed State**
> The Hamiltonian is: $\begin{aligned} H=i\hbar\left(g^\*a b-g a^\dag b^\dag\right) \end{aligned}$
> $\begin{aligned} a &\rightarrow e^{\frac{H}{i\hbar}} a e^{-\frac{H}{i\hbar}} \\\\ &= a + \left[{\frac{H}{i\hbar}},a\right]+\left[{\frac{H}{i\hbar}},\left[{\frac{H}{i\hbar}},a\right]\right] + \cdots \\\\ &=\cosh(r) a - \sinh(r)e^{i\xi}b^\dag \end{aligned}$
> 
> Where $g = re^{i\xi}$. 
> This is well-known for SPDC and OPO. It's difficult to compute in the SchrÃ¶dinger picture, but it's much easier using the Heisenberg picture with BCH formula.


> **Example 4: Rotated Quadratures**
> The generator is the total particle number $N$, canonical position operator $Q$, and canonical momentum operator $P$ evolve as:
> 
> $\begin{aligned} e^{i\theta N} Q e^{-i\theta N} = \cos \theta\, Q + i \sin \theta\, P \\\\ e^{i\theta N} P e^{-i\theta N} = i \sin \theta\, Q + \cos \theta P \end{aligned}$
> 
> It looks like rotating the phase space, similar to the Phase Shifter. This transformation is useful for handling Squeezed states.


Even a subordinate of the BCH formula is so useful, isn't the original formula even more powerful? Now, let's introduce the original:

$e^{X}e^{Y}=e^Z$

$Z=X+Y+{\frac {1}{2}}[X,Y]+{\frac {1}{12}}[X,[X,Y]]-{\frac {1}{12}}[Y,[X,Y]]+\cdots $


Uh, it seems a bit less practical.

In reality, we often use a special case, where $[X,Y]$ is a constant, in which case the BCH formula becomes

$Z=X+Y+{\frac {1}{2}}[X,Y]$


> **Example 5: Displacement Operator**
> 
> $\begin{aligned} D(\alpha)&=e^{\alpha a^\dag-\alpha^\* a} \\\\ &=e^{-\frac{1}{2}|\alpha|^2}e^{\alpha a^\dag}e^{-\alpha^\* a} \\\\ &=e^{\frac{1}{2}|\alpha|^2}e^{-\alpha^\* a}e^{\alpha a^\dag} \end{aligned}$
> 
> It's evident that the BCH formula allows us to switch flexibly between normal ordering (creation operators before annihilation operators) and anti-normal ordering. In fact, the displacement operator itself is neither normally ordered nor anti-normally ordered but symmetrically ordered.


> **Example 6: Weyl Operator**
> $W(q,p) = e^{i(-qP+pQ)} = e^{\frac{i}{2}qp}U(q)V(p) = e^{-\frac{i}{2}qp}V(p)U(q)$
> 
> Where $U(q)=e^{-iqP}$ is the position translation operator, $V(p)=e^{ipQ}$ is the momentum translation operator. According to the BCH formula, we can decouple them. 
> This $W:\mathbb{R}^2\rightarrow \mathcal{L}(L^2(\mathbb{R}))$ is called the Weyl Representation. 
> More generally, the Weyl Transformation can quantize a probability density function in classical phase space into a density operator, conversely, the Wigner Transformation can map a density operator to a probability density function in phase space, which is called the Wigner Representation in quantum optics.


> Example 7: Glauber P-, Husimi Q- and Wigner Representation
> The Wigner representation of a density operator $\rho$ is the Fourier transform of its characteristic function.
> Characteristic function: $\chi_W(\lambda)=\operatorname{Tr}[\rho D(\lambda)]$, where $D(\lambda) = e^{\lambda a^\dag - \lambda a}$ is the displacement operator.
> 
> Wigner representation: $\begin{aligned} W(\alpha)=\frac{1}{\pi^2}\int \chi_W(\lambda) e^{-(\lambda a^* - \lambda^*\alpha)} \mathrm{d}^2\alpha \end{aligned}$
> 
> If we change the characteristic function to normal ordering and anti-normal ordering, we can obtain Glauber P representation and Husimi Q representation:
> 
> Glauber P representation: $\begin{aligned} P(\alpha) = \int \operatorname{Tr}[\rho e^{\lambda a^\dag}e^{\lambda^\*a}] e^{-(\lambda \alpha^\* - \lambda^\* \alpha)} \mathrm{d}^2 \alpha \end{aligned}$
> 
> Husimi Q representation: $\begin{aligned} Q(\alpha) = \int \operatorname{Tr}[\rho e^{\lambda^\*a}e^{\lambda a^\dag}] e^{-(\lambda \alpha^\* - \lambda^\* \alpha)} \mathrm{d}^2 \alpha \end{aligned}$
> 
> Then, P and Q have simple forms:
> 
> $\begin{aligned} P&: \quad \rho = \int P(\alpha) |\alpha \rangle\langle \alpha | \mathrm{d}^2 \alpha \\\\ Q&:\quad Q(\alpha) = \frac{1}{\pi} \langle \alpha | \rho | \alpha \rangle \end{aligned}$
> 
> The advantage is that we can conveniently compute the expectation values of normally ordered and anti-normally ordered operators through P and Q representations:
> 
> $\begin{aligned} \langle a^{\dag k} a^l\rangle &= \operatorname{Tr}[a^l \rho a^{\dag k}] \\\\ &= \operatorname{Tr}\left[\int P(\alpha) a^l |\alpha\rangle\langle \alpha | a^{\dag k} \mathrm{d}^2 \alpha\right] \\\\ &= \int \alpha^l \alpha^{* k} P(\alpha) \mathrm{d}^2 \alpha \end{aligned}$
> 
> $\begin{aligned} \langle a^l a^{\dag k}\rangle &= \operatorname{Tr}[a^{\dag k} \rho a^l] \\\\ &= \frac{1}{\pi} \int \langle \alpha | a^{\dag k} \rho a^l | \alpha \rangle \mathrm{d}^2 \alpha \\ &= \int \alpha^l \alpha^{* k} Q(\alpha) \mathrm{d}^2 \alpha \end{aligned}$
> 
> However, classical physical quantities quantized always result in symmetrically ordered operators rather than normally or anti-normally ordered operators. So, the expectation value that corresponds most closely to classical mechanics should be the expectation value of symmetrically ordered operators, $\langle S(a^l a^{\dag k})\rangle$, where $S$ is the symmetric ordering operator.
> If we want to compute $\langle S(a^l a^{\dag k})\rangle$, we need to use the Wigner representation:
> 
> $\begin{aligned} \langle S(a^l a^{\dag k})\rangle = \int \alpha^l \alpha^{* k} W(\alpha) \mathrm{d}^2 \alpha \end{aligned}$
> 
> According to the BCH formula, the characteristic functions of these three representations differ from each other only by a factor of $e^{\frac{1}{2}|\lambda|^2}$. This leads to the following transformation formulas:
> 
> $\begin{aligned} W(\alpha) &= \frac{2}{\pi} \int P(\lambda)e^{-2|\alpha-\lambda|^2}\mathrm{d}^2\lambda \\\\ Q(\alpha) &= \frac{2}{\pi} \int W(\lambda)e^{-2|\alpha-\lambda|^2}\mathrm{d}^2\lambda \\ Q(\alpha) &= \frac{1}{\pi}\int P(\lambda) e^{-|\alpha - \lambda|^2} \mathrm{d}^2 \lambda \end{aligned}$